(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-68e0ed74","chunk-68e0ed74"],{"0216":function(e,t,a){},"04ff":function(e,t,a){var o=a("5ca1"),n=a("3ca5");o(o.S+o.F*(Number.parseInt!=n),"Number",{parseInt:n})},"096c":function(e,t,a){"use strict";var o=a("0216"),n=a.n(o);n.a},"2dab":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-date-picker",{attrs:{disabled:e.disabled||e.readOnly,placeholder:e.placeholder,value:e.momVal,showTime:e.showTime,format:e.dateFormat,getCalendarContainer:e.getCalendarContainer},on:{change:e.handleDateChange}})},n=[],i={name:"JDate",props:{placeholder:{type:String,default:"",required:!1},value:{type:String,required:!1},dateFormat:{type:String,default:"YYYY-MM-DD",required:!1},triggerChange:{type:Boolean,required:!1,default:!1},readOnly:{type:Boolean,required:!1,default:!1},disabled:{type:Boolean,required:!1,default:!1},showTime:{type:Boolean,required:!1,default:!1},getCalendarContainer:{type:Function,default:function(){return document.body}}},data:function(){var e=this.value;return{decorator:"",momVal:e?moment(e,this.dateFormat):null}},watch:{value:function(e){this.momVal=e?moment(e,this.dateFormat):null}},methods:{moment:moment,handleDateChange:function(e,t){this.$emit("change",t)}},model:{prop:"value",event:"change"}},l=i,s=a("2877"),r=Object(s["a"])(l,o,n,!1,null,null,null);t["default"]=r.exports},"3ca5":function(e,t,a){var o=a("7726").parseInt,n=a("aa77").trim,i=a("fdef"),l=/^[-+]?0[xX]/;e.exports=8!==o(i+"08")||22!==o(i+"0x16")?function(e,t){var a=n(String(e),3);return o(a,t>>>0||(l.test(a)?16:10))}:o},7550:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-spin",{attrs:{spinning:e.loading}},[a("a-row",{attrs:{type:"flex"}},[a("a-col",[e._t("buttonBefore",null,{target:e.getVM()})],2),a("a-col",[e.actionButton?a("div",{staticClass:"action-button"},[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.handleClickAdd}},[e._v("新增")]),a("span",{staticClass:"gap"}),e.selectedRowIds.length>0?[a("a-popconfirm",{attrs:{title:"确定要删除这 "+e.selectedRowIds.length+" 项吗?"},on:{confirm:e.handleConfirmDelete}},[a("a-button",{attrs:{type:"primary",icon:"minus"}},[e._v("删除")]),a("span",{staticClass:"gap"})],1),e.showClearSelectButton?[a("a-button",{attrs:{icon:"delete"},on:{click:e.handleClickClearSelection}},[e._v("清空选择")]),a("span",{staticClass:"gap"})]:e._e()]:e._e()],2):e._e()]),a("a-col",[e._t("buttonAfter",null,{target:e.getVM()})],2)],1),e._t("actionButtonAfter",null,{target:e.getVM()}),a("div",{staticClass:"input-table",attrs:{id:e.caseId+"inputTable"}},[a("div",{ref:"thead",staticClass:"thead"},[a("div",{staticClass:"tr",style:{width:this.realTrWidth}},[e.dragSort?a("div",{staticClass:"td td-ds",style:e.style.tdLeftDs},[a("span")]):e._e(),e.rowSelection?a("div",{staticClass:"td td-cb",style:e.style.tdLeft},[a("a-checkbox",{attrs:{checked:e.getSelectAll,indeterminate:e.getSelectIndeterminate},on:{change:e.handleChangeCheckedAll}})],1):e._e(),e.rowNumber?a("div",{staticClass:"td td-num",style:e.style.tdLeft},[a("span",[e._v("#")])]):e._e(),e._l(e.columns,(function(t){return[a("div",{directives:[{name:"show",rawName:"v-show",value:t.type!==e.formTypes.hidden,expression:"col.type !== formTypes.hidden"}],key:t.key,staticClass:"td",style:e.buildTdStyle(t)},[a("span",[e._v(e._s(t.title))])])]}))],2)]),a("div",{ref:"scrollView",staticClass:"scroll-view",style:{"max-height":e.maxHeight+"px"}},[a("div",{staticClass:"tbody",style:e.tbodyStyle,attrs:{id:e.caseId+"tbody"}},[a("div",{staticClass:"tr-expand",style:"height:"+e.getExpandHeight+"px; z-index:"+(e.loading?"11":"9")+";"}),0===e.rows.length?a("div",{staticClass:"tr-nodata"},[a("span",[e._v("暂无数据")])]):e._e(),a("draggable",{attrs:{value:e.rows,handle:".td-ds-icons"},on:{end:e.handleDragMoveEnd}},[e._l(e.rows,(function(t,o){return[o>=parseInt(""+(e.scrollTop-e.rowHeight)/e.rowHeight)&&parseInt(""+e.scrollTop/e.rowHeight)+9>o?a("div",{key:t.id,staticClass:"tr",class:-1!==e.selectedRowIds.indexOf(t.id)?"tr-checked":"",style:e.buildTrStyle(o),attrs:{id:e.caseId+"tbody-tr-"+o,"data-idx":o}},[e.dragSort?a("div",{staticClass:"td td-ds",style:e.style.tdLeftDs},[a("a-dropdown",{attrs:{trigger:["click"],getPopupContainer:e.getParentContainer}},[a("div",{staticClass:"td-ds-icons"},[a("a-icon",{attrs:{type:"align-left"}}),a("a-icon",{attrs:{type:"align-right"}})],1),a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",{key:"0",attrs:{disabled:0===o},on:{click:function(t){return e._handleRowMoveUp(o)}}},[e._v("向上移")]),a("a-menu-item",{key:"1",attrs:{disabled:o===e.rows.length-1},on:{click:function(t){return e._handleRowMoveDown(o)}}},[e._v("向下移")]),a("a-menu-divider"),a("a-menu-item",{key:"3",on:{click:function(t){return e._handleRowInsertDown(o)}}},[e._v("插入一行")])],1)],1)],1):e._e(),e.rowSelection?a("div",{staticClass:"td td-cb",style:e.style.tdLeft},[e._l([""+t.id],(function(t,o){return[a("a-checkbox",{key:o,attrs:{id:t,checked:-1!==e.selectedRowIds.indexOf(t)},on:{change:e.handleChangeLeftCheckbox}})]}))],2):e._e(),e.rowNumber?a("div",{staticClass:"td td-num",style:e.style.tdLeft},[a("span",[e._v(e._s(o+1))])]):e._e(),e._l(e.columns,(function(n){return a("div",{directives:[{name:"show",rawName:"v-show",value:n.type!==e.formTypes.hidden,expression:"col.type !== formTypes.hidden"}],key:n.key,staticClass:"td",style:e.buildTdStyle(n)},[e._l([""+n.key+t.id],(function(i,l){return[n.type===e.formTypes.input||n.type===e.formTypes.inputNumber?a("label",{key:l},[a("a-tooltip",{attrs:{id:i,placement:"top",title:(e.tooltips[i]||{}).title,visible:(e.tooltips[i]||{}).visible||!1,autoAdjustOverflow:!0,getPopupContainer:e.getParentContainer}},[a("input",e._b({attrs:{id:i,"data-input-number":n.type===e.formTypes.inputNumber,placeholder:e.replaceProps(n,n.placeholder)},on:{blur:function(a){e.handleBlurCommono(a.target,o,t,n)},input:function(a){e.handleInputCommono(a.target,o,t,n)},mouseover:function(){e.handleMouseoverCommono(t,n)},mouseout:function(){e.handleMouseoutCommono(t,n)}}},"input",e.buildProps(t,n),!1))])],1):n.type===e.formTypes.checkbox?[a("a-checkbox",e._b({key:l,attrs:{id:i,checked:e.checkboxValues[i]},on:{change:function(a){return e.handleChangeCheckboxCommon(a,t,n)}}},"a-checkbox",e.buildProps(t,n),!1))]:n.type===e.formTypes.select?[a("a-tooltip",{key:l,attrs:{id:i,placement:"top",title:(e.tooltips[i]||{}).title,visible:(e.tooltips[i]||{}).visible||!1,autoAdjustOverflow:!0,getPopupContainer:e.getParentContainer}},[a("span",{on:{mouseover:function(){e.handleMouseoverCommono(t,n)},mouseout:function(){e.handleMouseoutCommono(t,n)}}},[a("a-select",e._b({key:l,staticStyle:{width:"100%"},attrs:{id:i,value:e.selectValues[i],options:n.options,getPopupContainer:e.getParentContainer,placeholder:e.replaceProps(n,n.placeholder),filterOption:function(t,a){return e.handleSelectFilterOption(t,a,n)}},on:{change:function(a){return e.handleChangeSelectCommon(a,i,t,n)},search:function(a){return e.handleSearchSelect(a,i,t,n)},blur:function(a){return e.handleBlurSearch(a,i,t,n)}}},"a-select",e.buildProps(t,n),!1))],1)])]:n.type===e.formTypes.date||n.type===e.formTypes.datetime?[a("a-tooltip",{key:l,attrs:{id:i,placement:"top",title:(e.tooltips[i]||{}).title,visible:(e.tooltips[i]||{}).visible||!1,autoAdjustOverflow:!0,getPopupContainer:e.getParentContainer}},[a("span",{on:{mouseover:function(){e.handleMouseoverCommono(t,n)},mouseout:function(){e.handleMouseoutCommono(t,n)}}},[a("j-date",e._b({key:l,staticStyle:{width:"100%"},attrs:{id:i,value:e.jdateValues[i],getCalendarContainer:e.getParentContainer,placeholder:e.replaceProps(n,n.placeholder),"trigger-change":!0,showTime:n.type===e.formTypes.datetime,dateFormat:n.type===e.formTypes.date?"YYYY-MM-DD":"YYYY-MM-DD HH:mm:ss"},on:{change:function(a){return e.handleChangeJDateCommon(a,i,t,n,n.type===e.formTypes.datetime)}}},"j-date",e.buildProps(t,n),!1))],1)])]:n.type===e.formTypes.upload?a("div",{key:l},[e._l([e.uploadValues[i]||{}],(function(t,o){return null!=e.uploadValues[i]?[a("a-input",{key:o,attrs:{readOnly:!0,value:t.name}},[a("template",{staticStyle:{width:"30px"},slot:"addonBefore"},["uploading"===t.status?a("a-tooltip",{attrs:{title:"上传中("+Math.floor(t.percent)+"%)"}},[a("a-icon",{attrs:{type:"loading"}})],1):"done"===t.status?a("a-tooltip",{attrs:{title:"上传完成"}},[a("a-icon",{staticStyle:{color:"#00DB00"},attrs:{type:"check-circle"}})],1):a("a-tooltip",{attrs:{title:"上传失败"}},[a("a-icon",{staticStyle:{color:"red"},attrs:{type:"exclamation-circle"}})],1)],1),!1!==n.allowDownload||!1!==n.allowRemove?a("template",{staticStyle:{width:"30px"},slot:"addonAfter"},[a("a-dropdown",{attrs:{trigger:["click"],placement:"bottomRight",getPopupContainer:e.getParentContainer}},[a("a-tooltip",{attrs:{title:"操作",getPopupContainer:e.getParentContainer}},["uploading"!==t.status?a("a-icon",{staticStyle:{cursor:"pointer"},attrs:{type:"setting"}}):e._e()],1),a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[!1!==n.allowDownload?a("a-menu-item",{on:{click:function(t){return e.handleClickDownloadFile(i)}}},[a("span",[a("a-icon",{attrs:{type:"download"}}),e._v(" 下载\n                                ")],1)]):e._e(),!1!==n.allowRemove?a("a-menu-item",{on:{click:function(t){return e.handleClickDelFile(i)}}},[a("span",[a("a-icon",{attrs:{type:"delete"}}),e._v(" 删除\n                                ")],1)]):e._e()],1)],1)],1):e._e()],2)]:e._e()})),a("div",{attrs:{hidden:null!=e.uploadValues[i]}},[a("a-tooltip",{key:l,attrs:{id:i,placement:"top",title:(e.tooltips[i]||{}).title,visible:(e.tooltips[i]||{}).visible||!1,autoAdjustOverflow:!0,getPopupContainer:e.getParentContainer}},[a("span",{on:{mouseover:function(){e.handleMouseoverCommono(t,n)},mouseout:function(){e.handleMouseoutCommono(t,n)}}},[a("a-upload",e._b({attrs:{name:"file",data:{isup:1},multiple:!1,action:n.action,headers:e.uploadGetHeaders(t,n),showUploadList:!1},on:{change:function(a){return e.handleChangeUpload(a,i,t,n)}}},"a-upload",e.buildProps(t,n),!1),[a("a-button",{attrs:{icon:"upload"}},[e._v(e._s(n.placeholder))])],1)],1)])],1)],2):n.type===e.formTypes.popup?[a("a-tooltip",{key:l,attrs:{id:i,placement:"top",title:(e.tooltips[i]||{}).title,visible:(e.tooltips[i]||{}).visible||!1,autoAdjustOverflow:!0,getPopupContainer:e.getParentContainer}},[a("span",{on:{mouseover:function(){e.handleMouseoverCommono(t,n)},mouseout:function(){e.handleMouseoutCommono(t,n)}}},[a("j-popup",e._b({key:l,staticStyle:{width:"100%"},attrs:{id:i,placeholder:e.replaceProps(n,n.placeholder),value:e.getPopupValue(i),field:n.key,"org-fields":n.orgFieldse,"dest-fields":n.destFields,code:n.popupCode},on:{input:function(a,l){return e.popupCallback(a,l,i,t,n,o)}}},"j-popup",e.buildProps(t,n),!1))],1)])]:n.type===e.formTypes.file?a("div",{key:l},[e._l([e.uploadValues[i]||{}],(function(t,o){return null!=e.uploadValues[i]?[a("a-input",{key:o,attrs:{readOnly:!0,value:t.name}},[a("template",{staticStyle:{width:"30px"},slot:"addonBefore"},["uploading"===t.status?a("a-tooltip",{attrs:{title:"上传中("+Math.floor(t.percent)+"%)"}},[a("a-icon",{attrs:{type:"loading"}})],1):"done"===t.status?a("a-tooltip",{attrs:{title:"上传完成"}},[a("a-icon",{staticStyle:{color:"#00DB00"},attrs:{type:"check-circle"}})],1):a("a-tooltip",{attrs:{title:"上传失败"}},[a("a-icon",{staticStyle:{color:"red"},attrs:{type:"exclamation-circle"}})],1)],1),a("template",{staticStyle:{width:"30px"},slot:"addonAfter"},[a("a-tooltip",{attrs:{title:"删除并重新上传"}},["uploading"!==t.status?a("a-icon",{staticStyle:{cursor:"pointer"},attrs:{type:"close-circle"},on:{click:function(){return e.handleClickDelFile(i)}}}):e._e()],1)],1)],2)]:e._e()})),a("div",{attrs:{hidden:null!=e.uploadValues[i]}},[a("a-tooltip",{key:l,attrs:{id:i,placement:"top",title:(e.tooltips[i]||{}).title,visible:(e.tooltips[i]||{}).visible||!1,autoAdjustOverflow:!0,getPopupContainer:e.getParentContainer}},[a("span",{on:{mouseover:function(){e.handleMouseoverCommono(t,n)},mouseout:function(){e.handleMouseoutCommono(t,n)}}},[a("a-upload",e._b({attrs:{name:"file",data:{isup:1},multiple:!1,action:e.getUploadAction(n.action),headers:e.uploadGetHeaders(t,n),showUploadList:!1},on:{change:function(a){return e.handleChangeUpload(a,i,t,n)}}},"a-upload",e.buildProps(t,n),!1),[a("a-button",{attrs:{icon:"upload"}},[e._v(e._s(n.placeholder))])],1)],1)])],1)],2):n.type===e.formTypes.image?a("div",{key:l},[e._l([e.uploadValues[i]||{}],(function(t,o){return null!=e.uploadValues[i]?[a("div",{key:o,staticStyle:{position:"relative"}},[a("img",{staticStyle:{height:"32px","max-width":"100px !important"},attrs:{src:e.getCellImageView(i),alt:"无图片"}}),a("template",{staticStyle:{width:"30px"},slot:"addonBefore"},["uploading"===t.status?a("a-tooltip",{attrs:{title:"上传中("+Math.floor(t.percent)+"%)"}},[a("a-icon",{attrs:{type:"loading"}})],1):"done"===t.status?a("a-tooltip",{attrs:{title:"上传完成"}},[a("a-icon",{staticStyle:{color:"#00DB00"},attrs:{type:"check-circle"}})],1):a("a-tooltip",{attrs:{title:"上传失败"}},[a("a-icon",{staticStyle:{color:"red"},attrs:{type:"exclamation-circle"}})],1)],1),[a("a-tooltip",{staticStyle:{"margin-left":"5px"},attrs:{title:"删除并重新上传"}},["uploading"!==t.status?a("a-icon",{staticStyle:{cursor:"pointer"},attrs:{type:"close-circle"},on:{click:function(){return e.handleClickDelFile(i)}}}):e._e()],1)]],2)]:e._e()})),a("div",{attrs:{hidden:null!=e.uploadValues[i]}},[a("a-tooltip",{key:l,attrs:{id:i,placement:"top",title:(e.tooltips[i]||{}).title,visible:(e.tooltips[i]||{}).visible||!1,autoAdjustOverflow:!0,getPopupContainer:e.getParentContainer}},[a("span",{on:{mouseover:function(){e.handleMouseoverCommono(t,n)},mouseout:function(){e.handleMouseoutCommono(t,n)}}},[a("a-upload",e._b({attrs:{name:"file",data:{isup:1},multiple:!1,action:e.getUploadAction(n.action),headers:e.uploadGetHeaders(t,n),showUploadList:!1},on:{change:function(a){return e.handleChangeUpload(a,i,t,n)}}},"a-upload",e.buildProps(t,n),!1),[a("a-button",{attrs:{icon:"upload"}},[e._v("请上传图片")])],1)],1)])],1)],2):n.type===e.formTypes.radio?[a("a-tooltip",{key:l,attrs:{id:i,placement:"top",title:(e.tooltips[i]||{}).title,visible:(e.tooltips[i]||{}).visible||!1,autoAdjustOverflow:!0,getPopupContainer:e.getParentContainer}},[a("span",{on:{mouseover:function(){e.handleMouseoverCommono(t,n)},mouseout:function(){e.handleMouseoutCommono(t,n)}}},[a("a-radio-group",e._b({key:l,attrs:{id:i,value:e.radioValues[i]},on:{change:function(a){return e.handleRadioChange(a.target.value,i,t,n)}}},"a-radio-group",e.buildProps(t,n),!1),e._l(n.options,(function(t,o){return a("a-radio",{key:o,attrs:{value:t.value}},[e._v(e._s(t.text))])})),1)],1)])]:n.type===e.formTypes.list_multi?[a("a-tooltip",{key:l,attrs:{id:i,placement:"top",title:(e.tooltips[i]||{}).title,visible:(e.tooltips[i]||{}).visible||!1,autoAdjustOverflow:!0,getPopupContainer:e.getParentContainer}},[a("span",{on:{mouseover:function(){e.handleMouseoverCommono(t,n)},mouseout:function(){e.handleMouseoutCommono(t,n)}}},[a("a-select",e._b({key:l,staticStyle:{width:"100%"},attrs:{id:i,mode:"multiple",maxTagCount:1,value:e.multiSelectValues[i],options:n.options,getPopupContainer:e.getParentContainer,placeholder:e.replaceProps(n,n.placeholder),allowClear:""},on:{change:function(a){return e.handleMultiSelectChange(a,i,t,n)}}},"a-select",e.buildProps(t,n),!1))],1)])]:n.type===e.formTypes.sel_search?[a("a-tooltip",{key:l,attrs:{id:i,placement:"top",title:(e.tooltips[i]||{}).title,visible:(e.tooltips[i]||{}).visible||!1,autoAdjustOverflow:!0,getPopupContainer:e.getParentContainer}},[a("span",{on:{mouseover:function(){e.handleMouseoverCommono(t,n)},mouseout:function(){e.handleMouseoutCommono(t,n)}}},[a("a-select",e._b({key:l,staticStyle:{width:"100%"},attrs:{id:i,showSearch:"",optionFilterProp:"children",filterOption:e.filterOption,value:e.searchSelectValues[i],options:n.options,getPopupContainer:e.getParentContainer,placeholder:e.replaceProps(n,n.placeholder),allowClear:""},on:{change:function(a){return e.handleSearchSelectChange(a,i,t,n)}}},"a-select",e.buildProps(t,n),!1))],1)])]:n.type===e.formTypes.slot?a("div",{key:l},[a("a-tooltip",{key:l,attrs:{id:i,placement:"top",title:(e.tooltips[i]||{}).title,visible:(e.tooltips[i]||{}).visible||!1,autoAdjustOverflow:!0,getPopupContainer:e.getParentContainer}},[a("span",{on:{mouseover:function(){e.handleMouseoverCommono(t,n)},mouseout:function(){e.handleMouseoutCommono(t,n)}}},[e._t(n.slot||n.slotName||n.key,null,{index:o,text:e.slotValues[i],value:e.slotValues[i],column:n,rowId:e.removeCaseId(t.id),getValue:function(){return e._getValueForSlot(t.id)},caseId:e.caseId,allValues:e._getAllValuesForSlot(),target:e.getVM(),handleChange:function(a){return e.handleChangeSlotCommon(a,i,t,n)},isNotPass:e.notPassedIds.includes(n.key+t.id)})],2)])],1):a("span",e._b({key:l},"span",e.buildProps(t,n),!1),[e._v(e._s(e.inputValues[o][n.key]))])]}))],2)}))],2):e._e()]}))],2)],1)])])],2)},n=[],i=(a("8e6e"),a("456d"),a("7f7f"),a("a481"),a("04ff"),a("3b2b"),a("768b")),l=(a("ac4d"),a("8a81"),a("7618")),s=a("bd86"),r=(a("6762"),a("2fdb"),a("28a5"),a("6b54"),a("ac6a"),a("c5f6"),a("310e")),u=a.n(r),d=a("9fb0"),c=a("e2e0"),p=a("ca00"),h=a("2dab"),f=a("89f2");function m(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function v(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?m(Object(a),!0).forEach((function(t){Object(s["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):m(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var y=61,g={name:"JEditableTable",components:{JDate:h["default"],Draggable:u.a},props:{columns:{type:Array,required:!0},dataSource:{type:Array,required:!0,default:function(){return[]}},actionButton:{type:Boolean,default:!1},rowNumber:{type:Boolean,default:!1},rowSelection:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},maxHeight:{type:Number,default:400},disabledRows:{type:Object,default:function(){return{}}},disabled:{type:Boolean,default:!1},dragSort:{type:Boolean,default:!1},dragSortKey:{type:String,default:"orderNum"}},data:function(){return{caseId:"_jet-".concat(Object(p["randomString"])(6),"-"),el:{inputTable:null,tbody:null},style:{tbody:{left:"0px"},tdLeft:{"min-width":"4%","max-width":"45px"},tdLeftDs:{"min-width":"30px","max-width":"35px"}},formTypes:c["a"],rows:[],rowHeight:y,scrollTop:0,selectValues:{},checkboxValues:{},jdateValues:{},slotValues:{},uploadValues:{},popupValues:{},radioValues:{},metaCheckboxValues:{},multiSelectValues:{},searchSelectValues:{},selectedRowIds:[],deleteIds:[],tooltips:{},notPassedIds:[]}},created:function(){this.inputValues=[],this.visibleTrEls=[],this.disabledRowIds=this.disabledRowIds||[]},computed:{getExpandHeight:function(){return this.rows.length*this.rowHeight},getSelectIndeterminate:function(){return this.selectedRowIds.length>0&&this.selectedRowIds.length<this.rows.length},getSelectAll:function(){return this.selectedRowIds.length===this.rows.length&&this.rows.length>0},tbodyStyle:function(){var e=Object.assign({},this.style.tbody);return e["width"]=this.realTrWidth,e},showClearSelectButton:function(){var e=0;for(var t in this.disabledRows)this.disabledRows.hasOwnProperty(t)&&e++;return e>0},accessToken:function(){var e="";try{e=Vue.ls.get(d["ACCESS_TOKEN"])}catch(t){console.error(t)}return e},realTrWidth:function(){var e=this,t="calc(";return this.columns.forEach((function(a,o){var n=a.type,i=a.width;n!==c["a"].hidden&&(t+="number"===typeof i?i+"px":"string"===typeof i?i:"120px",o<e.columns.length-1&&(t+=" + "))})),t+=")",t}},watch:{rows:{immediate:!0,handler:function(e,t){}},dataSource:{immediate:!0,handler:function(e){var t=this;this.getElementPromise("tbody").then((function(){t.initialize();var a=[],o={},n={},i={},l={},s={},r={},u={},d={},p={},h=t.disabledRowIds||[];e.forEach((function(e,f){null!=e.id&&""!==e.id||(e.id=t.removeCaseId(t.generateId()+f));var m={id:t.caseId+e.id},v={id:m.id},y=!1;t.columns.forEach((function(a){var f=a.key+m.id,g=(null==e[a.key]?"":e[a.key]).toString();if(a.type===c["a"].checkbox)if(a.customValue instanceof Array){var b=(a.customValue[0]||"").toString();o[f]=g===b}else o[f]=g;else if(a.type===c["a"].select)n[f]=g?"multiple"===(a.props||{})["mode"]?g.split(","):g:void 0;else if(a.type===c["a"].date||a.type===c["a"].datetime)i[f]=g;else if(a.type===c["a"].slot)l[f]=0===g||g?g:a.defaultValue;else if(a.type===c["a"].popup)r[f]=g;else if(a.type===c["a"].radio)u[f]=g;else if(a.type===c["a"].sel_search)p[f]=g;else if(a.type===c["a"].list_multi)g.length>0?d[f]=g.split(","):d[f]=[];else if(a.type===c["a"].upload||a.type===c["a"].file||a.type===c["a"].image){if(g){var w=g.substring(g.lastIndexOf("/")+1);s[f]={name:w,status:"done",path:g}}}else m[a.key]=g;for(var C in t.disabledRows)if(t.disabledRows.hasOwnProperty(C)&&e.hasOwnProperty(C)&&!0!==y){var V=t.disabledRows[C];y=V instanceof Array?V.includes(e[C]):V===e[C],y&&h.push(v.id)}})),t.inputValues.push(m),a.push(v)})),t.disabledRowIds=h,t.checkboxValues=o,t.selectValues=n,t.jdateValues=i,t.slotValues=l,t.rows=a,t.uploadValues=s,t.popupValues=r,t.radioValues=u,t.multiSelectValues=d,t.searchSelectValues=p,t.$nextTick((function(){t.updateFormValues()}))}))}},columns:{immediate:!0,handler:function(e){var t=this;this.getElementPromise("tbody").then((function(){e.forEach((function(e){e.type!==c["a"].select&&e.type!==c["a"].list_multi&&e.type!==c["a"].sel_search||(e.options instanceof Array&&(e.options=e.options.map((function(e){return e?v({},e,{text:e.text||e.title,title:e.text||e.title}):{}}))),e.dictCode&&t._loadDictConcatToOptions(e))}))}))}},selectedRowIds:function(e){var t=this;this.$emit("selectRowChange",Object(p["cloneObject"])(e).map((function(e){return t.removeCaseId(e)})))}},mounted:function(){var e=this;this.getElement("inputTable").onscroll=function(t){e.syncScrollBar(t.target.scrollLeft)},this.getElement("tbody").onscroll=function(e){};var t=this.$refs,a=t.thead,o=t.scrollView;o.onscroll=function(t){a.scrollLeft=t.target.scrollLeft,e.recalcTrHiddenItem(t.target.scrollTop)}},methods:{getElement:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.el[e]||(this.el[e]=document.getElementById((t?"":this.caseId)+e)),this.el[e]},getElementPromise:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise((function(o){var n=setInterval((function(){var i=t.getElement(e,a);i&&(clearInterval(n),o(i))}),10)}))},initialize:function(){var e=this;this.inputValues=[],this.visibleTrEls=[],this.rows=[],this.deleteIds=[],this.selectValues={},this.checkboxValues={},this.jdateValues={},this.slotValues={},this.selectedRowIds=[],this.tooltips={},this.notPassedIds=[],this.uploadValues=[],this.popupValues=[],this.radioValues=[],this.multiSelectValues=[],this.searchSelectValues=[],this.scrollTop=0,this.$nextTick((function(){e.getElement("tbody").scrollTop=0}))},syncScrollBar:function(e){},resetScrollTop:function(e){var t=this.$refs.scrollView;t.scrollTop=null!=e&&"number"===typeof e?e:this.scrollTop},recalcTrHiddenItem:function(e){var t=this,a=e-this.scrollTop;a<0&&(a=this.scrollTop-e),a>=.3*this.rowHeight&&(this.scrollTop=e,this.$nextTick((function(){t.updateFormValues()})))},generateId:function(e){e instanceof Array||(e=this.rows||[]);var t=(new Date).getTime();return"".concat(this.caseId).concat(t).concat(e.length)},push:function(e){var t=this,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=arguments.length>2?arguments[2]:void 0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;o instanceof Array||(o=Object(p["cloneObject"])(this.rows)||[]),null==e.id&&(e.id=this.generateId(o)),-1===e.id.indexOf(this.caseId)&&(e.id=this.caseId+e.id);var i={id:e.id},l={id:i.id},s=Object.assign({},this.checkboxValues),r=Object.assign({},this.selectValues),u=Object.assign({},this.jdateValues),d=Object.assign({},this.slotValues);return this.columns.forEach((function(a){var o=a.key,n=o+i.id,p=null!=e[o];if(a.type===c["a"].input)l[o]=p?e[o]:a.defaultValue||(0===a.defaultValue?0:"");else if(a.type===c["a"].inputNumber)!0===a.isOrder?l[o]=t.getInputNumberMaxValue(a)+1:l[o]=p?e[o]:a.defaultValue||(0===a.defaultValue?0:"");else if(a.type===c["a"].checkbox)s[n]=p?e[o]:a.defaultChecked;else if(a.type===c["a"].select){var h=a.defaultValue;0===h||h||(h=void 0),"string"===typeof h&&"multiple"===(a.props||{})["mode"]&&(h=h.split(",")),r[n]=p?e[o]:h}else a.type===c["a"].date||a.type===c["a"].datetime?u[n]=p?e[o]:a.defaultValue:a.type===c["a"].slot?d[n]=p?e[o]:a.defaultValue||"":l[o]=p?e[o]:""})),"number"===typeof n?(o.splice(n,0,i),this.inputValues.splice(n,0,l)):(o.push(i),this.inputValues.push(l)),this.checkboxValues=s,this.selectValues=r,this.jdateValues=u,this.slotValues=d,this.dragSort&&this.inputValues.forEach((function(e,a){e[t.dragSortKey]=a+1})),a&&(this.rows=o,this.$nextTick((function(){t.updateFormValues()}))),o},getInputNumberMaxValue:function(e){var t=0;return this.inputValues.forEach((function(a,o){var n,i=a[e.key];try{n=parseInt(i)}catch(l){n=0}t=0===o?n:n>t?n:t})),t},add:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!(t<1)){for(var o,n=this.rows,i=0;i<t;i++)o={id:this.generateId(n)},n=this.push(o,!1,n);this.rows=n,this.$nextTick((function(){e.updateFormValues()})),this.$emit("added",{row:function(){var t=Object.assign({},o);return t.id=e.removeCaseId(t.id),t}(),target:this});var l=this.getElement("tbody"),s=l.offsetHeight,r=l.scrollTop+s;(!1!==a||l.scrollHeight-r<=10)&&this.$nextTick((function(){l.scrollTop=l.scrollHeight}))}},insert:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(e||!(a<1)){for(var o=this.rows,n=[],i=0;i<a;i++){var l={id:this.generateId(o)};o=this.push(l,!1,o,e),n.push(l)}this.rows=o,this.$nextTick((function(){t.recalcSortNumber(),t.forceUpdateFormValues()})),this.$emit("inserted",{rows:n.map((function(e){var a=Object(p["cloneObject"])(e);return a.id=t.removeCaseId(a.id),a})),num:a,insertIndex:e,target:this})}},removeSelectedRows:function(){this.removeRows(this.selectedRowIds),this.selectedRowIds=[]},removeRows:function(e){var t=this,a=e;if(!(e instanceof Array)){if("string"!==typeof e)throw"JEditableTable.removeRows() 函数需要的参数可以是string或Array类型，但提供的却是".concat(Object(l["a"])(e));a=[e]}var o=Object(p["cloneObject"])(this.rows);return a.forEach((function(e){var a=function(a){for(var o=0;o<a.length;o++)if(a[o].id===e||a[o].id===t.caseId+e)return a.splice(o,1),!0};if(a(o)){a(t.inputValues);var n=t.removeCaseId(e);t.deleteIds.push(n)}})),this.rows=o,this.$emit("deleted",this.getDeleteIds(),this),this.$nextTick((function(){t.updateFormValues()})),!0},getValuesAsync:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0,o=t.validate,n=t.rowIds;"boolean"!==typeof o&&(o=!0),n instanceof Array||(n=null);var i=0,l=0,s=Object(p["cloneObject"])(this.inputValues),r=Object.assign({},this.tooltips),u=Object(p["cloneObject"])(this.notPassedIds),d=[],h=!0,f=!1,m=void 0;try{for(var v,y=function(){var t=v.value,a=!1;if(null==n)a=!0;else{var s=!0,h=!1,f=void 0;try{for(var m,y=n[Symbol.iterator]();!(s=(m=y.next()).done);s=!0){var g=m.value;if(g===t.id||"".concat(e.caseId).concat(g)===t.id){a=!0;break}}}catch(b){h=!0,f=b}finally{try{s||null==y.return||y.return()}finally{if(h)throw f}}}if(!a)return"continue";e.columns.forEach((function(a){var n=a.key+t.id;if(a.type===c["a"].checkbox){var s=e.checkboxValues[n];a.customValue instanceof Array?t[a.key]=s?a.customValue[0]:a.customValue[1]:t[a.key]=s}else if(a.type===c["a"].select){var d=e.selectValues[n];t[a.key]=d instanceof Array?Object(p["cloneObject"])(d):d}else if(a.type===c["a"].date||a.type===c["a"].datetime)t[a.key]=e.jdateValues[n];else if(a.type===c["a"].upload)t[a.key]=Object(p["cloneObject"])(e.uploadValues[n]||null);else if(a.type===c["a"].image||a.type===c["a"].file){var h=Object(p["cloneObject"])(e.uploadValues[n]||null);h&&(t[a.key]=h["path"]||null)}else a.type===c["a"].popup?t[a.key]||(t[a.key]=e.popupValues[n]||null):a.type===c["a"].radio?t[a.key]=e.radioValues[n]:a.type===c["a"].sel_search?t[a.key]=e.searchSelectValues[n]:a.type===c["a"].list_multi?e.multiSelectValues[n]&&0!==e.multiSelectValues[n].length?t[a.key]=e.multiSelectValues[n].join(","):t[a.key]="":a.type===c["a"].slot&&(t[a.key]=e.slotValues[n]);if(!0===o){var f=function(e){r[n]=e[0],!1===r[n].passed&&l++,r[n].visible=!1,u=e[1]};i++;var m=e.validateOneInputAsync(t[a.key],t,a,u,!1,"getValues",(function(e){f(e),i--}));f(m)}})),t.id=e.removeCaseId(t.id),d.push(t)},g=s[Symbol.iterator]();!(h=(v=g.next()).done);h=!0)y()}catch(w){f=!0,m=w}finally{try{h||null==g.return||g.return()}finally{if(f)throw m}}!0===o&&(this.tooltips=r,this.notPassedIds=u);var b=setInterval((function(){0===i&&(clearInterval(b),"function"===typeof a&&a({error:l,values:d}))}),50);return{error:l,values:d}},getValuesSync:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.getValuesAsync(e)},getValues:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=arguments.length>2?arguments[2]:void 0;this.getValuesAsync({validate:t,rowIds:a},(function(t){var a=t.error,o=t.values;"function"===typeof e&&e(a,o)}))},getValuesPromise:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],a=arguments.length>1?arguments[1]:void 0;return new Promise((function(o,n){e.getValuesAsync({validate:t,rowIds:a},(function(e){var t=e.error,a=e.values;0===t?o(a):n(c["b"])}))}))},getDeleteIds:function(){return Object(p["cloneObject"])(this.deleteIds)},getAll:function(e){var t=this;return new Promise((function(a,o){var n=t.getDeleteIds();t.getValuesPromise(e).then((function(e){a({values:e,deleteIds:n})})).catch((function(e){o(e)}))}))},getAllSync:function(e,t){var a=this.getValuesSync({validate:e,rowIds:t});return a.deleteIds=this.getDeleteIds(),a},_getValueForSlot:function(e){return this.getValuesSync({rowIds:[e]}).values[0]},_getAllValuesForSlot:function(){return Object(p["cloneObject"])({inputValues:this.inputValues,selectValues:this.selectValues,checkboxValues:this.checkboxValues,jdateValues:this.jdateValues,slotValues:this.slotValues,uploadValues:this.uploadValues,popupValues:this.popupValues,radioValues:this.radioValues,multiSelectValues:this.multiSelectValues,searchSelectValues:this.searchSelectValues})},setValues:function(e){var t=this;e.forEach((function(e){var a=e.rowKey,o=e.values,n=function(e){if(o.hasOwnProperty(e)){var n=o[e],i=!1;t.inputValues.forEach((function(o){"".concat(t.caseId).concat(a)===o.id&&o.hasOwnProperty(e)&&(i=!0,o[e]=n)}));var l="".concat(e).concat(t.caseId).concat(a);!i&&t.selectValues.hasOwnProperty(l)&&(t.selectValues[l]=0===n||n?n:void 0,i=!0),!i&&t.checkboxValues.hasOwnProperty(l)&&(t.checkboxValues[l]=n,i=!0),!i&&t.jdateValues.hasOwnProperty(l)&&(t.jdateValues[l]=n,i=!0),!i&&t.slotValues.hasOwnProperty(l)&&(t.slotValues[l]=n,i=!0)}};for(var i in o)n(i)})),this.forceUpdateFormValues()},validateOneInputAsync:function(e,t,a,o){var n=this,l=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"input",r=arguments.length>6?arguments[6]:void 0,u=Object.assign({},this.tooltips),d=a.key+t.id;u[d]=u[d]?u[d]:{};var p=this.validateValue(a,e),h=Object(i["a"])(p,2),f=h[0],m=h[1],v=function(e){var t=Object(i["a"])(e,2),s=t[0],p=t[1];if(null!=s||null==u[d].visible){s=null==s||s,u[d].visible=!s,u[d].passed=s;var h=o.indexOf(d),f=null,m=null;s?-1!==h&&o.splice(h,1):(u[d].title=n.replaceProps(a,p),f="red",m="0 0 0 2px rgba(255, 0, 0, 0.2)",-1===h&&o.push(d));var v=document.getElementById(d);null!=v&&(a.type===c["a"].select&&(v=v.getElementsByClassName("ant-select-selection")[0]),a.type!==c["a"].date&&a.type!==c["a"].datetime||(v=v.getElementsByTagName("input")[0]),a.type!==c["a"].upload&&a.type!==c["a"].file&&a.type!==c["a"].image||(v=v.getElementsByClassName("ant-upload")[0].getElementsByClassName("ant-btn")[0]),v.style.borderColor=f,v.style.boxShadow=m,"SPAN"===v.tagName&&(v.style.display="block")),l&&(n.tooltips=u,n.notPassedIds=o),"function"===typeof r&&r([u[d],o])}};if("function"===typeof f){var y=!1;f(s,e,t,a,(function(e,t){y||(y=!0,"string"===typeof t&&(m=t),v(null==e||!0===e?[!0,m]:[!1,m]))}),this)}else v([f,m]);return[u[d],o]},validateOneInput:function(e,t,a,o){var n=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"input";return this.validateOneInputAsync(e,t,a,o,n,i)},validateValue:function(e,t){var a=e.validateRules,o=!0,n="";if(a instanceof Array){var i=!0,l=!1,s=void 0;try{for(var r,u=a[Symbol.iterator]();!(i=(r=u.next()).done);i=!0){var d=r.value,c=null==t||""===t;if(!0===d.required&&c)o=!1;else if(!0===d.unique||"only"===d.pattern){var p=this.getValuesSync({validate:!1}),h=p.values,f=0,m=!0,v=!1,y=void 0;try{for(var g,b=h[Symbol.iterator]();!(m=(g=b.next()).done);m=!0){var w=g.value;if(w[e.key]===t&&++f>=2){o=!1;break}}}catch(I){v=!0,y=I}finally{try{m||null==b.return||b.return()}finally{if(v)throw y}}}else if(d.pattern&&!c){for(var C=[{title:"6到16位数字",value:"n6-16",pattern:/\d{6,18}/},{title:"6到16位任意字符",value:"*6-16",pattern:/^.{6,16}$/},{title:"网址",value:"url",pattern:/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/},{title:"电子邮件",value:"e",pattern:/^([\w]+\.*)([\w]+)@[\w]+\.\w{3}(\.\w{2}|)$/},{title:"手机号码",value:"m",pattern:/^1[3456789]\d{9}$/},{title:"邮政编码",value:"p",pattern:/^[1-9]\d{5}$/},{title:"字母",value:"s",pattern:/^[A-Z|a-z]+$/},{title:"数字",value:"n",pattern:/^-?\d+\.?\d*$/},{title:"整数",value:"z",pattern:/^-?\d+$/},{title:"非空",value:"*",pattern:/^.+$/},{title:"6到18位字符串",value:"s6-18",pattern:/^.{6,18}$/},{title:"金额",value:"money",pattern:/^(([1-9][0-9]*)|([0]\.\d{0,2}|[1-9][0-9]*\.\d{0,2}))$/}],V=!1,k=0,S=C;k<S.length;k++){var O=S[k];if(d.pattern===O.value&&O.pattern){o=new RegExp(O.pattern).test(t),V=!0;break}}V||(o=new RegExp(d.pattern).test(t))}else if("function"===typeof d.handler)return[d.handler,d.message];if(!o){n=d.message;break}}}catch(I){l=!0,s=I}finally{try{i||null==u.return||u.return()}finally{if(l)throw s}}}return[o,n]},updateFormValues:function(){var e=this,t=this.getElement("tbody").getElementsByClassName("tr"),a=[],o=!0,n=!1,i=void 0;try{for(var l,s=t[Symbol.iterator]();!(o=(l=s.next()).done);o=!0){var r=l.value;a.push(r)}}catch(k){n=!0,i=k}finally{try{o||null==s.return||s.return()}finally{if(n)throw i}}var u=a;if(this.visibleTrEls.length>0){u=[];var d=!0,c=!1,p=void 0;try{for(var h,f=a[Symbol.iterator]();!(d=(h=f.next()).done);d=!0){var m=h.value,v=!0,y=!0,g=!1,b=void 0;try{for(var w,C=this.visibleTrEls[Symbol.iterator]();!(y=(w=C.next()).done);y=!0){var V=w.value;if(V.id===m.id){v=!1;break}}}catch(k){g=!0,b=k}finally{try{y||null==C.return||C.return()}finally{if(g)throw b}}v&&u.push(m)}}catch(k){c=!0,p=k}finally{try{d||null==f.return||f.return()}finally{if(c)throw p}}}this.visibleTrEls=a,u.forEach((function(t){var a=t.dataset.idx,o=e.inputValues[a];for(var n in o)if(o.hasOwnProperty(n)){var i="".concat(n).concat(o.id),l=document.getElementById(i);l&&(l.value=o[n])}}))},forceUpdateFormValues:function(){this.visibleTrEls=[],this.updateFormValues()},handleChangeCheckedAll:function(){var e=this,t=[];this.getSelectAll||this.rows.forEach((function(a){-1===(e.disabledRowIds||[]).indexOf(a.id)&&t.push(a.id)})),this.selectedRowIds=t},handleChangeLeftCheckbox:function(e){var t=e.target.id;if(-1===(this.disabledRowIds||[]).indexOf(t)){var a=this.selectedRowIds.indexOf(t);-1!==a?this.selectedRowIds.splice(a,1):this.selectedRowIds.push(t)}},handleClickAdd:function(){this.add()},handleConfirmDelete:function(){this.removeSelectedRows()},handleClickClearSelection:function(){this.clearSelection()},clearSelection:function(){this.selectedRowIds=[]},handleSelectFilterOption:function(e,t,a){return!0!==a.allowSearch||t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},handleSearchSelect:function(e,t,a,o){if(!0!==o.allowSearch&&!0===o.allowInput){var n=!1,i=!0,l=!1,s=void 0;try{for(var r,u=o.options[Symbol.iterator]();!(i=(r=u.next()).done);i=!0){var d=r.value;if(d.value.toLocaleString()===e.toLocaleString()){n=!0;break}}}catch(c){l=!0,s=c}finally{try{i||null==u.return||u.return()}finally{if(l)throw s}}!n&&e&&o.options.push({title:e,value:e,searchAdd:!0})}},handleBlurSearch:function(e,t,a,o){if(!0===o.allowInput&&"string"===typeof e){var n=[];o.options.forEach((function(t,a){t.value.toLocaleString()===e.toLocaleString()?delete t.searchAdd:!0===t.searchAdd&&n.push(a)}));var i=!0,l=!1,s=void 0;try{for(var r,u=n.reverse()[Symbol.iterator]();!(i=(r=u.next()).done);i=!0){var d=r.value;o.options.splice(d,1)}}catch(c){l=!0,s=c}finally{try{i||null==u.return||u.return()}finally{if(l)throw s}}}},emitDragged:function(e,t){this.$emit("dragged",{oldIndex:e,newIndex:t,target:this})},handleDragMoveEnd:function(e){var t=e.oldIndex,a=e.newIndex,o=e.item.dataset.idx,n=Number.parseInt(o)-t;t+=n,a+=n,this.rowResort(t,a),this.emitDragged(t,a)},rowResort:function(e,t){var a=function(a){var o=a[e];a.splice(e,1),a.splice(t,0,o)};a(this.rows),a(this.inputValues),this.recalcSortNumber(),this.forceUpdateFormValues()},recalcSortNumber:function(){var e=this;this.dragSort&&this.inputValues.forEach((function(t,a){return t[e.dragSortKey]=a+1}))},_handleRowMoveUp:function(e){if(e>0){var t=e-1;this.rowResort(e,t),this.emitDragged(e,t)}},_handleRowMoveDown:function(e){if(e<this.rows.length-1){var t=e+1;this.rowResort(e,t),this.emitDragged(e,t)}},_handleRowInsertDown:function(e){var t=e+1;this.insert(t)},handleMouseoverCommono:function(e,t){var a=t.key+e.id;-1!==this.notPassedIds.indexOf(a)&&this.showOrHideTooltip(a,!0,!0)},handleMouseoutCommono:function(e,t){var a=t.key+e.id;this.showOrHideTooltip(a,!1)},handleInputCommono:function(e,t,a,o){var n=e.value,i=e.dataset,l=e.selectionStart,s=c["a"].input,r=!0;if("true"==="".concat(i.inputNumber)){s=c["a"].inputNumber;var u=n.replace(/[^0-9]/g,"");n!==u&&(r=!1,n=u,e.value=u,"number"===typeof l&&(e.selectionStart=l-1,e.selectionEnd=l-1))}this.inputValues[t][o.key]=n,this.validateOneInput(n,a,o,this.notPassedIds,!0,"input"),r&&this.elemValueChange(s,a,o,n)},handleChangeSlotCommon:function(e,t,a,o){this.slotValues=this.bindValuesChange(e,t,"slotValues"),this.validateOneInput(e,a,o,this.notPassedIds,!0,"change"),this.elemValueChange(c["a"].slot,a,o,e)},handleBlurCommono:function(e,t,a,o){var n=e.value;this.validateOneInput(n,a,o,this.notPassedIds,!0,"blur")},handleChangeCheckboxCommon:function(e,t,a){var o=e.target,n=o.id,i=o.checked;this.checkboxValues=this.bindValuesChange(i,n,"checkboxValues"),this.elemValueChange(c["a"].checkbox,t,a,i)},handleChangeSelectCommon:function(e,t,a,o){this.selectValues=this.bindValuesChange(e,t,"selectValues"),this.validateOneInput(e,a,o,this.notPassedIds,!0,"change"),this.elemValueChange(c["a"].select,a,o,e)},handleChangeJDateCommon:function(e,t,a,o,n){this.jdateValues=this.bindValuesChange(e,t,"jdateValues"),this.validateOneInput(e,a,o,this.notPassedIds,!0,"change"),n?this.elemValueChange(c["a"].datetime,a,o,e):this.elemValueChange(c["a"].date,a,o,e)},handleChangeUpload:function(e,t,a,o){var n=e.file,i={name:n.name,type:n.type,size:n.size,status:n.status,percent:n.percent};o.responseName&&n.response&&(i["responseName"]=n.response[o.responseName]),"done"==n.status&&(i["path"]=n.response[o.responseName]),this.uploadValues=this.bindValuesChange(i,t,"uploadValues")},bindValuesChange:function(e,t,a){return this.$set(this[a],t,e),this[a]},showOrHideTooltip:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.tooltips[e]||a){var o=this.tooltips[e]||{};o.visible!==t&&(o.visible=t,this.$set(this.tooltips,e,o))}},elemValueChange:function(e,t,a,o){var n=Object.assign({},a),i=Object.assign({},t);i.id=this.removeCaseId(i.id);var l=this.getValuesSync({validate:!1,rowIds:[i.id]}),s=l.values;s.length>0&&Object.assign(i,s[0]),this.$emit("valueChange",{type:e,row:i,column:n,value:o,target:this})},removeCaseId:function(e){var t=e.split(this.caseId)[1];return t||e},handleClickDelFile:function(e){this.uploadValues[e]=null},handleClickDownloadFile:function(e){var t=this.uploadValues[e]||{},a=t.path;if(a){var o=window._CONFIG["staticDomainURL"]+"/"+a;window.open(o)}},_loadDictConcatToOptions:function(e){Object(f["initDictOptions"])(e.dictCode).then((function(t){if(t.success){var a=e.options||[];t.result.forEach((function(e){var t=!0,o=!1,n=void 0;try{for(var i,l=a[Symbol.iterator]();!(t=(i=l.next()).done);t=!0){var s=i.value;if(s.value===e.value)return}}catch(r){o=!0,n=r}finally{try{t||null==l.return||l.return()}finally{if(o)throw n}}a.push(e)})),e.options=a}else console.group("JEditableTable 查询字典(".concat(e.dictCode,")发生异常")),console.log(t.message),console.groupEnd()}))},log:console.log,getVM:function(){return this},getParentContainer:function(e){var t=this,a=function(){if(t.$el&&8!==t.$el.nodeType)return t.$el;var a=document.getElementById(t.caseId+"inputTable");return null!=a?a:e.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode}(),o=function e(t){var a=null;if(t["currentStyle"]?a=t["currentStyle"]["overflow"]:window.getComputedStyle&&(a=window.getComputedStyle(t)["overflow"]),null!=a){if("hidden"===a){var o=e(t.parentNode);return null!=o?o:t.parentNode}return t.parentNode&&"body"!==t.parentNode.tagName.toLocaleLowerCase()?e(t.parentNode):null}return t},n=o(a);return null!=n?n:a},replaceProps:function(e,t){return t&&"string"===typeof t&&(t=t.replace(/\${title}/g,e.title),t=t.replace(/\${key}/g,e.key),t=t.replace(/\${defaultValue}/g,e.defaultValue)),t},buildTrStyle:function(e){return{top:"".concat(y*e,"px")}},buildTdStyle:function(e){var t=function(e){return e.type===c["a"].hidden||"0px"===e.width||"0"===e.width||0===e.width},a={};e.width?a["width"]=e.width:this.columns?a["width"]="".concat(92/this.columns.filter((function(e){return!t(e)})).length,"%"):a["width"]="120px";var o=e.type===c["a"].checkbox;return o&&(a["align-items"]="center",a["text-align"]="center",a["padding-left"]="0",a["padding-right"]="0"),t(e)&&(a["padding-left"]="0",a["padding-right"]="0"),a},buildProps:function(e,t){var a={};if("object"===Object(l["a"])(t.props))for(var o in t.props)t.props.hasOwnProperty(o)&&(a[o]=this.replaceProps(t,t.props[o]));return t.type!==c["a"].select||!0!==t.allowInput&&!0!==t.allowSearch||(a["showSearch"]=!0),a["disabled"]="boolean"===typeof t["disabled"]?t["disabled"]:a["disabled"],!0!==a["disabled"]&&(a["disabled"]=-1!==(this.disabledRowIds||[]).indexOf(e.id)),!0===this.disabled&&(a["disabled"]=!0),a},uploadGetHeaders:function(e,t){var a={};return!0===t.token&&(a["X-Access-Token"]=this.accessToken),a},getUploadAction:function(e){return e||window._CONFIG["uploadURL"]+"/sys/common/upload"},getCellImageView:function(e){var t=this.uploadValues[e]||null;return t&&t["path"]?window._CONFIG["staticDomainURL"]+"/"+t["path"]:""},popupCallback:function(e,t,a,o,n,i){var l=this;this.popupValues[a]=e,t&&Object.keys(t).map((function(e){l.inputValues[i][e]=t[e]})),this.validateOneInput(e,o,n,this.notPassedIds,!0,"change"),this.elemValueChange("input",o,n,e),this.$nextTick((function(){l.forceUpdateFormValues()}))},getPopupValue:function(e){return this.popupValues[e]},handleRadioChange:function(e,t,a,o){this.radioValues=this.bindValuesChange(e,t,"radioValues"),this.validateOneInput(e,a,o,this.notPassedIds,!0,"change"),this.elemValueChange(c["a"].radio,a,o,e)},handleMultiSelectChange:function(e,t,a,o){this.multiSelectValues=this.bindValuesChange(e,t,"multiSelectValues"),this.validateOneInput(e,a,o,this.notPassedIds,!0,"change"),this.elemValueChange(c["a"].list_multi,a,o,e)},handleSearchSelectChange:function(e,t,a,o){this.searchSelectValues=this.bindValuesChange(e,t,"searchSelectValues"),this.validateOneInput(e,a,o,this.notPassedIds,!0,"change"),this.elemValueChange(c["a"].sel_search,a,o,e)},filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0}}},b=g,w=(a("096c"),a("2877")),C=Object(w["a"])(b,o,n,!1,null,"2e91c220",null);t["default"]=C.exports},9655:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e.title,width:1e3,visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭"},on:{ok:e.handleOk,cancel:e.handleCancel}},[a("a-spin",{attrs:{spinning:e.confirmLoading}},[a("a-form",{attrs:{form:e.form}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"规则名称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["ruleName",e.validatorRules.ruleName],expression:"['ruleName', validatorRules.ruleName]"}],attrs:{placeholder:"请输入规则名称"}})],1),a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"规则Code"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["ruleCode",e.validatorRules.ruleCode],expression:"['ruleCode', validatorRules.ruleCode]"}],attrs:{placeholder:"请输入规则Code"}})],1),a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"规则描述"}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["ruleDescription",{}],expression:"['ruleDescription', {}]"}],attrs:{placeholder:"请输入规则描述"}})],1)],1),a("a-tabs",{model:{value:e.tabs.activeKey,callback:function(t){e.$set(e.tabs,"activeKey",t)},expression:"tabs.activeKey"}},[a("a-tab-pane",{key:e.tabs.design.key,attrs:{tab:"局部规则",forceRender:""}},[a("a-alert",{attrs:{type:"info",showIcon:"",message:"局部规则按照你输入的位数有序的校验。"}}),a("j-editable-table",{ref:"designTable",staticStyle:{"margin-top":"8px"},attrs:{dragSort:"",rowNumber:"",maxHeight:240,columns:e.tabs.design.columns,dataSource:e.tabs.design.dataSource},scopedSlots:e._u([{key:"action",fn:function(e){return[a("my-action-button",{attrs:{rowEvent:e}})]}}])})],1),a("a-tab-pane",{key:e.tabs.global.key,attrs:{tab:"全局规则",forceRender:""}},[a("j-editable-table",{ref:"globalTable",attrs:{dragSort:"",rowNumber:"",actionButton:"",maxHeight:240,columns:e.tabs.global.columns,dataSource:e.tabs.global.dataSource},scopedSlots:e._u([{key:"actionButtonAfter",fn:function(){return[a("a-alert",{staticStyle:{"margin-bottom":"8px"},attrs:{type:"info",showIcon:"",message:"全局规则可校验用户输入的所有字符；全局规则的优先级比局部规则的要高。"}})]},proxy:!0},{key:"action",fn:function(e){return[a("my-action-button",{attrs:{rowEvent:e,allowEmpty:""}})]}}])})],1)],1)],1)],1)},n=[],i=a("768b"),l=(a("5df3"),a("ac6a"),a("3b2b"),a("0fea")),s=a("ca00"),r=a("e2e0"),u=a("7550"),d={name:"SysCheckRuleModal",components:{JEditableTable:u["default"],"my-action-button":{props:{rowEvent:Object,allowEmpty:Boolean},methods:{confirmIsShow:function(){var e=this.rowEvent,t=e.index,a=e.allValues.inputValues,o=a[t];return o.digits||o.pattern},handleLineAdd:function(){var e=this.rowEvent.target;e.add()},handleLineDelete:function(){var e=this.rowEvent,t=e.rowId,a=e.target;a.removeRows(t)},renderDeleteButton:function(){var e=this.$createElement;return this.allowEmpty||this.rowEvent.index>0?this.confirmIsShow()?e("a-popconfirm",{attrs:{title:"确定要删除吗？"},on:{confirm:this.handleLineDelete}},[e("a-button",{attrs:{icon:"minus"}})]):e("a-button",{attrs:{icon:"minus"},on:{click:this.handleLineDelete}}):""}},render:function(){var e=arguments[0];return e("div",[e("a-button",{on:{click:this.handleLineAdd},attrs:{icon:"plus"}})," ",this.renderDeleteButton()])}}},data:function(){var e=this;return{title:"操作",visible:!1,model:{},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},confirmLoading:!1,form:this.$form.createForm(this),validatorRules:{ruleName:{rules:[{required:!0,message:"请输入规则名称!"}]},ruleCode:{rules:[{required:!0,message:"请输入规则Code!"},{validator:function(t,a,o){return Object(s["validateDuplicateValue"])("sys_check_rule","rule_code",a,e.model.id,o)}}]}},tabs:{activeKey:"design",global:{key:"global",columns:[{title:"优先级",key:"priority",width:"15%",type:r["a"].select,defaultValue:"1",options:[{title:"优先运行",value:"1"},{title:"最后运行",value:"0"}],validateRules:[]},{title:"规则（正则表达式）",key:"pattern",width:"50%",type:r["a"].input,validateRules:[{required:!0,message:"规则不能为空"},{handler:this.validatePatternHandler}]},{title:"提示文本",key:"message",width:"20%",type:r["a"].input,validateRules:[{required:!0,message:"${title}不能为空"}]},{title:"操作",key:"action",width:"15%",slotName:"action",type:r["a"].slot}],dataSource:[]},design:{key:"design",columns:[{title:"位数",key:"digits",width:"15%",type:r["a"].inputNumber,validateRules:[{required:!0,message:"${title}不能为空"},{pattern:/^[1-9]\d*$/,message:"请输入零以上的正整数"}]},{title:"规则（正则表达式）",key:"pattern",width:"50%",type:r["a"].input,validateRules:[{required:!0,message:"规则不能为空"},{handler:this.validatePatternHandler}]},{title:"提示文本",key:"message",width:"20%",type:r["a"].input,validateRules:[{required:!0,message:"${title}不能为空"}]},{title:"操作",key:"action",width:"15%",slotName:"action",type:r["a"].slot}],dataSource:[]}},url:{add:"/sys/checkRule/add",edit:"/sys/checkRule/edit"}}},created:function(){},methods:{validatePatternHandler:function(e,t,a,o,n,i){if("blur"===e||"getValues"===e)try{new RegExp(t),n(!0)}catch(l){n(!1,"请输入正确的正则表达式")}else n(!0)},add:function(){this.edit({})},edit:function(e){var t=this;this.form.resetFields(),this.tabs.activeKey=this.tabs.design.key,this.tabs.global.dataSource=[],this.tabs.design.dataSource=[{digits:"",pattern:"",message:""}],this.model=Object.assign({},e),this.visible=!0,this.$nextTick((function(){t.form.setFieldsValue(pick(t.model,"ruleName","ruleCode","ruleDescription"));var e=t.model.ruleJson;if(e){var a=JSON.parse(e),o=[],n=[],i="1";a.forEach((function(e){"*"===e.digits?o.push(Object.assign(e,{priority:i})):(i="0",n.push(e))})),t.tabs.global.dataSource=o,t.tabs.design.dataSource=n}}))},close:function(){this.$emit("close"),this.visible=!1},handleOk:function(){var e=this;Promise.all([Object(s["alwaysResolve"])(new Promise((function(t,a){e.form.validateFields((function(e,o){return e?a(e):t(o)}))}))),Object(s["alwaysResolve"])(this.$refs.designTable.getValuesPromise),Object(s["alwaysResolve"])(this.$refs.globalTable.getValuesPromise)]).then((function(t){var a=Object(i["a"])(t,3),o=a[0],n=a[1],r=a[2];if(o.type===s["failedSymbol"])return Promise.reject("主表校验未通过");if(n.type===s["failedSymbol"])return e.tabs.activeKey=e.tabs.design.key,Promise.reject("局部规则子表校验未通过");if(r.type===s["failedSymbol"])return e.tabs.activeKey=e.tabs.global.key,Promise.reject("全局规则子表校验未通过");var u=o.data,d=r.data,c=n.data,p=[],h=[];d.forEach((function(e){e.digits="*","1"===e.priority?p.push(e):h.push(e)}));var f=p.concat(c).concat(h),m=f.map((function(e){return pick(e,"digits","pattern","message")})),v=JSON.stringify(m),y=Object.assign(e.model,u,{ruleJson:v}),g="post",b=e.url.add;return e.model.id&&(g="put",b=e.url.edit),e.confirmLoading=!0,Object(l["httpAction"])(b,y,g)})).then((function(t){t.success?(e.$message.success(t.message),e.$emit("ok"),e.close()):e.$message.warning(t.message)})).catch((function(e){console.error(e)})).finally((function(){e.confirmLoading=!1}))},handleCancel:function(){this.close()}}},c=d,p=a("2877"),h=Object(p["a"])(c,o,n,!1,null,"551b8e36",null);t["default"]=h.exports},e2e0:function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return n}));a("7618"),a("7f7f"),a("ac4d"),a("8a81");var o={normal:"normal",input:"input",inputNumber:"inputNumber",checkbox:"checkbox",select:"select",date:"date",datetime:"datetime",upload:"upload",slot:"slot",hidden:"hidden"},n=Symbol()}}]);