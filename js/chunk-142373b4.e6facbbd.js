(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-142373b4"],{"1b80":function(t,a,e){"use strict";a["a"]={data:function(){return{pagination:{page:1,pageSize:10,total:0,showTotal:function(t,a){return"共 ".concat(t," 条")}}}},computed:{requestData:function(){return{page:this.pagination.page,pageSize:this.pagination.pageSize}}},methods:{init:function(){},pageChange:function(t){this.pagination.page=t,this.requestData.page=t.current,this.init()}}}},dbff:function(t,a,e){"use strict";e.r(a);var n=function(){var t=this,a=this,e=a.$createElement,n=a._self._c||e;return n("div",{staticClass:"house-index"},[n("wrapper-content",[n("a-table",{attrs:{columns:a.columns,dataSource:a.dataSource,loading:a.loading,rowKey:"id",pagination:a.pagination},on:{change:a.pageChange},scopedSlots:a._u([{key:"action",fn:function(t,e,o){return[e.owner_code==a.userInfo.code?n("a",{on:{click:function(t){return a.rowClick(e,"edit")}}},[a._v("编辑")]):a._e(),e.owner_code!=a.userInfo.code?n("a",{on:{click:function(t){return a.rowClick(e,"quit")}}},[a._v("退出")]):a._e()]}}])})],1),n("a-modal",{attrs:{width:800,title:a.actionInfo.modalTitle,bodyStyle:{paddingBottom:"1px"},footer:null},model:{value:a.actionInfo.modalStatus,callback:function(t){a.$set(a.actionInfo,"modalStatus",t)},expression:"actionInfo.modalStatus"}},[n("a-form",{attrs:{autoFormCreate:function(a){t.form=a}},on:{submit:function(t){return t.preventDefault(),a.handleSubmit(t)}}},[n("a-form-item",{attrs:{form:a.form,label:"组织名称",labelCol:{span:3},wrapperCol:{span:21},fieldDecoratorId:"name",fieldDecoratorOptions:{rules:[{required:!0,message:"组织名称"}]},help:"必填，请填写组织名称"}},[n("a-input",{attrs:{placeholder:"组织名称"}})],1),n("a-form-item",{attrs:{label:"详细地址",labelCol:{span:3},wrapperCol:{span:21},fieldDecoratorId:"address",help:"详细地址"}},[n("a-input")],1),n("a-form-item",{attrs:{wrapperCol:{span:21,offset:3}}},[n("div",{staticClass:"action-btn"},[n("a-button",{staticClass:"middle-btn",attrs:{type:"primary",htmlType:"submit",loading:a.actionInfo.confirmLoading}},[a._v("保存")]),n("a-button",{staticClass:"middle-btn",on:{click:function(t){a.actionInfo.modalStatus=!1}}},[a._v("取消")])],1)])],1)],1)],1)},o=[],i=(e("8e6e"),e("ac6a"),e("456d"),e("6b54"),e("7f7f"),e("bd86")),r=e("22b6");e("4360");function c(t){return r["a"].post("project/organization",t)}function s(t){var a="project/organization/save";return t.organizationCode&&(a="project/organization/edit"),r["a"].post(a,t)}function d(t){return r["a"].post("project/organization/_quitOrganization",t)}var u=e("2f14"),l=e("1b80");function f(t,a){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable}))),e.push.apply(e,n)}return e}function p(t){for(var a=1;a<arguments.length;a++){var e=null!=arguments[a]?arguments[a]:{};a%2?f(Object(e),!0).forEach((function(a){Object(i["a"])(t,a,e[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):f(Object(e)).forEach((function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(e,a))}))}return t}var m=[{title:"组织名称",dataIndex:"name",width:"30%"},{title:"操作",scopedSlots:{customRender:"action"}}],g={mixins:[l["a"]],data:function(){return{columns:m,dataSource:[],loading:!0,newData:{code:0},form:{},searchForm:{},actionInfo:{modalStatus:!1,confirmLoading:!1,modalTitle:"编辑组织",okText:"保存",cancelText:"放弃"},showMap:!1,options:[]}},computed:p({},Vuex.mapState({userInfo:function(t){return t.userInfo}})),created:function(){this.init()},methods:{moment:moment,init:function(t){var a=this;a.loading=!0,c(a.requestData).then((function(e){a.dataSource=e.data.list,a.pagination.total=e.data.total,a.loading=!1,t&&a.$store.dispatch("SET_CURRENT_ORGANIZATION",e.data.list[0]),a.$store.dispatch("SET_ORGANIZATION_LIST",e.data.list)}))},rowClick:function(t,a){var e=this;e.newData={code:""},"add"==a||"edit"==a||"new"==a?(setTimeout((function(){e.form&&e.form.resetFields()}),0),e.actionInfo.modalStatus=!0,e.actionInfo.modalTitle="添加组织","edit"==a&&setTimeout((function(){e.actionInfo.modalTitle="编辑组织",e.form.setFieldsValue({name:t.name,areas:[t.province.toString(),t.city.toString(),t.area.toString()],address:t.address}),e.newData=t}),0)):"quit"==a&&this.$confirm({title:"确定要退出此组织?",okText:"退出",okType:"danger",cancelText:"再想想",onOk:function(){return d({organizationCode:t.code}).then((function(t){Object(u["a"])(t)&&e.init(!0)})),Promise.resolve()}})},handleSubmit:function(){var t=this;t.form.validateFields((function(a,e){a||t.handleOk()}))},handleOk:function(){var t=this;t.actionInfo.confirmLoading=!0;var a=t.form.getFieldsValue();a.areas=JSON.stringify(a.areas),console.log(t.newData),t.newData.code?(t.newData.organizationCode=t.newData.code,a.organizationCode=t.newData.code):Object.assign(a,t.newData),s(a).then((function(e){t.actionInfo.confirmLoading=!1,Object(u["a"])(e)&&(t.newData.code?(t.newData.name=a.name,t.newData.address=a.address):t.dataSource.push(e.data),t.form.resetFields(),t.newData={code:0},t.actionInfo.modalStatus=!1,t.init())}))}}},b=g,h=e("2877"),w=Object(h["a"])(b,n,o,!1,null,null,null);a["default"]=w.exports}}]);