webpackJsonp([1],[,,,,,function(e,t,n){"use strict";n.d(t,"d",function(){return i}),n.d(t,"e",function(){return s}),n.d(t,"f",function(){return a}),n.d(t,"g",function(){return o}),n.d(t,"h",function(){return r}),n.d(t,"i",function(){return c}),n.d(t,"j",function(){return l}),n.d(t,"l",function(){return u}),n.d(t,"M",function(){return d}),n.d(t,"E",function(){return f}),n.d(t,"G",function(){return h}),n.d(t,"p",function(){return g}),n.d(t,"m",function(){return p}),n.d(t,"r",function(){return v}),n.d(t,"t",function(){return m}),n.d(t,"u",function(){return y}),n.d(t,"v",function(){return _}),n.d(t,"x",function(){return C}),n.d(t,"y",function(){return k}),n.d(t,"w",function(){return w}),n.d(t,"z",function(){return I}),n.d(t,"A",function(){return b}),n.d(t,"C",function(){return S}),n.d(t,"F",function(){return M}),n.d(t,"L",function(){return T}),n.d(t,"B",function(){return x}),n.d(t,"I",function(){return N}),n.d(t,"D",function(){return P}),n.d(t,"n",function(){return E}),n.d(t,"o",function(){return O}),n.d(t,"K",function(){return F}),n.d(t,"q",function(){return G}),n.d(t,"J",function(){return R}),n.d(t,"s",function(){return U}),n.d(t,"N",function(){return A}),n.d(t,"O",function(){return D}),n.d(t,"k",function(){return $}),n.d(t,"b",function(){return q}),n.d(t,"c",function(){return j}),n.d(t,"H",function(){return V}),n.d(t,"a",function(){return B});var i="wss",s="chat.shengtai.club",a=443,o=25e3,r=3e4,c="blob",l="CONNECT",u="DISCONNECT",d="CONNECT_ACK",f="PUBLISH",h="PUB_ACK",g="FRP",p="FP",v="UPUI",m="GPGI",y="GPGM",_="GAM",C="GC",k="GMI",w="GKM",I="GQ",b="GD",S="MP",M="MS",T="MN",x="MR",N="RMN",P="GQNUT",E="US",O="FAR",F="FRN",G="FHR",R="FN",U="MMI",L="https://"+s+":443/",A=L+"login",D=L+"send_code",$="vue-device-id",q="vue-user-id",j="vue-token",V=400,B=200},,function(e,t,n){"use strict";var i=n(2),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(4),u=n.n(l),d=n(3),f=n.n(d),h=n(286),g=n(13),p=n(83),v=n(5),m=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||s()(t)).call(this));return n.vueWebsocket=e,n}return f()(t,e),c()(t,[{key:"processMessage",value:function(e){g.a.log("AbstractMessageHandler messageId "+e.messageId+" proto content "+e.content);var t=this.vueWebsocket.resolvePromiseMap.get(e.messageId);t&&(clearTimeout(t.timeoutId),""==e.content?t.resolve(new p.a(v.H,e.content)):t.resolve(new p.a(v.a,this.notifyContent(e.content))),this.vueWebsocket.resolvePromiseMap.delete(e.messageId))}},{key:"notifyContent",value:function(e){return e}},{key:"vueWebsocketClient",get:function(){return this.vueWebsocket}}]),t}(h.a);t.a=m},,,function(e,t,n){"use strict";var i=n(14),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(5),u=function(){function e(){o()(this,e)}return c()(e,null,[{key:"saveConverSations",value:function(e){localStorage.setItem("coversations",s()(e))}},{key:"getConversations",value:function(){var e=localStorage.getItem("coversations");return JSON.parse(e)}},{key:"getLastMessageSeq",value:function(){return localStorage.getItem("last_message_seq")}},{key:"setUploadToken",value:function(e,t){localStorage.setItem(e,t)}},{key:"getImageUploadToken",value:function(){return localStorage.getItem("http://image.comsince.cn/")}},{key:"setLastMessageSeq",value:function(e){localStorage.setItem("last_message_seq",e)}},{key:"saveMessages",value:function(e){localStorage.setItem("messages",s()(e))}},{key:"getMessages",value:function(){var e=localStorage.getItem("messages");return JSON.parse(e)}},{key:"saveUserInfoList",value:function(e){localStorage.setItem("user_infos_list",s()(e))}},{key:"getUserInfoList",value:function(){var e=localStorage.getItem("user_infos_list");return JSON.parse(e)}},{key:"updateSendMessageCount",value:function(){var e=localStorage.getItem("send_message_count");e=e?parseInt(e)+1:1,localStorage.setItem("send_message_count",e)}},{key:"getSendMessageCount",value:function(){var e=localStorage.getItem("send_message_count");return e||(e=0),e}},{key:"resetSendMessageCount",value:function(){localStorage.setItem("send_message_count",0)}},{key:"getUserId",value:function(){return localStorage.getItem(l.b)}},{key:"setSelectTarget",value:function(e){localStorage.setItem("select_target",e)}},{key:"getSelectTarget",value:function(){return localStorage.getItem("select_target")}},{key:"setFriendRequestVersion",value:function(e){localStorage.setItem("friend_request_version",e)}},{key:"getFriendRequestVersion",value:function(){return localStorage.getItem("friend_request_version")}},{key:"saveMessageId",value:function(e){localStorage.setItem("message_id",e)}},{key:"getMessageId",value:function(){var e=localStorage.getItem("message_id");return e||(e=0),e}},{key:"clearLocalStore",value:function(){localStorage.setItem("coversations",""),localStorage.setItem("last_message_seq",""),localStorage.setItem("messages",""),localStorage.setItem("send_message_count",0),localStorage.setItem("select_target",""),localStorage.setItem("friend_request_version",0),localStorage.setItem(l.b,""),localStorage.setItem("message_id",0)}}]),e}();t.a=u},,function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=function e(){s()(this,e)};a.Unknown=0,a.Text=1,a.Voice=2,a.Image=3,a.Location=4,a.File=5,a.Video=6,a.Sticker=7,a.ImageText=8,a.P_Text=9,a.RecallMessage_Notification=80,a.Tip_Notification=90,a.Typing=91,a.CreateGroup_Notification=104,a.AddGroupMember_Notification=105,a.KickOffGroupMember_Notification=106,a.QuitGroup_Notification=107,a.DismissGroup_Notification=108,a.TransferGroupOwner_Notification=109,a.ChangeGroupName_Notification=110,a.ModifyGroupAlias_Notification=111,a.ChangeGroupPortrait_Notification=112,a.MuteGroupMember_Notification=113,a.ChangeJoinType_Notification=114,a.ChangePrivateChat_Notification=115,a.ChangeSearchable_Notificaiton=116,a.SetGroupManager_Notification=117,a.VOIP_CONTENT_TYPE_START=400,a.VOIP_CONTENT_TYPE_END=402,a.VOIP_CONTENT_TYPE_ACCEPT=401,a.VOIP_CONTENT_TYPE_SIGNAL=403,a.VOIP_CONTENT_TYPE_MODIFY=404,a.VOIP_CONTENT_TYPE_ACCEPT_T=405,t.a=a},function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=n(1),o=n.n(a),r=function(){function e(){s()(this,e)}return o()(e,null,[{key:"log",value:function(e){var t=new Date;console.log("["+t.toLocaleTimeString()+"] "+e)}}]),e}();t.a=r},,,,,,,,,,,,,function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=n(1),o=n.n(a),r=function(){function e(){s()(this,e)}return o()(e,null,[{key:"b64_to_utf8",value:function(e){return decodeURIComponent(escape(atob(e)))}},{key:"utf8_to_b64",value:function(e){return btoa(unescape(encodeURIComponent(e)))}}]),e}();t.a=r},function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=n(1),o=n.n(a),r=(n(13),n(65)),c=function(){function e(){s()(this,e)}return o()(e,[{key:"getDisplayName",value:function(e){var t=r.a.state.userInfoList,n=t.find(function(t){return t.uid==e}),i=e;return n?""==(i=n.displayName)&&(i=n.mobile):r.a.state.vueSocket.getUserInfo(e),i}},{key:"getPortrait",value:function(e){var t=r.a.state.userInfoList,n=t.find(function(t){return t.uid==e}),i="static/images/vue.jpg";return n&&(i=n.portrait),i}},{key:"createGroup",value:function(e,t){return r.a.state.vueSocket.createGroup(e,t)}},{key:"modifyGroupInfo",value:function(e){return r.a.state.vueSocket.modifyGroupInfo(e)}},{key:"quitGroup",value:function(e){return r.a.state.vueSocket.quitGroup(e)}},{key:"dismissGroup",value:function(e){return r.a.state.vueSocket.dismissGroup(e)}},{key:"getGroupMember",value:function(e){return r.a.state.vueSocket.getGroupMember(e)}},{key:"addMembers",value:function(e,t){return r.a.state.vueSocket.addMembers(e,t)}},{key:"kickeMembers",value:function(e,t){return r.a.state.vueSocket.kickeMembers(e,t)}},{key:"recallMessage",value:function(e){return r.a.state.vueSocket.recallMessage(e)}}]),e}(),l=new c;t.a=l},,function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=n(1),o=n.n(a),r=n(140),c=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];s()(this,e),this.mentionedType=0,this.mentionedTargets=[],this.type=t,this.mentionedType=n,this.mentionedTargets=i}return o()(e,[{key:"digest",value:function(){return"...digest..."}},{key:"encode",value:function(){var e=new r.a;return e.type=this.type,e.mentionedType=this.mentionedType,e.mentionedTargets=this.mentionedTargets,e}},{key:"decode",value:function(e){this.type=e.type,this.mentionedType=e.mentionedType,this.mentionedTargets=e.mentionedTargets}}]),e}();t.a=c},,,,,,,,,,,function(e,t,n){"use strict";var i=n(2),s=n.n(i),a=n(0),o=n.n(a),r=n(4),c=n.n(r),l=n(3),u=n.n(l),d=n(53),f=function(e){function t(){var e,n,i,a;o()(this,t);for(var r=arguments.length,l=Array(r),u=0;u<r;u++)l[u]=arguments[u];return n=i=c()(this,(e=t.__proto__||s()(t)).call.apply(e,[this].concat(l))),i.groupId="",a=n,c()(i,a)}return u()(t,e),t}(d.a);t.a=f},,,,,,,,,,,,function(e,t,n){"use strict";var i=n(28),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(141),u=n(307),d=n(12),f=n(145),h=n(308),g=n(137),p=n(133),v=n(134),m=n(136),y=n(138),_=n(135),C=n(269),k=n(303),w=n(302),I=n(53),b=n(301),S=n(306),M=n(67),T=n(305),x=n(304),N=n(10),P=function(){function e(){o()(this,e)}return c()(e,null,[{key:"getMessageContentClazz",value:function(t){var n=!0,i=!1,a=void 0;try{for(var o,r=s()(e.MessageContents);!(n=(o=r.next()).done);n=!0){var c=o.value;if(c.type===t)return c.contentClazz?c.contentClazz:h.a}}catch(e){i=!0,a=e}finally{try{!n&&r.return&&r.return()}finally{if(i)throw a}}return console.log("message type "+t+" is unknown"),u.a}},{key:"convert2MessageContent",value:function(e,t){var n=null,i=this.getMessageContentClazz(t.type);if(i!=h.a){var s=new i;try{s.decode(t),s instanceof I.a&&(s.fromSelf=e===N.a.getUserId()),n=s}catch(e){console.log("decode message content error "+t)}}return n}},{key:"getMessageContentPersitFlag",value:function(t){var n=!0,i=!1,a=void 0;try{for(var o,r=s()(e.MessageContents);!(n=(o=r.next()).done);n=!0){var c=o.value;if(c.type===t)return c.flag}}catch(e){i=!0,a=e}finally{try{!n&&r.return&&r.return()}finally{if(i)throw a}}return 0}},{key:"isDisplayableMessage",value:function(t){var n=t.content;return e.getMessageContentPersitFlag(n.type)==l.a.Persist||e.getMessageContentPersitFlag(n.type)==l.a.Persist_And_Count}}]),e}();P.MessageContents=[{name:"unknown",flag:l.a.Persist,type:d.a.Unknown,contentClazz:u.a},{name:"text",flag:l.a.Persist_And_Count,type:d.a.Text,contentClazz:f.a},{name:"ptext",flag:l.a.Persist,type:d.a.P_Text},{name:"voice",flag:l.a.Persist_And_Count,type:d.a.Voice},{name:"image",flag:l.a.Persist_And_Count,type:d.a.Image,contentClazz:y.a},{name:"location",flag:l.a.Persist_And_Count,type:d.a.Location},{name:"file",flag:l.a.Persist_And_Count,type:d.a.File},{name:"video",flag:l.a.Persist_And_Count,type:d.a.Video},{name:"sticker",flag:l.a.Persist_And_Count,type:d.a.Sticker},{name:"imageText",flag:l.a.Persist_And_Count,type:d.a.ImageText},{name:"tip",flag:l.a.Persist,type:d.a.Tip_Notification},{name:"typing",flag:l.a.Transparent,type:d.a.Typing},{name:"addGroupMemberNotification",flag:l.a.Persist,type:d.a.AddGroupMember_Notification,contentClazz:b.a},{name:"changeGroupNameNotification",flag:l.a.Persist,type:d.a.ChangeGroupName_Notification,contentClazz:w.a},{name:"changeGroupPortraitNotification",flag:l.a.Persist,type:d.a.ChangeGroupPortrait_Notification},{name:"createGroupNotification",flag:l.a.Persist,type:d.a.CreateGroup_Notification,contentClazz:k.a},{name:"dismissGroupNotification",flag:l.a.Persist,type:d.a.DismissGroup_Notification,contentClazz:x.a},{name:"kickoffGroupMemberNotification",flag:l.a.Persist,type:d.a.KickOffGroupMember_Notification,contentClazz:T.a},{name:"modifyGroupAliasNotification",flag:l.a.Persist,type:d.a.ModifyGroupAlias_Notification},{name:"quitGroupNotification",flag:l.a.Persist,type:d.a.QuitGroup_Notification,contentClazz:S.a},{name:"transferGroupOwnerNotification",flag:l.a.Persist,type:d.a.TransferGroupOwner_Notification},{name:"recall",flag:l.a.Persist,type:d.a.RecallMessage_Notification,contentClazz:M.a},{name:"callStartMessageContent",flag:l.a.Persist,type:d.a.VOIP_CONTENT_TYPE_START,contentClazz:g.a},{name:"callAnswerMessageContent",flag:l.a.No_Persist,type:d.a.VOIP_CONTENT_TYPE_ACCEPT,contentClazz:p.a},{name:"callAnswerTMessageContent",flag:l.a.Transparent,type:d.a.VOIP_CONTENT_TYPE_ACCEPT_T,contentClazz:v.a},{name:"callByeMessageContent",flag:l.a.No_Persist,type:d.a.VOIP_CONTENT_TYPE_END,contentClazz:_.a},{name:"callSignalMessageContent",flag:l.a.Transparent,type:d.a.VOIP_CONTENT_TYPE_SIGNAL,contentClazz:m.a},{name:"callModifyMessageContent",flag:l.a.No_Persist,type:d.a.VOIP_CONTENT_TYPE_MODIFY,contentClazz:C.a},{name:"callAddParticipant",flag:l.a.Persist,type:d.a.VOIP_CONTENT_TYPE_ADD_PARTICIPANT},{name:"callMuteVideo",flag:l.a.No_Persist,type:d.a.VOIP_CONTENT_TYPE_MUTE_VIDEO}],t.a=P},function(e,t,n){"use strict";var i=n(2),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(4),u=n.n(l),d=n(3),f=n.n(d),h=n(29),g=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||s()(t)).call(this,e));return n.fromSelf=!1,n}return f()(t,e),c()(t,[{key:"digest",value:function(e){var t="";try{t=this.formatNotification(e)}catch(e){console.log("disgest",e)}return t}},{key:"formatNotification",value:function(e){return"..nofication.."}}]),t}(h.a);t.a=g},,,,,,,,,,,function(e,t,n){"use strict";var i=n(16),s=n(502);i.default.use(s.a);var a=new s.a({routes:[{path:"/login",component:n(481)},{path:"/",component:n(482),redirect:"conversation",children:[{path:"conversation",name:"conversation",component:n(477),hidden:!0},{path:"friend",name:"friend",component:n(478),hidden:!0}]}],linkActiveClass:"active"});t.a=a},function(e,t,n){"use strict";var i=n(320),s=n.n(i),a=n(14),o=n.n(a),r=n(28),c=n.n(r),l=n(54),u=n.n(l),d=n(16),f=n(21),h=n(64),g=n(84),p=n(271),v=n(5),m=n(312),y=n(149),_=n(139),C=n(142),k=n(68),w=n(10),I=n(148),b=n(87),S=n(191),M=n(52),T=n(82),x=n(143),N=(n(13),n(67));d.default.use(f.c);var P=(new Date,{searchText:"",user:{name:"ratel",img:"static/images/vue.jpg"},friendlist:[{id:0,wxid:"new",initial:"新的朋友",img:"static/images/newfriend.jpg",signature:"",nickname:"新的朋友",sex:0,remark:"新的朋友",area:""}],friendIds:[],emojis:[{file:"100.gif",code:"/::)",title:"微笑",reg:/\/::\)/g},{file:"101.gif",code:"/::~",title:"伤心",reg:/\/::~/g},{file:"102.gif",code:"/::B",title:"美女",reg:/\/::B/g},{file:"103.gif",code:"/::|",title:"发呆",reg:/\/::\|/g},{file:"104.gif",code:"/:8-)",title:"墨镜",reg:/\/:8-\)/g},{file:"105.gif",code:"/::<",title:"哭",reg:/\/::</g},{file:"106.gif",code:"/::$",title:"羞",reg:/\/::\$/g},{file:"107.gif",code:"/::X",title:"哑",reg:/\/::X/g},{file:"108.gif",code:"/::Z",title:"睡",reg:/\/::Z/g},{file:"109.gif",code:"/::'(",title:"哭",reg:/\/::'\(/g},{file:"110.gif",code:"/::-|",title:"囧",reg:/\/::-\|/g},{file:"111.gif",code:"/::@",title:"怒",reg:/\/::@/g},{file:"112.gif",code:"/::P",title:"调皮",reg:/\/::P/g},{file:"113.gif",code:"/::D",title:"笑",reg:/\/::D/g},{file:"114.gif",code:"/::O",title:"惊讶",reg:/\/::O/g},{file:"115.gif",code:"/::(",title:"难过",reg:/\/::\(/g},{file:"116.gif",code:"/::+",title:"酷",reg:/\/::\+/g},{file:"117.gif",code:"/:--b",title:"汗",reg:/\/:--b/g},{file:"118.gif",code:"/::Q",title:"抓狂",reg:/\/::Q/g},{file:"119.gif",code:"/::T",title:"吐",reg:/\/::T/g},{file:"120.gif",code:"/:,@P",title:"笑",reg:/\/:,@P/g},{file:"121.gif",code:"/:,@-D",title:"快乐",reg:/\/:,@-D/g},{file:"122.gif",code:"/::d",title:"奇",reg:/\/::d/g},{file:"123.gif",code:"/:,@o",title:"傲",reg:/\/:,@o/g},{file:"124.gif",code:"/::g",title:"饿",reg:/\/::g/g},{file:"125.gif",code:"/:|-)",title:"累",reg:/\/:\|-\)/g},{file:"126.gif",code:"/::!",title:"吓",reg:/\/::!/g},{file:"127.gif",code:"/::L",title:"汗",reg:/\/::L/g},{file:"128.gif",code:"/::>",title:"高兴",reg:/\/::>/g},{file:"129.gif",code:"/::,@",title:"闲",reg:/\/::,@/g},{file:"130.gif",code:"/:,@f",title:"努力",reg:/\/:,@f/g},{file:"131.gif",code:"/::-S",title:"骂",reg:/\/::-S/g},{file:"133.gif",code:"/:,@x",title:"秘密",reg:/\/:,@x/g},{file:"134.gif",code:"/:,@@",title:"乱",reg:/\/:,@@/g},{file:"135.gif",code:"/::8",title:"疯",reg:/\/::8/g},{file:"136.gif",code:"/:,@!",title:"哀",reg:/\/:,@!/g},{file:"137.gif",code:"/:!!!",title:"鬼",reg:/\/:!!!/g},{file:"138.gif",code:"/:xx",title:"打击",reg:/\/:xx/g},{file:"139.gif",code:"/:bye",title:"bye",reg:/\/:bye/g},{file:"142.gif",code:"/:handclap",title:"鼓掌",reg:/\/:handclap/g},{file:"145.gif",code:"/:<@",title:"什么",reg:/\/:<@/g},{file:"147.gif",code:"/::-O",title:"累",reg:/\/::-O/g},{file:"153.gif",code:"/:@x",title:"吓",reg:/\/:@x/g},{file:"155.gif",code:"/:pd",title:"刀",reg:/\/:pd/g},{file:"156.gif",code:"/:<W>",title:"水果",reg:/\/:<W>/g},{file:"157.gif",code:"/:beer",title:"酒",reg:/\/:beer/g},{file:"158.gif",code:"/:basketb",title:"篮球",reg:/\/:basketb/g},{file:"159.gif",code:"/:oo",title:"乒乓",reg:/\/:oo/g},{file:"195.gif",code:"/:circle",title:"跳舞",reg:/\/:circle/g},{file:"160.gif",code:"/:coffee",title:"咖啡",reg:/\/:coffee/g}],selectId:1,selectTarget:"",selectFriendId:0,vueSocket:null,voipClient:null,conversations:[],messages:[],searchUsers:[],friendRequests:[],newFriendRequestCount:0,deviceId:"",userId:"",token:"",userInfoList:[],groupInfoList:[],tempGroupMembers:[],notify:"",firstLogin:!1,emptyMessage:!1,changeFullScreenMode:!1,appHeight:638,visibilityState:"hidden",showChatBox:!1,showAudioBox:!1,showSearchFriendDialog:!1,showCreateGroupDialog:!1,showGroupInfo:!1,showMessageRightMenu:[],waitUserIds:[],groupOperateState:0,groupMemberMap:new u.a,groupMemberTracker:0}),E={initData:function(e){e.userId=localStorage.getItem("vue-user-id"),e.token=localStorage.getItem("vue-token");var t=new g.a;e.vueSocket=t,e.voipClient=new p.a(G);var n=w.a.getConversations();n&&(e.conversations=n);var i=w.a.getMessages();i&&(e.messages=i),e.selectTarget=w.a.getSelectTarget();var s=w.a.getUserInfoList();s&&(e.userInfoList=s),e.notify=new S.a({effect:"flash",interval:500,onclick:function(){console.log("on click"),e.notify.close()}})},search:function(e,t){e.searchText=t},selectSession:function(e,t){e.selectId=t},selectConversation:function(e,t){e.selectTarget=t;var n=e.conversations.find(function(e){return e.conversationInfo.target===t});n&&n.conversationInfo.unreadCount&&(n.conversationInfo.unreadCount.unread=0)},clearUnreadStatus:function(e){var t=e.conversations.find(function(t){return t.conversationInfo.target===e.selectTarget});t&&t.conversationInfo.unreadCount&&(t.conversationInfo.unreadCount.unread=0)},selectFriend:function(e,t){e.selectFriendId=t,console.log("select friend id "+t),0===t&&(0==e.friendRequests.length?e.vueSocket.getFriendRequest(w.a.getFriendRequestVersion()):e.newFriendRequestCount=0)},updateFriendList:function(e,t){0===e.friendlist.length&&e.friendlist.push({id:0,wxid:"new",initial:"新的朋友",img:"static/images/newfriend.jpg",signature:"",nickname:"新的朋友",sex:0,remark:"新的朋友",area:""});for(var n in t){var i=t[n];if(i.wxid!=e.userId){if(e.friendIds.find(function(e){return e===i.wxid})){var s=!1,a=!0,o=!1,r=void 0;try{for(var l,u=c()(e.friendlist);!(a=(l=u.next()).done);a=!0){var d=l.value;d.wxid===i.wxid&&(s=!0,d.nickname=i.nickname,d.img=i.img)}}catch(e){o=!0,r=e}finally{try{!a&&u.return&&u.return()}finally{if(o)throw r}}s||(i.id=e.friendlist.length,e.friendlist.push(i))}}}var f=!0,h=!1,g=void 0;try{for(var p,v=c()(e.conversations);!(f=(p=v.next()).done);f=!0){var m=p.value,d=e.friendlist.find(function(e){return e.wxid===m.conversationInfo.target});d&&(m.name=d.nickname,m.img=d.img)}}catch(e){h=!0,g=e}finally{try{!f&&v.return&&v.return()}finally{if(h)throw g}}var y=!0,_=!1,C=void 0;try{for(var k,w=c()(e.messages);!(y=(k=w.next()).done);y=!0){var I=k.value,d=e.friendlist.find(function(e){return e.wxid===I.target});d&&(I.name=d.nickname)}}catch(e){_=!0,C=e}finally{try{!y&&w.return&&w.return()}finally{if(_)throw C}}},updateUserInfos:function(e,t){var n=!0,i=!1,s=void 0;try{for(var a,o=c()(t);!(n=(a=o.next()).done);n=!0){var r=a.value;r.uid===e.userId&&(e.user.img=r.portrait,e.user.name=r.displayName);var l=!1,u=0;for(var d in e.userInfoList){if(e.userInfoList[d].uid==r.uid){l=!0,u=d;break}}l?e.userInfoList.splice(u,1,r):e.userInfoList.push(r)}}catch(e){i=!0,s=e}finally{try{!n&&o.return&&o.return()}finally{if(i)throw s}}},updateGroupInfos:function(e,t){var n=!0,i=!1,s=void 0;try{for(var a,o=c()(t);!(n=(a=o.next()).done);n=!0){var r=a.value,l=!1,u=0;for(var d in e.groupInfoList){if(e.groupInfoList[d].target==r.target){l=!0,u=d;break}}l?e.groupInfoList.splice(u,1,r):e.groupInfoList.push(r)}}catch(e){i=!0,s=e}finally{try{!n&&o.return&&o.return()}finally{if(i)throw s}}console.log("group size "+e.groupInfoList.length),this.commit("updateConversationIntro",t)},getGroupInfo:function(e,t){e.vueSocket.getGroupInfo(t,!1)},getGroupMember:function(e,t){e.vueSocket.getGroupMember(t,!0)},quitGroup:function(e,t){e.vueSocket.quitGroup(t)},deleteConversation:function(e,t){for(var n=-1,i=0;i<e.conversations.length;i++)if(e.conversations[i].conversationInfo.target==t){n=i;break}console.log("quit group index "+n),-1!=n&&e.conversations.splice(n,1),e.conversations.length>0&&(e.selectTarget=e.conversations[0].conversationInfo.target)},updateTempGroupMember:function(e,t){e.tempGroupMembers=t},sendMessage:function(e,t){var n=_.a.toMessage(e,t),i=C.a.convertToProtoMessage(n);if(console.log("send protomessage "+o()(i)),M.a.isDisplayableMessage(i)){var s=e.conversations.find(function(e){return e.conversationInfo.target===i.target});s.conversationInfo.lastMessage=i,s.conversationInfo.timestamp=i.timestamp;var a=e.messages.find(function(e){return e.target===i.target});if(a)a.protoMessages.push(i);else{a=new y.a,a.target=i.target;var r=e.friendlist.find(function(e){return e.wxid===i.target});null!=r&&(a.name=r.nickname),a.protoMessages.push(i),e.messages.push(a)}}e.vueSocket.sendMessage(i)},send:function(e){var t=e.friendlist.find(function(t){return t.id===e.selectFriendId}),n=e.conversations.find(function(e){return e.conversationInfo.target===t.wxid});if(n)e.selectTarget=n.conversationInfo.target;else{e.selectTarget=t.wxid;var i=new I.a;i.conversationType=k.a.Single,i.target=t.wxid,i.line=0,i.top=!1,i.slient=!1,i.timestamp=(new Date).getTime(),i.unreadCount=new b.a,i.lastMessage=null;var s=new m.a;s.name=t.remark,s.img=t.img,s.conversationInfo=i,e.conversations.unshift(s)}h.a.push({path:"/conversation"})},updateConversationInfo:function(e,t){var n,i,s=!1;for(var a in e.conversations){var o=e.conversations[a];if(o.conversationInfo.conversationType==t.conversationType&&o.conversationInfo.target==t.target){s=!0,i=a,o.conversationInfo.lastMessage=t.lastMessage,o.conversationInfo.timestamp=t.lastMessage.timestamp,n=o;break}}if(s&&(e.conversations.splice(i,1),e.conversations.unshift(n)),!s){if(n=new m.a,n.conversationInfo=t,t.conversationType==k.a.Single){var r=e.friendlist.find(function(e){return e.wxid===t.target});if(null!=r){var c=r.nickname,l=null==r.img?"static/images/vue.jpg":r.img;n.name=c,n.img=l}else n.name=t.target,n.img="static/images/vue.jpg"}else n.name=t.target,n.img||e.vueSocket.getGroupInfo(t.target,!1),n.img="static/images/vue.jpg";e.conversations.push(n)}var u=e.selectTarget===t.target,d="visible"===e.visibilityState;console.log("current message "+u+" visible "+d+" first login "+e.firstLogin);var f=1===t.lastMessage.direction;if(!e.firstLogin&&(!u||u&&!d)&&f){var h=n.conversationInfo.unreadCount.unread+=1,g=t.lastMessage.content.searchableContent;console.log("target "+t.target+" unread count "+h+" notify body "+g),g||(g=x.a.typeToContent(t.lastMessage.content)),e.firstLogin||e.notify.notify({title:n.name,body:g,icon:n.img})}},updateConversationIntro:function(e,t){var n=!0,i=!1,s=void 0;try{for(var a,o=c()(t);!(n=(a=o.next()).done);n=!0){var r=a.value,l=e.conversations.find(function(e){return e.conversationInfo.target===r.target});l&&(console.log("update conversation name "+l.name),l.name=r.name,r.portrait&&(l.img=r.portrait));var u=e.messages.find(function(e){return e.target===r.target});u&&(u.name=r.name+"("+r.memberCount+")")}}catch(e){i=!0,s=e}finally{try{!n&&o.return&&o.return()}finally{if(i)throw s}}},addProtoMessage:function(e,t){-1==e.waitUserIds.indexOf(t.from)&&(console.log("waiting for get userId "+t.from),e.waitUserIds.push(t.from),e.vueSocket.getUserInfos([t.from]));var n=!1,i=!1,s=!0,a=!1,o=void 0;try{for(var r,l=c()(e.messages);!(s=(r=l.next()).done);s=!0){var u=r.value;if(t.target==u.target){n=!0;u.protoMessages.find(function(e){return e.messageId===t.messageId})?i=!0:u.protoMessages.push(t)}}}catch(e){a=!0,o=e}finally{try{!s&&l.return&&l.return()}finally{if(a)throw o}}if(!n){var u=new y.a,d=e.friendlist.find(function(e){return e.wxid===t.target});null!=d&&(u.name=d.nickname),u.target=t.target,u.protoMessages.push(t),e.messages.push(u)}if(!i){var f=new I.a;f.conversationType=t.conversationType,f.target=t.target,f.line=0,f.top=!1,f.slient=!1,f.timestamp=t.timestamp,f.lastMessage=t,f.unreadCount=new b.a,this.commit("updateConversationInfo",f)}},updateProtoMessageUid:function(e,t){var n=e.messages.find(function(t){return t.target===e.selectTarget});if(n){var i=n.protoMessages.find(function(e){return e.messageId==t.messageId});i&&(i.messageUid=t.messageUid)}},updateMessageStatus:function(e,t){var n=e.messages.find(function(t){return t.target===e.selectTarget});if(n){var i=n.protoMessages.find(function(e){return e.messageId==t.messageId});i&&(i.status=t.status)}},updateMessageContent:function(e,t){var n=!1,i=!0,s=!1,a=void 0;try{for(var o,r=c()(e.messages);!(i=(o=r.next()).done);i=!0){var l=o.value,u=!0,d=!1,f=void 0;try{for(var h,g=c()(l.protoMessages);!(u=(h=g.next()).done);u=!0){var p=h.value;if(p.messageUid==t.messageUid){var v=new N.a(t.fromUser,t.messageUid);p.content=v.encode(),n=!0;break}}}catch(e){d=!0,f=e}finally{try{!u&&g.return&&g.return()}finally{if(d)throw f}}if(n)break}}catch(e){s=!0,a=e}finally{try{!i&&r.return&&r.return()}finally{if(s)throw a}}},loginOut:function(e,t){e.userId="",e.token="",localStorage.setItem(v.b,""),localStorage.setItem(v.c,""),e.selectTarget="",e.vueSocket.sendDisConnectMessage(),e.vueSocket=null,e.voipClient=null,e.conversations=[],e.messages=[],e.friendlist=[],e.friendIds=[],e.selectFriendId=0,e.friendRequests=[],e.waitUserIds=[],e.userInfoList=[],e.newFriendRequestCount=0,e.groupMemberTracker=0,e.showMessageRightMenu=[],e.emptyMessage=!1,w.a.clearLocalStore(),T.a.removeOnReceiveMessageListener(),h.a.push({path:"/login"})},changetFirstLogin:function(e,t){console.log("first login "+t),e.firstLogin=t},getUploadToken:function(e,t){e.vueSocket.getUploadToken(t)},visibilityChange:function(e,t){e.visibilityState=t},searchUser:function(e,t){e.vueSocket.searchUser(t)},updateSearchUser:function(e,t){e.searchUsers=[];var n=!0,i=!1,s=void 0;try{for(var a,o=c()(t);!(n=(a=o.next()).done);n=!0){var r=a.value;e.friendlist.find(function(e){return e.wxid===r.uid})||r.uid===e.userId||e.searchUsers.push(r)}}catch(e){i=!0,s=e}finally{try{!n&&o.return&&o.return()}finally{if(i)throw s}}},sendFriendAddRequest:function(e,t){e.vueSocket.sendFriendAddRequest(t)},updateFriendRequest:function(e,t){var n=!0,i=!1,s=void 0;try{for(var a,o=c()(t);!(n=(a=o.next()).done);n=!0){var r=a.value,l=e.friendRequests.find(function(e){return e.from===r.from});l?l.status=r.status:(0==r.status&&(e.newFriendRequestCount+=1),e.friendRequests.push(r))}}catch(e){i=!0,s=e}finally{try{!n&&o.return&&o.return()}finally{if(i)throw s}}},handleFriendRequest:function(e,t){e.friendRequests.find(function(e){return e.from===t.targetUid}).status=1,e.vueSocket.handleFriendRequest(t)},updateFriendIds:function(e,t){t&&(e.friendIds=t)},modifyMyInfo:function(e,t){e.vueSocket.modifyMyInfo(t)},getUserInfos:function(e,t){e.vueSocket.getUserInfos(t)},changeEmptyMessageState:function(e,t){e.emptyMessage=t}},O={currentGroupMembers:function(){return P.groupMemberMap.has(P.selectTarget)?P.groupMemberMap.get(P.selectTarget):[]},searchedConversationList:function(){return P.conversations.filter(function(e){return!!e.name&&e.name.includes(P.searchText)})},isSingleConversation:function(){var e=P.conversations.find(function(e){return e.conversationInfo.target===P.selectTarget});return!!e&&e.conversationInfo.conversationType===k.a.Single},searchedFriendlist:function(){var e=new u.a,t=[],n=[],i=!0,a=!1,o=void 0;try{for(var r,l=c()(P.friendlist);!(i=(r=l.next()).done);i=!0){var d=r.value,f={id:d.id,wxid:d.wxid,initial:d.initial,img:d.img,signature:d.signature,nickname:d.nickname,sex:d.sex,remark:d.remark,area:d.area};if(0!=f.id)if(f.initial){var h=e.get(f.initial);h?(f.initial="",h.push(f)):(h=[],h.push(f),e.set(f.initial,h))}else t.push(f)}}catch(e){a=!0,o=e}finally{try{!i&&l.return&&l.return()}finally{if(a)throw o}}if(P.friendlist.length>0&&n.push(P.friendlist[0]),t.length>0){var g=!0,p=!1,v=void 0;try{for(var m,y=c()(t);!(g=(m=y.next()).done);g=!0){var f=m.value;n.push(f)}}catch(e){p=!0,v=e}finally{try{!g&&y.return&&y.return()}finally{if(p)throw v}}}var _=!0,C=!1,k=void 0;try{for(var w,I=c()(e);!(_=(w=I.next()).done);_=!0){var b=w.value,S=s()(b,2),M=(S[0],S[1]),T=!0,x=!1,N=void 0;try{for(var E,O=c()(M);!(T=(E=O.next()).done);T=!0){var f=E.value;n.push(f)}}catch(e){x=!0,N=e}finally{try{!T&&O.return&&O.return()}finally{if(x)throw N}}}}catch(e){C=!0,k=e}finally{try{!_&&I.return&&I.return()}finally{if(C)throw k}}return n.filter(function(e){return e.remark.includes(P.searchText)})},onlyFriendlist:function(){var e=P.friendlist.slice(1,P.friendlist.length),t=[],n=!0,i=!1,s=void 0;try{for(var a,o=c()(e);!(n=(a=o.next()).done);n=!0){var r=a.value;console.log("friend only initial "+r.initial),t.push({id:r.id,wxid:r.wxid,remark:r.remark,img:r.img,initial:r.initial,checked:!1})}}catch(e){i=!0,s=e}finally{try{!n&&o.return&&o.return()}finally{if(i)throw s}}return t},selectedChat:function(e){var t=e.messages.find(function(t){return t.target===e.selectTarget});if(console.log("select target "+e.selectTarget),null==t){var n="",i="";if(e.friendlist){var s=e.friendlist.find(function(t){return t.wxid==e.selectTarget});s&&(n=s.nickname,i=s.wxid)}t={name:n,target:i,protoMessages:[]}}return console.log("selectedChat "+t.name+" target "+t.target),t},selectedFriend:function(e){return e.friendlist.find(function(t){return t.id===e.selectFriendId})},messages:function(e){var t=e.messages.find(function(t){return t.target===e.selectTarget});return null==t?[]:t.protoMessages},unreadTotalCount:function(e){var t=0;if(e.conversations){var n=!0,i=!1,s=void 0;try{for(var a,o=c()(e.conversations);!(n=(a=o.next()).done);n=!0){var r=a.value;r.conversationInfo.unreadCount&&(t+=r.conversationInfo.unreadCount.unread)}}catch(e){i=!0,s=e}finally{try{!n&&o.return&&o.return()}finally{if(i)throw s}}}return 0===t?(e.notify.faviconClear(),e.notify.setTitle(),e.notify.close()):(e.notify.setFavicon(t),e.notify.setTitle("你有新的消息未读")),t}},F={search:function(e,t){var n=e.commit;setTimeout(function(){n("search",t)},100)},selectSession:function(e,t){return(0,e.commit)("selectSession",t)},selectConversation:function(e,t){return(0,e.commit)("selectConversation",t)},clearUnreadStatus:function(e,t){return(0,e.commit)("clearUnreadStatus",t)},selectFriend:function(e,t){return(0,e.commit)("selectFriend",t)},updateFriendList:function(e,t){return(0,e.commit)("updateFriendList",t)},updateUserInfos:function(e,t){return(0,e.commit)("updateUserInfos",t)},sendMessage:function(e,t){return(0,e.commit)("sendMessage",t)},send:function(e){return(0,e.commit)("send")},initData:function(e){return(0,e.commit)("initData")},updateConversationInfo:function(e,t){return(0,e.commit)("updateConversationInfo",t)},updateConversationIntro:function(e,t){return(0,e.commit)("updateConversationIntro",t)},addProtoMessage:function(e,t){return(0,e.commit)("addProtoMessage",t)},loginOut:function(e,t){return(0,e.commit)("loginOut",t)},changetFirstLogin:function(e,t){return(0,e.commit)("changetFirstLogin",t)},getUploadToken:function(e,t){return(0,e.commit)("getUploadToken",t)},visibilityChange:function(e,t){return(0,e.commit)("visibilityChange",t)},searchUser:function(e,t){return(0,e.commit)("searchUser",t)},updateSearchUser:function(e,t){return(0,e.commit)("updateSearchUser",t)},sendFriendAddRequest:function(e,t){return(0,e.commit)("sendFriendAddRequest",t)},updateFriendRequest:function(e,t){return(0,e.commit)("updateFriendRequest",t)},handleFriendRequest:function(e,t){return(0,e.commit)("handleFriendRequest",t)},updateFriendIds:function(e,t){return(0,e.commit)("updateFriendIds",t)},modifyMyInfo:function(e,t){return(0,e.commit)("modifyMyInfo",t)},getUserInfos:function(e,t){return(0,e.commit)("getUserInfos",t)},updateGroupInfos:function(e,t){return(0,e.commit)("updateGroupInfos",t)},getGroupInfo:function(e,t){return(0,e.commit)("getGroupInfo",t)},getGroupMember:function(e,t){return(0,e.commit)("getGroupMember",t)},quitGroup:function(e,t){return(0,e.commit)("quitGroup",t)},updateTempGroupMember:function(e,t){return(0,e.commit)("updateTempGroupMember",t)},changeEmptyMessageState:function(e,t){return(0,e.commit)("changeEmptyMessageState",t)},updateProtoMessageUid:function(e,t){return(0,e.commit)("updateProtoMessageUid",t)},updateMessageStatus:function(e,t){return(0,e.commit)("updateMessageStatus",t)},updateMessageContent:function(e,t){return(0,e.commit)("updateMessageContent",t)},deleteConversation:function(e,t){return(0,e.commit)("deleteConversation",t)}},G=new f.c.Store({state:P,mutations:E,getters:O,actions:F});G.watch(function(e){return e.conversations},function(e){w.a.saveConverSations(e)},{deep:!0}),G.watch(function(e){return e.messages},function(e){w.a.saveMessages(e)},{deep:!0}),G.watch(function(e){return e.userInfoList},function(e){w.a.saveUserInfoList(e)},{deep:!0}),G.watch(function(e){return e.selectTarget},function(e){w.a.setSelectTarget(e)},{deep:!0}),t.a=G},function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=function e(){s()(this,e)};a.Sending=0,a.Sent=1,a.SendFailure=2,a.Mentioned=3,a.AllMentioned=4,a.Unread=5,a.Readed=6,a.Played=7,t.a=a},function(e,t,n){"use strict";var i=n(2),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(4),u=n.n(l),d=n(17),f=n.n(d),h=n(3),g=n.n(h),p=n(53),v=n(12),m=n(26),y=n(27),_=function(e){function t(e,n){o()(this,t);var i=u()(this,(t.__proto__||s()(t)).call(this,v.a.RecallMessage_Notification));return i.operatorId="",i.messageUid="",i.operatorId=e,i.messageUid=n,i}return g()(t,e),c()(t,[{key:"formatNotification",value:function(){return this.fromSelf?"您撤回了一条消息":y.a.getDisplayName(this.operatorId)+"撤回了一条消息"}},{key:"encode",value:function(){var e=f()(t.prototype.__proto__||s()(t.prototype),"encode",this).call(this);return e.content=this.operatorId,e.binaryContent=m.a.utf8_to_b64(this.messageUid.toString()),e}},{key:"decode",value:function(e){f()(t.prototype.__proto__||s()(t.prototype),"decode",this).call(this,e),this.operatorId=e.content,this.messageUid=m.a.b64_to_utf8(e.binaryContent)}}]),t}(p.a);t.a=_},function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=function e(){s()(this,e)};a.Single=0,a.Group=1,a.ChatRoom=2,a.Channel=3,t.a=a},,,,,,,,,,,,,function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=function e(){s()(this,e)};a.STATUS_IDLE=0,a.STATUS_OUTGOING=1,a.STATUS_INCOMING=2,a.STATUS_CONNECTING=3,a.STATUS_CONNECTED=4,t.a=a},function(e,t,n){"use strict";var i=n(28),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=function(){function e(){o()(this,e)}return c()(e,null,[{key:"addReceiveMessageListener",value:function(e){this.onReceiveMessageListeners.push(e)}},{key:"onReceiveMessage",value:function(e){var t=!0,n=!1,i=void 0;try{for(var a,o=s()(this.onReceiveMessageListeners);!(t=(a=o.next()).done);t=!0){a.value.onReceiveMessage(e)}}catch(e){n=!0,i=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw i}}}},{key:"removeOnReceiveMessageListener",value:function(){e.onReceiveMessageListeners=[]}}]),e}();l.onReceiveMessageListeners=[],t.a=l},function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=function e(t,n){s()(this,e),this.code=t,this.result=n};t.a=a},function(e,t,n){"use strict";var i=n(38),s=n.n(i),a=n(28),o=n.n(a),r=n(153),c=n.n(r),l=n(152),u=n.n(l),d=n(54),f=n.n(d),h=n(0),g=n.n(h),p=n(1),v=n.n(p),m=n(5),y=n(313),_=n(309),C=n(274),k=n(282),w=n(283),I=n(294),b=n(290),S=n(279),M=n(296),T=n(281),x=n(10),N=n(295),P=n(277),E=n(289),O=n(278),F=n(284),G=n(288),R=n(287),U=n(280),L=n(272),A=n(5),D=n(65),$=(n(13),n(146)),q=n(147),j=n(86),V=n(311),B=n(275),z=n(292),H=n(192),W=(n.n(H),n(83)),J=n(293),Y=n(291),K=n(273),Q=n(285),X=n(276),Z=function(){function e(){g()(this,e),this.handlerList=[],this.userDisconnect=!1,this.isconnected=!1,this.resolvePromiseMap=new f.a,this.ws_protocol=A.d,this.ip=A.e,this.port=A.f,this.heartbeatTimeout=A.g,this.reconnectInterval=A.h,this.binaryType=A.i,this.url=A.d+"://"+A.e+":"+A.f+"/wss/",this.initHandlerList(),this.connect(!0)}return v()(e,[{key:"connect",value:function(e){this.ws=new WebSocket(this.url),console.log("current url "+this.url+" status "+this.ws.readyState),this.ws.binaryType=this.binaryType;var t=this;this.ws.onopen=function(e){console.log("ws open"),t.isconnected=!0,t.lastInteractionTime((new Date).getTime()),t.pingIntervalId=setInterval(function(){t.ping()},t.heartbeatTimeout),t.userDisconnect=!1,t.sendConnectMessage()},this.ws.onmessage=function(e){console.log("ws onmessage["+e.data+"]"),t.processMessage(e.data),t.lastInteractionTime((new Date).getTime())},this.ws.onclose=function(e){t.isconnected=!1,console.log("ws onclose"),t.ws.close(),clearInterval(t.pingIntervalId),t.userDisconnect||(console.log("reconnect websocket"),t.reconnect(e))},this.ws.onerror=function(e){console.log("connect error")}}},{key:"reconnect",value:function(e){var t=this;setTimeout(function(){t.connect(!0)},this.reconnectInterval)}},{key:"lastInteractionTime",value:function(e){this.actionTime=e}},{key:"getLastActionTime",value:function(){return this.actionTime}},{key:"ping",value:function(){this.send("心跳内容")}},{key:"send",value:function(e){console.log("send message "+e),this.isconnected?this.ws.send(e):console.log("curent websocket is close")}},{key:"sendAction",value:function(e,t){D.a.dispatch(e,t)}},{key:"initHandlerList",value:function(){this.handlerList.push(new C.a(this)),this.handlerList.push(new k.a(this)),this.handlerList.push(new w.a(this)),this.handlerList.push(new I.a(this)),this.handlerList.push(new b.a(this)),this.handlerList.push(new S.a(this)),this.handlerList.push(new M.a(this)),this.handlerList.push(new T.a(this)),this.handlerList.push(new N.a(this)),this.handlerList.push(new P.a(this)),this.handlerList.push(new E.a(this)),this.handlerList.push(new O.a(this)),this.handlerList.push(new F.a(this)),this.handlerList.push(new G.a(this)),this.handlerList.push(new R.a(this)),this.handlerList.push(new U.a(this)),this.handlerList.push(new B.a(this)),this.handlerList.push(new z.a(this)),this.handlerList.push(new J.a(this)),this.handlerList.push(new Y.a(this)),this.handlerList.push(new K.a(this)),this.handlerList.push(new Q.a(this)),this.handlerList.push(new X.a(this))}},{key:"processMessage",value:function(e){for(var t=JSON.parse(e),n=0;n<this.handlerList.length;n++)this.handlerList[n].match(t)&&this.handlerList[n].processMessage(t)}},{key:"sendConnectMessage",value:function(){console.log("userToken "+localStorage.getItem("vue-token"));var e=n.i(y.a)(localStorage.getItem("vue-token"));console.log("decryptToken "+e);var t=e.substring(0,e.indexOf("|"));e=e.substring(e.indexOf("|")+1);var i=e.substring(0,e.indexOf("|"));console.log("[pwd]->"+t+" [secret]->"+i);var s=n.i(y.b)(t,i);console.log("encrypt pwd: "+s);var a=new _.a;a.setSignal(m.j);var o={userName:x.a.getUserId(),password:s,clientIdentifier:localStorage.getItem(m.k)};a.content=o,console.log(a.toJson()),this.send(a.toJson())}},{key:"sendDisConnectMessage",value:function(){var e=new _.a;e.setSignal(m.l);var t={clearSession:1};e.content=t,console.log(e.toJson()),this.send(e.toJson()),this.userDisconnect=!0}},{key:"getFriend",value:function(){this.sendPublishMessage(m.m,{version:0})}},{key:"searchUser",value:function(e){var t={keyword:e,fuzzy:1,page:0};this.sendPublishMessage(m.n,t)}},{key:"sendFriendAddRequest",value:function(e){this.sendPublishMessage(m.o,e)}},{key:"getFriendRequest",value:function(e){this.sendPublishMessage(m.p,{version:e})}},{key:"handleFriendRequest",value:function(e){this.sendPublishMessage(m.q,e)}},{key:"getUserInfos",value:function(e){this.sendPublishMessage(m.r,e)}},{key:"getUserInfo",value:function(){function e(e){return t.apply(this,arguments)}var t=u()(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sendPublishMessage(m.r,[t]);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e,this)}));return e}()},{key:"modifyMyInfo",value:function(e){this.sendPublishMessage(m.s,e)}},{key:"getGroupInfo",value:function(e,t){var n=[];n.push(e),this.sendPublishMessage(m.t,n)}},{key:"getGroupMember",value:function(){function e(e,n){return t.apply(this,arguments)}var t=u()(c.a.mark(function e(t,n){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sendPublishMessage(m.u,{groupId:t,version:0});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return e}()},{key:"addMembers",value:function(){function e(e,n){return t.apply(this,arguments)}var t=u()(c.a.mark(function e(t,n){var i,s,a,r,l,u,d,f;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(i=[],s=!0,a=!1,r=void 0,e.prev=4,l=o()(n);!(s=(u=l.next()).done);s=!0)d=u.value,f=new j.a,f.memberId=d,f.type=V.a.Normal,i.push(f);e.next=12;break;case 8:e.prev=8,e.t0=e.catch(4),a=!0,r=e.t0;case 12:e.prev=12,e.prev=13,!s&&l.return&&l.return();case 15:if(e.prev=15,!a){e.next=18;break}throw r;case 18:return e.finish(15);case 19:return e.finish(12);case 20:return e.next=22,this.sendPublishMessage(m.v,{groupId:t,groupMembers:i});case 22:return e.abrupt("return",e.sent);case 23:case"end":return e.stop()}},e,this,[[4,8,12,20],[13,,15,19]])}));return e}()},{key:"kickeMembers",value:function(){function e(e,n){return t.apply(this,arguments)}var t=u()(c.a.mark(function e(t,n){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sendPublishMessage(m.w,{groupId:t,memberIds:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return e}()},{key:"createGroup",value:function(){function e(e,n){return t.apply(this,arguments)}var t=u()(c.a.mark(function e(t,n){var i,s,a,r,l,u,d,f,h;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(i=new $.a,i.name=t,i.type=q.a.Normal,s=[],a=!0,r=!1,l=void 0,e.prev=7,u=o()(n);!(a=(d=u.next()).done);a=!0)f=d.value,h=new j.a,h.memberId=f,h.type=f==x.a.getUserId()?V.a.Owner:V.a.Normal,s.push(h);e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),r=!0,l=e.t0;case 15:e.prev=15,e.prev=16,!a&&u.return&&u.return();case 18:if(e.prev=18,!r){e.next=21;break}throw l;case 21:return e.finish(18);case 22:return e.finish(15);case 23:return e.next=25,this.sendPublishMessage(m.x,{groupInfo:i,groupMembers:s});case 25:return e.abrupt("return",e.sent);case 26:case"end":return e.stop()}},e,this,[[7,11,15,23],[16,,18,22]])}));return e}()},{key:"modifyGroupInfo",value:function(){function e(e){return t.apply(this,arguments)}var t=u()(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sendPublishMessage(m.y,t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return e}()},{key:"quitGroup",value:function(){function e(e){return t.apply(this,arguments)}var t=u()(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sendPublishMessage(m.z,{groupId:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return e}()},{key:"dismissGroup",value:function(){function e(e){return t.apply(this,arguments)}var t=u()(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sendPublishMessage(m.A,{groupId:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return e}()},{key:"recallMessage",value:function(){function e(e){return t.apply(this,arguments)}var t=u()(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sendPublishMessage(m.B,{messageUid:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return e}()},{key:"pullMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.sendPublishMessage(m.C,{messageId:e,type:t,pullType:n,sendMessageCount:i})}},{key:"getUploadToken",value:function(e){var t={mediaType:e};this.sendPublishMessage(m.D,t)}},{key:"sendPublishMessage",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=new _.a;i.setSignal(m.E),i.setSubSignal(e),i.setContent(t);var a=x.a.getMessageId();a>65535&&(a=0),i.setMessageId(++a),x.a.saveMessageId(a),this.send(i.toJson());var o=this;return new s.a(function(t){var i=setTimeout(function(){if(e==m.F){var n=new _.a;n.setSignal(m.G),n.setSubSignal(e),n.setMessageId(a),n.setContent(""),o.processMessage(n.toJson())}else t(new W.a(m.H,""))},1e4),s=new L.a(t,i);s.protoMessageId=n,o.resolvePromiseMap.set(a,s)})}},{key:"sendMessage",value:function(e){this.sendPublishMessage(m.F,e,e.messageId)}}]),e}();t.a=Z},function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=function e(){s()(this,e)};a.General=0,a.Image=1,a.Voice=2,a.Video=3,a.File=4,a.Portrait=5,a.Fvaorite=6,t.a=a},function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=n(1),o=n.n(a),r=function(){function e(){s()(this,e),this.groupId="",this.memberId="",this.alias="",this.type=0,this.updateDt=0,this.diplayName="",this.avatarUrl=""}return o()(e,null,[{key:"convert2GroupMember",value:function(t){var n=new e;return n.memberId=t.memberId,n.alias=t.alias,n.type=t.type,n.updateDt=t.updateDt,n}}]),e}();t.a=r},function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=function e(){s()(this,e),this.unread=0,this.unreadMention=0,this.unreadMentionAll=0};t.a=a},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var i=n(2),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(4),u=n.n(l),d=n(17),f=n.n(d),h=n(3),g=n.n(h),p=n(29),v=n(12),m=n(26),y=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return o()(this,t),u()(this,(t.__proto__||s()(t)).call(this,v.a.VOIP_CONTENT_TYPE_ACCEPT,e,n))}return g()(t,e),c()(t,[{key:"digest",value:function(){return""}},{key:"encode",value:function(){var e=f()(t.prototype.__proto__||s()(t.prototype),"encode",this).call(this);e.content=this.callId;var n;return n=this.audioOnly?"1":"0",e.binaryContent=m.a.utf8_to_b64(n),e}},{key:"decode",value:function(e){f()(t.prototype.__proto__||s()(t.prototype),"decode",this).call(this,e),this.callId=e.content;var n=m.a.b64_to_utf8(e.binaryContent);this.audioOnly="1"===n}}]),t}(p.a);t.a=y},function(e,t,n){"use strict";var i=n(2),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(4),u=n.n(l),d=n(17),f=n.n(d),h=n(3),g=n.n(h),p=n(29),v=n(12),m=n(26),y=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return o()(this,t),u()(this,(t.__proto__||s()(t)).call(this,v.a.VOIP_CONTENT_TYPE_ACCEPT_T,e,n))}return g()(t,e),c()(t,[{key:"digest",value:function(){return""}},{key:"encode",value:function(){var e=f()(t.prototype.__proto__||s()(t.prototype),"encode",this).call(this);e.content=this.callId;var n;return n=this.audioOnly?"1":"0",e.binaryContent=m.a.utf8_to_b64(n),e}},{key:"decode",value:function(e){f()(t.prototype.__proto__||s()(t.prototype),"decode",this).call(this,e),this.callId=e.content;var n=m.a.b64_to_utf8(e.binaryContent);this.audioOnly="1"===n}}]),t}(p.a);t.a=y},function(e,t,n){"use strict";var i=n(2),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(4),u=n.n(l),d=n(17),f=n.n(d),h=n(3),g=n.n(h),p=n(29),v=n(12),m=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return o()(this,t),u()(this,(t.__proto__||s()(t)).call(this,v.a.VOIP_CONTENT_TYPE_END,e,n))}return g()(t,e),c()(t,[{key:"digest",value:function(){return""}},{key:"encode",value:function(){var e=f()(t.prototype.__proto__||s()(t.prototype),"encode",this).call(this);return e.content=this.callId,e}},{key:"decode",value:function(e){f()(t.prototype.__proto__||s()(t.prototype),"decode",this).call(this,e),this.callId=e.content}}]),t}(p.a);t.a=m},function(e,t,n){"use strict";var i=n(2),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(4),u=n.n(l),d=n(17),f=n.n(d),h=n(3),g=n.n(h),p=n(29),v=n(12),m=n(26),y=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return o()(this,t),u()(this,(t.__proto__||s()(t)).call(this,v.a.VOIP_CONTENT_TYPE_SIGNAL,e,n))}return g()(t,e),c()(t,[{key:"digest",value:function(){return""}},{key:"encode",value:function(){var e=f()(t.prototype.__proto__||s()(t.prototype),"encode",this).call(this);return e.content=this.callId,e.binaryContent=m.a.utf8_to_b64(this.payload),e}},{key:"decode",value:function(e){f()(t.prototype.__proto__||s()(t.prototype),"decode",this).call(this,e),this.callId=e.content,this.payload=m.a.b64_to_utf8(e.binaryContent)}}]),t}(p.a);t.a=y},function(e,t,n){"use strict";var i=n(14),s=n.n(i),a=n(2),o=n.n(a),r=n(0),c=n.n(r),l=n(1),u=n.n(l),d=n(4),f=n.n(d),h=n(17),g=n.n(h),p=n(3),v=n.n(p),m=n(29),y=n(12),_=n(26),C=function(e){function t(e,n,i){c()(this,t);var s=f()(this,(t.__proto__||o()(t)).call(this,y.a.VOIP_CONTENT_TYPE_START));return s.callId=e,s.targetId=n,s.audioOnly=i,s}return v()(t,e),u()(t,[{key:"digest",value:function(){return this.audioOnly?"[语音通话]":"[视频通话]"}},{key:"encode",value:function(){var e=g()(t.prototype.__proto__||o()(t.prototype),"encode",this).call(this);e.content=this.callId;var n={c:this.connectTime,e:this.endTime,s:this.status,a:this.audioOnly?1:0,t:this.targetId};return e.binaryContent=_.a.utf8_to_b64(s()(n)),e}},{key:"decode",value:function(e){g()(t.prototype.__proto__||o()(t.prototype),"decode",this).call(this,e),this.callId=e.content;var n=_.a.b64_to_utf8(e.binaryContent),i=JSON.parse(n);this.connectTime=i.c,this.endTime=i.e,this.status=i.s,this.audioOnly=1===i.a,this.targetId=i.t}}]),t}(m.a);t.a=C},function(e,t,n){"use strict";var i=n(2),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(4),u=n.n(l),d=n(17),f=n.n(d),h=n(3),g=n.n(h),p=n(298),v=n(85),m=n(12),y=function(e){function t(e,n,i){o()(this,t);var a=u()(this,(t.__proto__||s()(t)).call(this,m.a.Image,v.a.Image,e,n));return a.thumbnail=i,a}return g()(t,e),c()(t,[{key:"digest",value:function(){return"[图片]"}},{key:"encode",value:function(){var e=f()(t.prototype.__proto__||s()(t.prototype),"encode",this).call(this);return e.mediaType=v.a.Image,e.binaryContent=this.thumbnail,e}},{key:"decode",value:function(e){f()(t.prototype.__proto__||s()(t.prototype),"decode",this).call(this,e),this.thumbnail=e.binaryContent}}]),t}(p.a);t.a=y},function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=n(1),o=n.n(a),r=n(310),c=n(66),l=function(){function e(){s()(this,e),this.conversation={},this.from="",this.content={},this.messageId=0,this.direction=0,this.status=0,this.messageUid=0,this.timestamp=0,this.to=""}return o()(e,null,[{key:"toMessage",value:function(t,n){var i=new e,s=n.target;s||(s=t.selectTarget),console.log("to message target "+s);var a=t.conversations.find(function(e){return e.conversationInfo.target===s});return console.log("conversationtype "+a.conversationInfo.conversationType+" target "+a.conversationInfo.target),i.conversation=new r.a(a.conversationInfo.conversationType,a.conversationInfo.target,a.conversationInfo.line),i.content=n.messageContent,i.from=t.userId,i.status=c.a.Sending,i.timestamp=(new Date).getTime(),i.direction=0,i.messageId=(new Date).getTime(),i}}]),e}();t.a=l},function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=function e(){s()(this,e),this.mentionedType=0,this.mentionedTargets=[]};t.a=a},function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=function e(){s()(this,e)};a.No_Persist=0,a.Persist=1,a.Persist_And_Count=3,a.Transparent=4,t.a=a},function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=n(1),o=n.n(a),r=n(66),c=n(68),l=n(143),u=n(10),d=function(){function e(){s()(this,e),this.from="",this.content={},this.messageId=0,this.direction=0,this.status=0,this.messageUid=0,this.timestamp=0,this.to=""}return o()(e,null,[{key:"toProtoMessage",value:function(t){var n=u.a.getUserId(),i=new e;return t.from==n?(i.direction=0,i.status=r.a.Sent):(i.direction=1,i.status=r.a.Unread),i.messageId=t.messageId,i.messageUid=t.messageId,i.timestamp=t.timestamp,i.conversationType=t.conversationType,i.target=t.target,i.from=t.from,i.conversationType==c.a.Single&&(t.from!=n?(i.target=t.from,i.from=t.from):(i.target=t.target,i.from=t.from)),i.line=t.line,i.content=l.a.toProtoMessageContent(t.content),i}},{key:"convertToProtoMessage",value:function(t){var n=new e;n.conversationType=t.conversation.type,n.target=t.conversation.target,n.line=t.conversation.line,n.from=t.from,n.direction=t.direction,n.status=t.status,n.messageId=t.messageId,n.messageUid=t.messageUid,n.timestamp=t.timestamp;var i=t.content.encode();return n.content=l.a.toProtoMessageContent(i),n}}]),e}();t.a=d},function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=n(1),o=n.n(a),r=n(12),c=function(){function e(){s()(this,e),this.mentionedType=0,this.mentionedTargets=[]}return o()(e,null,[{key:"toProtoMessageContent",value:function(t){var n=new e;return n.type=t.type,n.content=t.content,n.searchableContent=t.searchableContent,n.pushContent=t.pushContent,n.binaryContent=t.binaryContent,n.localContent=t.localContent,n.mediaType=t.mediaType,n.remoteMediaUrl=t.remoteMediaUrl,n.localMediaPath=t.localMediaPath,n.mentionedType=t.mentionedType,n.mentionedTargets=t.mentionedTargets,n}},{key:"typeToContent",value:function(e){var t="您有新的消息";switch(e.type){case r.a.Image:t="[图片]";break;case r.a.File:t="[文件]";break;case r.a.Video:t="[视频]";break;case r.a.VOIP_CONTENT_TYPE_START:t="[网络电话]";break;case r.a.Tip_Notification:t="[通知消息]"}return t}}]),e}();t.a=c},function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=function e(t,n){s()(this,e),this.target=t,this.messageContent=n};t.a=a},function(e,t,n){"use strict";var i=n(2),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(4),u=n.n(l),d=n(17),f=n.n(d),h=n(3),g=n.n(h),p=n(29),v=(n(140),n(12)),m=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];o()(this,t);var a=u()(this,(t.__proto__||s()(t)).call(this,v.a.Text,n,i));return a.content=e,a}return g()(t,e),c()(t,[{key:"digest",value:function(){return this.content}},{key:"encode",value:function(){var e=f()(t.prototype.__proto__||s()(t.prototype),"encode",this).call(this);return e.searchableContent=this.content,e}},{key:"decode",value:function(e){f()(t.prototype.__proto__||s()(t.prototype),"decode",this).call(this,e),this.content=e.searchableContent}}]),t}(p.a);t.a=m},function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=n(1),o=n.n(a),r=n(147),c=function(){function e(){s()(this,e),this.target="",this.name="",this.portrait="",this.owner="",this.type=r.a.Normal,this.memberCount=0,this.extra="",this.updateDt=0}return o()(e,null,[{key:"convert2GroupInfo",value:function(t){var n=new e;return n.target=t.target,n.name=t.name,n.portrait=t.portrait,n.owner=t.owner,n.type=t.type,n.memberCount=t.memberCount,n.extra=t.extra,n.updateDt=t.updateDt,n}}]),e}();t.a=c},function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=function e(){s()(this,e)};a.Normal=0,a.Free=1,a.Restricted=2,t.a=a},function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=n(87),o=function e(){s()(this,e),this.lastMessage={},this.timestamp=0,this.draft="",this.unreadCount=new a.a,this.isTop=!1,this.isSilent=!1};t.a=o},function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=function e(){s()(this,e),this.name="",this.protoMessages=[]};t.a=a},function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=n(1),o=n.n(a),r=function(){function e(){s()(this,e),this.uid="",this.name="",this.displayName="",this.gender=0,this.portrait="",this.mobile="",this.email="",this.address="",this.social="",this.extra="",this.type=0,this.updateDt=1550652404513}return o()(e,null,[{key:"convert2UserInfo",value:function(t){var n=new e;return n.uid=t.uid,n.name=t.name,n.displayName=t.displayName,n.gender=t.gender,n.portrait=t.portrait,n.mobile=t.mobile,n.email=t.email,n.address=t.address,n.social=t.social,n.extra=t.extra,n.type=t.type,n.updateDt=t.updateDt,n}}]),e}();t.a=r},function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=n(1),o=n.n(a),r=function(){function e(){s()(this,e)}return o()(e,null,[{key:"_formatDate",value:function(e,t){var n={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var i in n)new RegExp("("+i+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?n[i]:("00"+n[i]).substr((""+n[i]).length)));return t}},{key:"getTimeStringAutoShort2",value:function(e,t){var n=new Date,i=new Date(parseInt(e)),s=n.getFullYear(),a=n.getMonth()+1,o=n.getDate(),r=i.getFullYear(),c=i.getMonth()+1,l=i.getDate(),u="",d=t?" "+this._formatDate(i,"hh:mm"):"";if(s==r){var f=n.getTime(),h=e,g=f-h;if(a==c&&o==l)u=g<6e4?"刚刚":this._formatDate(i,"hh:mm");else{var p=new Date;p.setDate(p.getDate()-1);var v=new Date;if(v.setDate(v.getDate()-2),c==p.getMonth()+1&&l==p.getDate())u="昨天"+d;else if(c==v.getMonth()+1&&l==v.getDate())u="前天"+d;else{var m=g/36e5;if(m<=168){var y=new Array(7);y[0]="星期日",y[1]="星期一",y[2]="星期二",y[3]="星期三",y[4]="星期四",y[5]="星期五",y[6]="星期六";var _=y[i.getDay()];u=_+d}else u=this._formatDate(i,"yy/M/d")+d}}}else u=this._formatDate(i,"yy/M/d")+d;return u}}]),e}();t.a=r},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){n(426);var i=n(11)(n(243),n(483),"data-v-0fadc32a",null);e.exports=i.exports},function(e,t,n){"use strict";var i=n(64),s=(n(65),["/login"]);i.a.beforeEach(function(e,t,n){var i=localStorage.getItem("vue-token");console.log("match route token "+i+" to "+e.path+" from "+t.path+" next "+n.path);var a=window.location.hash;i&&!a.startsWith("#/login")?"/login"===e.path?n({path:"/conversation"}):n():-1!==s.indexOf(e.path)?n():(window.localStorage.clear(),n("/login"))})},,function(e,t){},function(e,t,n){n(438);var i=n(11)(n(233),n(496),"data-v-78387bbd",null);e.exports=i.exports},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(505),s=n.n(i);t.default={name:"VueXgplayer",data:function(){return{player:null}},props:{config:{type:Object,default:function(){return{id:"mse",url:""}}},rootStyle:{type:Object,default:function(){return{}}}},methods:{init:function(){this.config.url&&""!==this.config.url&&(this.player=new s.a(this.config),this.$emit("player",this.player))}},mounted:function(){this.init()},beforeUpdate:function(){this.init()},beforeDestroy:function(){this.player&&"function"==typeof this.player.destroy&&this.player.destroy()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(n(21),n(479)),s=n.n(i),a=n(480),o=n.n(a);t.default={name:"AppChat",components:{searchfriend:s.a,creategroup:o.a}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(23),s=n.n(i),a=n(21),o=n(68),r=n(10),c=n(151),l=n(52),u=n(53);n(13);t.default={data:function(){return{loading:!0}},computed:s()({},n.i(a.a)(["selectId","selectTarget","searchText","appHeight","userInfoList","emptyMessage"]),n.i(a.b)(["searchedConversationList"]),{isEmptyConversation:function(){return 0==this.searchedConversationList.length&&!this.emptyMessage}}),methods:s()({},n.i(a.d)(["selectSession","selectConversation"]),{processageGroupMessage:function(e){var t,n=e.conversationInfo;if(n.lastMessage){var i=l.a.convert2MessageContent(n.lastMessage.from,n.lastMessage.content);if(i&&i instanceof u.a)t=i.formatNotification();else{t=n.lastMessage.content.searchableContent,400===n.lastMessage.content.type&&(t="[网络电话]");var s=n.lastMessage.from===r.a.getUserId();if(n.conversationType==o.a.Group&&!s){var a=n.lastMessage.from,c=this.userInfoList.find(function(e){return e.uid==a}),d=a;c&&((d=c.displayName)||(d=c.mobile)),t=d+":"+n.lastMessage.content.searchableContent}}}return t},getDisplayName:function(e){var t=this.userInfoList.find(function(t){return t.uid==e}),n=e;return t&&((n=t.displayName)||(n=t.mobile)),n}}),filters:{time:function(e){return"string"==typeof e&&(e=new Date(e)),"number"==typeof e&&(e=new Date(e)),e.getMinutes()<10?e.getHours()+":0"+e.getMinutes():e.getHours()+":"+e.getMinutes()},getTimeStringAutoShort2:function(e){return c.a.getTimeStringAutoShort2(e,!1)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(23),s=n.n(i),a=n(21);t.default={computed:s()({},n.i(a.a)(["selectFriendId","searchText","appHeight","newFriendRequestCount"]),n.i(a.b)(["searchedFriendlist"])),methods:s()({},n.i(a.d)(["selectFriend"]))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(23),s=n.n(i),a=(n(64),n(21));n(10);t.default={computed:s()({},n.i(a.b)(["selectedFriend"]),n.i(a.a)(["friendRequests","appHeight","userInfoList"])),methods:{send:function(){this.$store.dispatch("send"),this.$store.dispatch("search","")},requestBtnMessage:function(e){return 1===e.status?"已添加":2===e.status?"已拒绝":0===e.status?"接受":void 0},handleFriendRequest:function(e){this.$store.dispatch("handleFriendRequest",{targetUid:e.from,status:1})},friendName:function(e){var t=this.userInfoList.find(function(t){return t.uid==e}),n=e;return t&&((n=t.displayName)||(n=t.mobile)),n},friendPortrait:function(e){var t,n=this.userInfoList.find(function(t){return t.uid==e});return n&&(t=n.portrait),t||(t="static/images/vue.jpg"),t}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(13);t.default={name:"addtip",methods:{showSearchFriendDialog:function(){this.$store.state.showSearchFriendDialog=!0},showCreateGroupDialog:function(){i.a.log("show create group dialog"),this.$store.state.groupOperateState=0,this.$store.state.showCreateGroupDialog=!0}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(28),s=n.n(i),a=n(23),o=n.n(a),r=n(21),c=n(10),l=n(27),u=n(5),d=n(86),f=n(299);n(13);t.default={name:"groupInfoMenu",props:["targetId"],data:function(){return{isGroupOwner:!1,groupMembers:[],addGroupMemberType:1e3,deleteGroupMemberType:1001,addGroupMemberSingleType:1002}},mounted:function(){var e=this;console.log("targetId "+this.targetId),document.addEventListener("click",function(t){var n="string"==typeof t.target.className,i=document.getElementById("group-info-id");n&&-1==t.target.className.search("show-group-info")&&i&&!i.contains(t.target)&&e.$store.state.showGroupInfo&&(e.$store.state.showGroupInfo=!1)})},destroyed:function(){this.groupMembers=[]},computed:o()({},n.i(r.a)(["appHeight","groupInfoList","userInfoList","groupMemberMap"]),n.i(r.b)(["isSingleConversation"]),{memberList:function(){var e=[];if(this.isSingleConversation){var t=new d.a;t.type=this.addGroupMemberSingleType,t.displayName="添加成员",e.push(t);var n=new d.a;n.displayName=l.a.getDisplayName(c.a.getUserId()),n.avatarUrl=l.a.getPortrait(c.a.getUserId()),n.memberId=c.a.getUserId(),e.push(n);var i=new d.a;i.displayName=l.a.getDisplayName(this.targetId),i.avatarUrl=l.a.getPortrait(this.targetId),i.memberId=this.targetId,e.push(i)}else{var t=new d.a;t.type=this.addGroupMemberType,t.displayName="添加成员",e.push(t);var a=new d.a;if(a.type=this.deleteGroupMemberType,a.displayName="移除成员",e.push(a),this.groupMemberMap.get(this.targetId)){var o=!0,r=!1,u=void 0;try{for(var f,h=s()(this.groupMemberMap.get(this.targetId));!(o=(f=h.next()).done);o=!0){var g=f.value;g.memberId==c.a.getUserId()&&(this.isGroupOwner=2==g.type),g.displayName=l.a.getDisplayName(g.memberId),g.avatarUrl=l.a.getPortrait(g.memberId),e.push(g)}}catch(e){r=!0,u=e}finally{try{!o&&h.return&&h.return()}finally{if(r)throw u}}}this.isGroupOwner||e.splice(1,1)}return e},groupName:{get:function(){var e=this,t="",n=this.groupInfoList.find(function(t){return t.target==e.targetId});return n&&(t=n.name),t},set:function(e){var t=this,n=this.groupInfoList.find(function(e){return e.target==t.targetId});n&&(n.name=e)}}}),methods:{quitGroup:function(){var e=this;this.$confirm("你将退出此群组, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){l.a.quitGroup(e.targetId).then(function(t){t.code==u.a&&(e.$message({type:"success",message:"退出群组成功!"}),e.$store.state.showGroupInfo=!1,setTimeout(function(){return e.$store.dispatch("deleteConversation",e.targetId)},500))})}).catch(function(){e.$message({type:"info",message:"已取消退出群组"})})},dismissGroup:function(){var e=this;this.$confirm("此操作将永久解散群组, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){l.a.dismissGroup(e.targetId).then(function(t){t.code==u.a&&(e.$message({type:"success",message:"解散群组成功!"}),e.$store.state.showGroupInfo=!1,setTimeout(function(){return e.$store.dispatch("deleteConversation",e.targetId)},500))})}).catch(function(){e.$message({type:"info",message:"已取消解散群组"})})},addGroupMemberFromSingle:function(){this.$store.state.groupOperateState=3,this.$store.state.groupMemberTracker+=1,this.$store.state.showCreateGroupDialog=!0},addGroupMember:function(){this.$store.state.groupOperateState=1,this.$store.state.groupMemberTracker+=1,this.$store.state.showCreateGroupDialog=!0},kickGroupMember:function(){this.$store.state.groupOperateState=2,this.$store.state.groupMemberTracker+=1,this.$store.state.showCreateGroupDialog=!0},modifyGroupNameBlur:function(e){var t=e.target.innerText;this.groupName!==t&&(this.groupName=t,this.groupName&&this.groupName.length<15?l.a.modifyGroupInfo({groupId:this.targetId,type:f.a.Modify_Group_Name,value:this.groupName}):this.$message.error("群组名称过长最好不要超过15个字符"))},modifyGroupName:function(e){13==e.keyCode&&(this.modifyGroupNameBlur(e),e.preventDefault())}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(23),s=n.n(i),a=n(13),o=n(300),r=n(85),c=n(10),l=n(183),u=(n.n(l),n(21));t.default={name:"persionCard",props:["userId"],data:function(){return{extra:"备注无",address:""}},methods:{modifyNickName:function(e){13==e.keyCode&&(this.modifyNickNameBlur(e),e.preventDefault())},modifyNickNameBlur:function(e){a.a.log("modify displayName "+e.target.innerText);var t=e.target.innerText;this.displayName=t,t.length<10&&this.$store.dispatch("modifyMyInfo",{type:o.a.Modify_DisplayName,value:t})},modifyExtra:function(e){13==e.keyCode&&e.preventDefault()},openfile:function(){this.$refs.changeAvatar.click()},changeAvatar:function(e){var t=this,n=this.$store;n.dispatch("getUploadToken",r.a.Image),console.log("changeAvatar "+e.target.value);var i=e.target.files[0],s=r.a.Image+"-"+c.a.getUserId()+"-"+(new Date).getTime()+"-"+i.name;setTimeout(function(){var a=c.a.getImageUploadToken();if(console.log("upload avatar key "+s+" token "+a),a){var r=l.upload(i,s,a,null,null),u={next:function(e){console.log("uploading "+e.total.percent)},error:function(e){console.log("upload error "+e.code+" message "+e.message)},complete:function(i){console.log("upload complete "+i);var a=(e.target.value,"http://image.comsince.cn/"+s);t.$store.state.user.img=a,n.dispatch("modifyMyInfo",{type:o.a.Modify_Portrait,value:a})}};r.subscribe(u)}},200),this.$refs.changeAvatar.value=null}},computed:s()({},n.i(u.a)(["user","userInfoList"]),{personImg:{get:function(){var e=this,t=this.userInfoList.find(function(t){return t.uid==e.userId}),n="";return t&&(n=t.portrait),""===n&&(n="static/images/vue.jpg"),n},set:function(e){var t=this,n=this.userInfoList.find(function(e){return e.uid==t.userId});n&&(n.portrait=e)}},displayName:{get:function(){var e=this,t=this.userInfoList.find(function(t){return t.uid==e.userId}),n="";return t&&(n=""==t.displayName?t.mobile:t.displayName),n},set:function(e){var t=this,n=this.userInfoList.find(function(e){return e.uid==t.userId});n&&(n.displayName=e)}},mobile:function(){var e=this,t=this.userInfoList.find(function(t){return t.uid==e.userId});return t?t.mobile:""}})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(23),s=n.n(i),a=n(21),o=n(27),r=n(5),c=n(67),l=n(10);t.default={name:"rightmenu",props:["message"],computed:s()({},n.i(a.a)(["showMessageRightMenu"])),methods:{recallMessage:function(){var e=this;o.a.recallMessage(this.message.messageUid).then(function(t){if(t.code==r.a){var n=new c.a(l.a.getUserId(),e.message.messageUid);e.message.content=n.encode(),console.log("recall message "+e.message.messageId)}}),this.noShowMenu()},deleteMessage:function(){this.noShowMenu()},noShowMenu:function(){var e=this,t=this.showMessageRightMenu.find(function(t){return t.messageId==e.message.messageId});t&&(t.show=!1)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(28),s=n.n(i),a=n(23),o=n.n(a),r=n(21),c=n(151),l=n(466),u=n.n(l),d=n(425),f=(n.n(d),n(464)),h=n.n(f),g=n(16),p=n(171),v=(n.n(p),n(471)),m=n.n(v),y=n(473),_=n.n(y),C=n(52),k=(n(53),n(40)),w=n(66),I=n(67),b=n(27),S=n(5),M=n(10);g.default.use(h.a),t.default={components:{Xgplayer:u.a,groupInfo:m.a,rightMenu:_.a},data:function(){return{Player:null}},computed:o()({},n.i(r.b)(["selectedChat","messages","isSingleConversation"]),n.i(r.a)(["user","emojis","appHeight","userInfoList","showGroupInfo","showMessageRightMenu","groupMemberMap"]),{showGroupInfo:{get:function(){return this.$store.state.showGroupInfo},set:function(e){this.$store.state.showGroupInfo=e}}}),mounted:function(){var e=this;setTimeout(function(){return e.$refs.list.scrollTop=e.$refs.list.scrollHeight},0)},watch:{messages:function(){var e=this;setTimeout(function(){return e.$refs.list.scrollTop=e.$refs.list.scrollHeight},0)}},methods:{changeShowGroupInfo:function(){var e=this;if(this.showGroupInfo)return void(this.showGroupInfo=!1);b.a.getGroupMember(this.selectedChat.target).then(function(t){var n=!1;if(t.code==S.a)if(0==t.result.length)e.$message.error("该群组已经解散,即将删除该会话"),e.$store.dispatch("deleteConversation",e.selectedChat.target);else{e.groupMemberMap.set(e.selectedChat.target,t.result);var i=!0,a=!1,o=void 0;try{for(var r,c=s()(t.result);!(i=(r=c.next()).done);i=!0){var l=r.value;if(l.memberId==M.a.getUserId()){n=!0;break}}}catch(e){a=!0,o=e}finally{try{!i&&c.return&&c.return()}finally{if(a)throw o}}n?(e.showGroupInfo=!e.showGroupInfo,e.showGroupInfo&&e.$store.dispatch("getGroupInfo",e.selectedChat.target)):(e.$message.error("您不是群组成员，无法查看群组信息,即将删除该会话"),e.$store.dispatch("deleteConversation",e.selectedChat.target))}})},changeShowCreateGroup:function(){this.showGroupInfo=!this.showGroupInfo},avatarSrc:function(e){var t="static/images/vue.jpg";if(0==e.direction)t=this.user.img;else{var n=this.userInfoList.find(function(t){return t.uid==e.from});n&&(t=n.portrait)}return t},showUserName:function(e){var t=e,n=this.userInfoList.find(function(t){return t.uid==e});return n&&(t=n.displayName?n.displayName:n.mobile),t},replaceFace:function(e){if(e.includes("/:")){for(var t=this.emojis,n=0;n<t.length;n++)e=e.replace(t[n].reg,'<img src="static/emoji/'+t[n].file+'"  alt="" style="vertical-align: middle; width: 24px; height: 24px" />');return e}return e},isfaceMessage:function(e){return e.includes("/:")},isShowTime:function(e,t){var n=t[e].timestamp;if(e>0){if(n-t[e-1].timestamp>3e5)return!0}return!1},videoConfig:function(e){return{id:"vs"+e,url:e,height:330,width:250,autoplay:arguments.length>1&&void 0!==arguments[1]&&arguments[1],download:!0}},scrollEvent:function(e){var t=this.$refs.list.offsetHeight;e.srcElement.scrollHeight-e.srcElement.scrollTop>t&&this.$store.dispatch("clearUnreadStatus","")},messageBoxClick:function(e){this.$store.dispatch("clearUnreadStatus",""),console.log("message box click")},isGroupNotification:function(e){return new(C.a.getMessageContentClazz(e.content.type))instanceof k.a},isRecallNotification:function(e){return new(C.a.getMessageContentClazz(e.content.type))instanceof I.a},notificationContent:function(e){return C.a.convert2MessageContent(e.from,e.content).formatNotification()},isNotification:function(e){return e>=80&&e<=117},isSending:function(e){return e.status==w.a.Sending},isSendFail:function(e){return e.status==w.a.SendFailure},messageRigthClick:function(e){var t=this.showMessageRightMenu.find(function(t){return t.messageId==e});t?t.show=!0:this.showMessageRightMenu.push({messageId:e,show:!0})},isShowMessageMenu:function(e){if(0==e.direction){var t=this.showMessageRightMenu.find(function(t){return t.messageId==e.messageId});return!!t&&t.show}return!1}},filters:{time:function(e){return"string"==typeof e&&(e=new Date(e)),"number"==typeof e&&(e=new Date(e)),e.getMinutes()<10?e.getHours()+":0"+e.getMinutes():e.getHours()+":"+e.getMinutes()},getTimeStringAutoShort2:function(e){return c.a.getTimeStringAutoShort2(e,!0)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(23),s=n.n(i),a=n(21),o=n(470),r=n.n(o),c=n(472),l=n.n(c);n(27),n(13);t.default={components:{addtip:r.a,personcard:l.a},data:function(){return{showAddRequestTip:!1,showPersonalCard:!1}},computed:s()({},n.i(a.a)(["user","userId","newFriendRequestCount"]),n.i(a.b)(["unreadTotalCount"])),methods:{showPersonCard:function(){this.showPersonalCard=!this.showPersonalCard},clearSearch:function(){this.$store.dispatch("search","")},loginOut:function(){this.$store.dispatch("loginOut","")},changeFullScreenMode:function(){var e=this.$store.state.changeFullScreenMode;console.log("change screen mode "+e);var t=this;t.$store.state.changeFullScreenMode=!e,setTimeout(function(){var e=t.$refs.mycardRef.offsetHeight;console.log("resize mycard height "+e),t.$store.state.appHeight=e},200)}},mounted:function(){var e=this;document.addEventListener("click",function(t){var n="string"==typeof t.target.className;n&&-1==t.target.className.search("icon-jiahaoyou")&&"add-content"!==t.target.className&&e.showAddRequestTip&&(e.showAddRequestTip=!1);var i=document.getElementById("personal-card");n&&-1==t.target.className.search("avatar")&&i&&!i.contains(event.target)&&e.showPersonalCard&&(e.showPersonalCard=!1)})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={methods:{change:function(){this.$store.dispatch("search",this.search)},del:function(){this.search="",this.change()}},data:function(){return{search:"",active:!1}},computed:{noText:function(){return""===this.search},haveText:function(){return""!==this.search}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(23),s=n.n(i),a=(n(251),n(21)),o=n(145),r=n(138),c=n(183),l=(n.n(c),n(85)),u=n(10),d=n(270),f=n(268),h=n(144),g=n(81);t.default={data:function(){return{content:"",sendBtnDisabled:!0,reply:"未找到",frequency:0,warn:!1,showEmoji:!1,videoTextCallTips:"",voipClient:null,rejectCall:!1,cancelCall:!1,acceptCall:!1,hangUpCall:!1,showCallLocalImg:!0,showCallLocalVideo:!1,showCallRemoteImg:!0,showCallRemoteVideo:!1,showCallTips:!0,callRemoteImg:"static/images/vue.jpg",callLocalImg:"static/images/vue.jpg",callDisplayName:"",waitingMsg:!1,isAudioOnly:!1,waitingMsgTips:"",showTalkTime:!1,talkInterval:0,talkTime:"00:00",talkTimerInterval:null}},computed:s()({},n.i(a.a)(["selectId","emojis","showChatBox","showAudioBox","userInfoList"]),n.i(a.b)(["selectedChat","isSingleConversation"])),methods:{sendPic:function(e){var t=this.$store;t.dispatch("getUploadToken",l.a.Image),console.log("sendpic "+e.target.value);var n=e.target.files[0],i=l.a.Image+"-"+u.a.getUserId()+"-"+(new Date).getTime()+"-"+n.name;setTimeout(function(){var s=u.a.getImageUploadToken();if(console.log("upload file key "+i+" token "+s),s){var a=c.upload(n,i,s,null,null),o={next:function(e){console.log("uploading "+e.total.percent)},error:function(e){console.log("upload error "+e.code+" message "+e.message)},complete:function(n){console.log("upload complete "+n);var s=e.target.value,a="http://image.comsince.cn/"+i,o=new r.a(s,a,null);t.dispatch("sendMessage",new h.a(null,o))}};a.subscribe(o)}},200),this.$refs.uploadPic.value=null},sendMessage:function(e){console.log("send code "+e.keyCode),13===e.keyCode&&(this.send(),e.preventDefault())},newline:function(e){this.content=this.content+"\n",e.preventDefault()},onBlur:function(){console.log("send text onblur")},onFocus:function(){console.log("send text onfoucs"),this.$store.dispatch("clearUnreadStatus","")},send:function(){var e=this;if(console.log("send message "+this.content),this.content.length<1)this.warn=!0,this.content="",setTimeout(function(){e.warn=!1},1e3);else{var t=new o.a(this.content);this.sendMessageToStore(new h.a(null,t)),this.content="",this.$refs.text.focus()}},sendAudio:function(){this.$store.state.showAudioBox=!0,this.waitingMsg=!0,this.rejectCall=!1,this.acceptCall=!1,this.hangUpCall=!1,this.cancelCall=!0,this.initCallUserInfo(this.$store.state.selectTarget),this.isAudioOnly=!0,this.voipClient.startCall(this.$store.state.selectTarget,this.isAudioOnly)},sendVideo:function(){this.$store.state.showChatBox=!0,this.rejectCall=!1,this.acceptCall=!1,this.hangUpCall=!1,this.cancelCall=!0,this.showCallRemoteVideo=!1,this.showCallRemoteImg=!0,this.showCallTips=!0,this.videoTextCallTips="正在接通，请稍候...",this.initCallUserInfo(this.$store.state.selectTarget),this.isAudioOnly=!1,this.voipClient.startCall(this.$store.state.selectTarget,this.isAudioOnly)},initCallUserInfo:function(e){var t=this.getUserPortrait(e);t&&(this.callRemoteImg=t),this.callLocalImg=this.$store.state.user.img,this.callDisplayName=this.getDisplayName(e)},getUserPortrait:function(e){var t=this.userInfoList.find(function(t){return t.uid==e});return t?t.portrait:null},getDisplayName:function(e){return this.userInfoList.find(function(t){return t.uid==e}).displayName},hangUp:function(){this.voipClient.cancelCall()},reject:function(){this.voipClient.cancelCall()},accept:function(){this.rejectCall=!1,this.acceptCall=!1,this.hangUpCall=!0,this.voipClient.answerCall(this.isAudioOnly)},cancel:function(){this.voipClient.cancelCall()},sendMessageToStore:function(e){this.$store.dispatch("sendMessage",e)}},mounted:function(){var e=this;this.$refs.text.focus();var t=new d.a,n=new f.a;n.onReceiveCall=function(t){e.isAudioOnly=t.audioOnly,console.log("receive isAudioOnly "+t.audioOnly),e.isAudioOnly?(e.$store.state.showAudioBox=!0,e.waitingMsg=!0,e.waitingMsgTips="对方邀请你进行语音通话",e.rejectCall=!0,e.acceptCall=!0,e.cancelCall=!1,e.hangUpCall=!1,e.initCallUserInfo(t.clientId)):(e.$store.state.showChatBox=!0,e.videoTextCallTips="对方邀请您进行视频通话",e.rejectCall=!0,e.cancelCall=!1,e.acceptCall=!0,e.hangUpCall=!1,e.showCallLocalImg=!0,e.showCallLocalVideo=!1,e.showCallRemoteImg=!0,e.showCallRemoteVideo=!1,e.showCallTips=!0,e.initCallUserInfo(t.clientId));try{document.getElementById("sendText").blur()}catch(e){console.error("get sendText error "+e)}},t.didChangeState=function(t){t===g.a.STATUS_CONNECTED&&(e.isAudioOnly?(e.cancelCall=!1,e.rejectCall=!1,e.acceptCall=!1,e.hangUpCall=!0,e.waitingMsg=!1):(e.cancelCall=!1,e.acceptCall=!1,e.rejectCall=!1,e.hangUpCall=!0),e.showTalkTime=!0,e.talkTimerInterval=setInterval(function(){e.talkInterval+=1;var t=Math.floor(e.talkInterval/60%60),n=Math.floor(e.talkInterval%60);n=n<10?"0"+n:n,t=t<10?"0"+t:t,e.talkTime=t+":"+n},1e3))},t.didReceiveRemoteAudioTrack=function(e){document.getElementById("wxCallRemoteAudio").srcObject=e},t.didCallEndWithReason=function(t){e.isAudioOnly?e.$store.state.showAudioBox=!1:e.$store.state.showChatBox=!1,e.talkTimerInterval&&(e.showTalkTime=!1,e.talkInterval=0,clearInterval(e.talkTimerInterval))},t.didCreateLocalVideoTrack=function(t){e.showCallLocalImg=!1,e.showCallLocalVideo=!0,document.getElementById("wxCallLocalVideo").srcObject=t},t.didReceiveRemoteVideoTrack=function(t){e.showCallRemoteImg=!1,e.showCallTips=!1,e.showCallRemoteVideo=!0,document.getElementById("wxCallRemoteVideo").srcObject=t},this.voipClient=this.$store.state.voipClient,this.voipClient.setCurrentSessionCallback(t),this.voipClient.setCurrentEngineCallback(n)},watch:{selectId:function(){var e=this;setTimeout(function(){e.$refs.text.focus()},0)},content:function(){""===this.content?(this.$refs.sendBtn.style.background="#f5f5f5",this.$refs.sendBtn.style.color="#7c7c7c",this.sendBtnDisabled=!0):(this.$refs.sendBtn.style.background="rgb(18,150,17)",this.$refs.sendBtn.style.color="#fff",this.sendBtnDisabled=!1)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(186),s=n.n(i),a=n(467),o=n.n(a),r=n(474),c=n.n(r),l=n(476),u=n.n(l);n(84),n(5);t.default={components:{search:s.a,chatlist:o.a,message:c.a,vText:u.a},mounted:function(){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(186),s=n.n(i),a=n(468),o=n.n(a),r=n(469),c=n.n(r);t.default={components:{search:s.a,friendlist:o.a,info:c.a}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(23),s=n.n(i),a=n(21);t.default={data:function(){return{friendInput:"",friendRequest:"",currentSearchUser:null,innerVisible:!1}},methods:{changeSearchFriendDialog:function(){this.$store.state.showSearchFriendDialog=!1},searchUser:function(e){console.log("search user "),13===e.keyCode&&""!=this.friendInput&&(this.$store.dispatch("searchUser",this.friendInput),this.friendInput="")},handleClose:function(){this.$store.dispatch("updateSearchUser",[])},sendFriendRequest:function(){this.innerVisible=!1,this.$store.dispatch("sendFriendAddRequest",{reason:this.friendRequest,targetUserId:this.currentSearchUser.uid})},showFriendRequestDialog:function(e){this.innerVisible=!0,this.friendRequest="我是"+this.$store.state.user.name,this.currentSearchUser=e}},computed:s()({},n.i(a.a)(["searchUsers"]),{showSearchFriendDialog:{get:function(){return this.$store.state.showSearchFriendDialog},set:function(e){this.$store.state.showSearchFriendDialog=e}}})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(28),s=n.n(i),a=n(23),o=n.n(a),r=n(21),c=n(13),l=n(27),u=n(10),d=n(5);t.default={name:"creategroup",data:function(){return{friendInput:"",selectedFriends:[],checkFriendTips:"未选择联系人",confirmEnable:!0,selectFriendId:0,fullscreenLoading:!1}},computed:o()({},n.i(r.a)(["appHeight","user","groupOperateState","groupMemberMap","selectTarget","groupMemberTracker"]),n.i(r.b)(["searchedFriendlist"]),{showCreateGroupDialog:{get:function(){return this.$store.state.showCreateGroupDialog},set:function(e){this.$store.state.showCreateGroupDialog=e}},waitCheckedFriendList:function(){var e=this.searchedFriendlist.slice(1,this.searchedFriendlist.length),t=[],n=!0,i=!1,a=void 0;try{for(var o,r=s()(e);!(n=(o=r.next()).done);n=!0){var l=o.value,u=!1,d=!1,f=!1;if(0==this.groupOperateState)f=!0;else if(1==this.groupOperateState){this.groupMemberTracker;f=!0;var h=this.groupMemberMap.get(this.selectTarget).find(function(e){return e.memberId==l.wxid});h&&(u=!0,d=!0)}else if(2==this.groupOperateState){var h=(this.groupMemberTracker,this.groupMemberMap.get(this.selectTarget).find(function(e){return e.memberId==l.wxid}));h&&(u=!1,f=!0)}else if(3==this.groupOperateState){this.groupMemberTracker;f=!0,this.selectTarget==l.wxid&&(u=!0,d=!0)}c.a.log("friend nickname "+l.remark+" ischecked "+u),f&&t.push({id:l.id,wxid:l.wxid,remark:l.remark,img:l.img,initial:l.initial,checked:u,disabled:d})}}catch(e){i=!0,a=e}finally{try{!n&&r.return&&r.return()}finally{if(i)throw a}}return t},groupDialogTitle:function(){return 0==this.groupOperateState?"创建群聊":1==this.groupOperateState?"添加成员":2==this.groupOperateState?"移除成员":void 0}}),methods:{friendChangeChange:function(e){var t=this;if(c.a.log("check change "+e),e&&""!=e){var n=e.split(":");c.a.log("select friendid "+n[0]+" checked "+n[1]);var i=this.waitCheckedFriendList.find(function(e){return e.id==n[0]});if(c.a.log("friend change "+i.checked),1==n[1]){if(i){this.selectFriendId=i.id;var s=this.selectedFriends.find(function(e){return e.id==t.selectFriendId});s||this.selectedFriends.push(i)}}else 0==n[1]&&i&&this.removeCheckedFriend(i.id)}},selectFriend:function(e){this.selectFriendId=e;var t=this.waitCheckedFriendList.find(function(t){return t.id==e});t.disabled||(t.checked=!t.checked,t.checked?this.selectedFriends.push(t):this.removeCheckedFriend(t.id))},cancel:function(){this.exit()},confirm:function(){var e=this;if(this.selectedFriends.length>0){this.fullscreenLoading=!0;var t=this.user.name,n=[];for(var i in this.selectedFriends)i<2&&(t+="、"+this.selectedFriends[i].remark),n.push(this.selectedFriends[i].wxid);switch(this.groupOperateState){case 0:n.push(u.a.getUserId()),l.a.createGroup(t,n).then(function(n){if(c.a.log("create group result "+n),n.code==d.a){JSON.parse(n.result);e.fullscreenLoading=!1,e.exit(),e.$message({type:"success",message:"创建"+t+"群组成功!"})}else e.fullscreenLoading=!1,e.$message({type:"success",message:"创建"+t+"群组失败,请重试!"})});break;case 1:l.a.addMembers(this.selectTarget,n).then(function(t){c.a.log("add member result "+t),t.code==d.a?(e.fullscreenLoading=!1,e.exit()):e.fullscreenLoading=!1});break;case 2:l.a.kickeMembers(this.selectTarget,n).then(function(t){t.code==d.a?(e.fullscreenLoading=!1,e.exit()):e.fullscreenLoading=!1});break;case 3:n.push(u.a.getUserId()),n.push(this.selectTarget),l.a.createGroup(t,n).then(function(t){if(t.code==d.a){JSON.parse(t.result);e.fullscreenLoading=!1,e.exit()}else e.fullscreenLoading=!1})}}},handleClose:function(){this.exit()},delfriend:function(e){this.waitCheckedFriendList.find(function(t){return t.id==e}).checked=!1,this.removeCheckedFriend(e)},removeCheckedFriend:function(e){for(var t=-1,n=0;n<this.selectedFriends.length;n++)if(e==this.selectedFriends[n].id){t=n;break}-1!=t&&this.selectedFriends.splice(t,1),e==this.selectFriendId&&(this.selectFriendId=0)},exit:function(){this.$store.state.showCreateGroupDialog=!1,this.selectedFriends=[];var e=!0,t=!1,n=void 0;try{for(var i,a=s()(this.waitCheckedFriendList);!(e=(i=a.next()).done);e=!0){var o=i.value;o.disabled||(o.checked=!1)}}catch(e){t=!0,n=e}finally{try{!e&&a.return&&a.return()}finally{if(t)throw n}}}},watch:{selectedFriends:function(){0==this.selectedFriends.length&&(this.selectFriendId=0),this.selectedFriends.length>0?0==this.groupOperateState?this.selectedFriends.length>1?this.confirmEnable=!1:this.confirmEnable=!0:this.confirmEnable=!1:this.confirmEnable=!0,0==this.selectedFriends.length?this.checkFriendTips="未选择联系人":this.checkFriendTips="已选择"+this.selectedFriends.length+"位联系人"}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(14),s=n.n(i),a=n(5),o=(n(21),n(463)),r=n.n(o),c=n(444),l=n.n(c),u=n(215),d=n.n(u);t.default={name:"Login",data:function(){return{mobile:"",code:"TmpZMk5qWT0=",countDownTimer:null,sendVerifyBtnText:"发送验证码",sendVerifyBtnDisabled:!1,loginAPI:a.N}},created:function(){var e=this;window.localStorage.clear();var t=this.querystring("username"),n=(this.querystring("token"),this.querystring("hashtoken")),i=this.querystring("hashkey"),s=dayjs().format("YYYY-MM-DD");l()(i+s+t)===n&&n.startsWith("0000")?setTimeout(function(){e.mobile=t,e.login()},300):this.$message.error("token异常，权限校验失败！")},destroyed:function(){this.countDownTimer&&clearInterval(this.countDownTimer)},methods:{querystring:function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=(window.location.search.replace("?","")||window.location.hash.replace("#/login?","")).match(t);return null!=n?decodeURIComponent(n[2]):null},login:function(){var e=this,t=localStorage.getItem(a.k);null==t&&(t=r.a.create().toString(),console.log("generate device id "+t),localStorage.setItem(a.k,t)),console.log("vue deviceId "+t),d()({method:"post",url:a.N,data:s()({mobile:this.querystring("username"),code:window.atob(window.atob(this.code)),clientId:t}),headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(t){if(console.log("login code "+t.data.code+" message "+t.data.message),0==t.data.code){var n=t.data.result.userId,i=t.data.result.token;console.log("userId "+n+" token "+i),e.$store.state.userId=n,e.$store.state.token=i,localStorage.setItem(a.b,n),localStorage.setItem(a.c,i),window.location.hash=window.location.hash.replace("login","conversation"),e.$router.push({path:"/conversation"})}else e.$message.error(t.data.message)}).catch(function(e){console.log(e)})},loginEnter:function(e){13===e.keyCode&&""!=this.mobile&&""!=this.code&&this.login()},sendVerifyCode:function(){var e=this;if(!/^1[3|4|5|7|8|9]\d{9}$/.test(this.mobile))return void this.$message.error("请输入正确的手机号");d()({method:"post",url:a.O,data:s()({mobile:this.mobile}),headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(t){if(console.log("send code "+t.data.code+" message "+t.data.message),0==t.data.code){var n=e;e.sendVerifyBtnDisabled=!0;var i=60;e.countDownTimer=setInterval(function(){n.sendVerifyBtnText=--i+"S",0==i&&(clearInterval(n.countDownTimer),n.sendVerifyBtnDisabled=!1,n.sendVerifyBtnText="发送验证码")},1e3)}else e.$message.error(t.data.message)}).catch(function(e){console.log(e)})}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(23),s=n.n(i),a=n(475),o=n.n(a),r=n(21);n(84),n(5);t.default={components:{mycard:o.a},created:function(){this.$store.dispatch("initData")},computed:s()({},n.i(r.a)(["changeFullScreenMode"])),mounted:function(){var e=this;window.onresize=function(){var t=e.$refs.appRef.offsetHeight;e.$store.state.appHeight=t},this.$store.state.appHeight=this.$refs.appRef.offsetHeight,document.addEventListener("visibilitychange",this.handleVisiable)},destroyed:function(){window.onresize=null,document.removeEventListener("visibilitychange",this.handleVisiable)},methods:{handleVisiable:function(e){this.$store.dispatch("visibilityChange",e.target.visibilityState)}}}},,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(16),s=n(190),a=n.n(s),o=n(64),r=n(65),c=(n(187),n(188)),l=n.n(c),u=n(189);n.n(u);i.default.config.productionTip=!1,i.default.use(l.a);new i.default({el:"#app",router:o.a,store:r.a,template:"<App/>",components:{App:a.a}})},function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=function e(){s()(this,e)};a.REASON_Unknown="unknown",a.REASON_Busy="busy",a.REASON_SignalError="signalError",a.REASON_Hangup="hangup",a.REASON_MediaError="mediaError",a.REASON_RemoteHangup="remoteHangup",a.REASON_OpenCameraFailure="openCameraError",a.REASON_Timeout="timeout",a.REASON_AcceptByOtherClient="acceptByOtherClient",a.REASON_AllLeft="allLeft",t.a=a},function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=n(1),o=n.n(a),r=n(81),c=function(){function e(t){s()(this,e),this.startTime=(new Date).getTime(),this.voipClient=t}return o()(e,[{key:"setState",value:function(e){this.callState=e,console.log("set current call state "+this.callState),this.sessionCallback&&this.sessionCallback.didChangeState(this.callState)}},{key:"endCall",value:function(e){this.setState(r.a.STATUS_IDLE),this.voipClient.closeCall(),this.voipClient.currentSession=null,this.sessionCallback&&this.sessionCallback.didCallEndWithReason(e)}}]),e}();t.a=c},function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=n(1),o=n.n(a),r=function(){function e(){s()(this,e)}return o()(e,[{key:"onReceiveCall",value:function(e){}},{key:"shouldStartRing",value:function(e){}},{key:"shouldSopRing",value:function(){}}]),e}();t.a=r},function(e,t,n){"use strict";var i=n(2),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(4),u=n.n(l),d=n(17),f=n.n(d),h=n(3),g=n.n(h),p=n(29),v=n(12),m=n(26),y=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return o()(this,t),u()(this,(t.__proto__||s()(t)).call(this,v.a.VOIP_CONTENT_TYPE_MODIFY,e,n))}return g()(t,e),c()(t,[{key:"digest",value:function(){return""}},{key:"encode",value:function(){var e=f()(t.prototype.__proto__||s()(t.prototype),"encode",this).call(this);e.content=this.callId;var n;return n=this.audioOnly?"1":"0",e.binaryContent=m.a.utf8_to_b64(n),e}},{key:"decode",value:function(e){f()(t.prototype.__proto__||s()(t.prototype),"decode",this).call(this,e),this.callId=e.content;var n=m.a.b64_to_utf8(e.binaryContent);this.audioOnly="1"===n}}]),t}(p.a);t.a=y},function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=n(1),o=n.n(a),r=function(){function e(){s()(this,e)}return o()(e,[{key:"didCallEndWithReason",value:function(e){}},{key:"didChangeState",value:function(e){}},{key:"didChangeMode",value:function(e){}},{key:"didCreateLocalVideoTrack",value:function(e){}},{key:"didReceiveRemoteVideoTrack",value:function(e){}},{key:"didReceiveRemoteAudioTrack",value:function(e){}},{key:"didError",value:function(e){}},{key:"didGetStats",value:function(e){}}]),e}();t.a=r},function(e,t,n){"use strict";var i=n(153),s=n.n(i),a=n(152),o=n.n(a),r=n(14),c=n.n(r),l=n(2),u=n.n(l),d=n(0),f=n.n(d),h=n(1),g=n.n(h),p=n(4),v=n.n(p),m=n(3),y=n.n(m),_=n(137),C=n(82),k=n(297),w=n(52),I=n(133),b=n(136),S=n(134),M=n(267),T=n(135),x=n(144),N=n(81),P=n(266),E=function(e){function t(e){f()(this,t);var n=v()(this,(t.__proto__||u()(t)).call(this));return n.mediaConstraints={audio:!0,video:!0},n.handleNegotiationNeededEvent=function(){n.handleOfferMessage()},n.handleICECandidateEvent=function(e){if(e.candidate){console.log("*** Outgoing ICE candidate: "+e.candidate.candidate);var t=new b.a;t.callId=n.currentSession.callId;var i={type:"candidate",label:e.candidate.sdpMLineIndex,id:e.candidate.sdpMid,candidate:e.candidate.candidate};t.payload=c()(i),n.offerMessage(n.currentSession.clientId,t)}},n.handleICEConnectionStateChangeEvent=function(e){switch(console.log("*** ICE connection state changed to "+n.myPeerConnection.iceConnectionState),n.myPeerConnection.iceConnectionState){case"connected":n.currentSession.setState(N.a.STATUS_CONNECTED);break;case"closed":case"failed":case"disconnected":n.cancelCall()}},n.handleSignalingStateChangeEvent=function(e){switch(console.log("*** WebRTC signaling state changed to: "+n.myPeerConnection.signalingState),n.myPeerConnection.signalingState){case"closed":n.cancelCall()}},n.handleTrackEvent=function(e){console.log("comming stream"),n.currentSession.isAudioOnly?n.currentSessionCallback.didReceiveRemoteAudioTrack(e.streams[0]):n.currentSessionCallback.didReceiveRemoteVideoTrack(e.streams[0])},n.handleICEGatheringStateChangeEvent=function(e){console.log("*** ICE gathering state changed to: "+e)},n.store=e,C.a.addReceiveMessageListener(n),n}return y()(t,e),g()(t,[{key:"setCurrentSessionCallback",value:function(e){this.currentSessionCallback=e}},{key:"setCurrentEngineCallback",value:function(e){this.currentEngineCallback=e}},{key:"startCall",value:function(e,t){this.isInitiator=!1;var n=this.newSession(e,t,e+(new Date).getTime());n.setState(N.a.STATUS_OUTGOING),this.currentSession=n,console.log("create new session "+this.currentSession.clientId+" callId "+this.currentSession.callId);var i=new _.a(n.callId,e,t);this.offerMessage(e,i),this.startPreview()}},{key:"cancelCall",value:function(){var e=new T.a;e.callId=this.currentSession.callId,this.offerMessage(this.currentSession.clientId,e),console.log("send bye message"),this.currentSession.endCall(P.a.REASON_RemoteHangup),this.currentSession=null}},{key:"answerCall",value:function(e){this.isInitiator=!0,console.log("isInitiator "+this.isInitiator),this.currentSession.setState(N.a.STATUS_CONNECTING);var t=new S.a;t.isAudioOnly=e,t.callId=this.currentSession.callId,this.offerMessage(this.currentSession.clientId,t),this.startPreview()}},{key:"newSession",value:function(e,t,n){var i=new M.a(this);return i.clientId=e,i.audioOnly=t,i.callId=n,i.sessionCallback=this.currentSessionCallback,i}},{key:"rejectOtherCall",value:function(e,t){var n=new T.a;n.callId=e,this.log("reject other callId "+e+" clientId "+t),this.offerMessage(t,n)}},{key:"offerMessage",value:function(e,t){this.store.dispatch("sendMessage",new x.a(e,t))}},{key:"offerMessageByType",value:function(e){var t=new b.a;t.callId=this.currentSession.callId;var n={type:e,sdp:this.myPeerConnection.localDescription.sdp};t.payload=c()(n),this.offerMessage(this.currentSession.clientId,t)}},{key:"onReceiveMessage",value:function(e){if((new Date).getTime()-e.timestamp<9e4&&1===e.direction){var t=w.a.getMessageContentClazz(e.content.type);if(t){var n=new t;try{n.decode(e.content)}catch(e){console.log("decode error")}if(this.currentSession&&console.log("current call state "+this.currentSession.callState),n instanceof _.a)console.log("receive call startmessage"),this.currentSession&&this.currentSession.callState!==N.a.STATUS_IDLE?this.rejectOtherCall(n.callId,e.from):(this.currentSession=this.newSession(e.from,n.audioOnly,n.callId),this.currentSession.setState(N.a.STATUS_INCOMING),this.currentEngineCallback.onReceiveCall(this.currentSession));else if(n instanceof I.a||n instanceof S.a)this.isInitiator=!1,this.currentSession&&this.currentSession.callState!=N.a.STATUS_IDLE&&(console.log(" CallAnswerMessageContent callState "+this.currentSession.callState),e.from===this.currentSession.clientId&&n.callId===this.currentSession.callId&&(this.currentSession.callState!=N.a.STATUS_OUTGOING||this.currentSession.callState===N.a.STATUS_OUTGOING&&this.currentSession.setState(N.a.STATUS_CONNECTING)));else if(n instanceof b.a)this.currentSession&&this.currentSession.callState!=N.a.STATUS_IDLE&&(console.log("current state "+this.currentSession.callState+" call signal payload "+n.payload),this.currentSession.callState===N.a.STATUS_CONNECTING||this.currentSession.callState===N.a.STATUS_CONNECTED?e.from===this.currentSession.clientId&&n.callId===this.currentSession.callId&&this.handleSignalMsg(n.payload):this.currentSession.endCall(P.a.REASON_AcceptByOtherClient));else if(n instanceof T.a){if(!this.currentSession||this.currentSession.callState===N.a.STATUS_IDLE||e.from!=this.currentSession.clientId||n.callId!=this.currentSession.callId)return;this.cancelCall()}}}}},{key:"handleSignalMsg",value:function(){function e(e){return t.apply(this,arguments)}var t=o()(s.a.mark(function e(t){var n,i,a,o,r,l,u;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=JSON.parse(t),i=n.type,console.log("message type "+i),"candidate"!==i){e.next=17;break}return a={candidate:n.candidate,sdpMLineIndex:n.label,sdpMid:n.id},o=new RTCIceCandidate(a),this.log("*** Adding received ICE candidate: "+c()(o)),e.prev=7,e.next=10,this.myPeerConnection.addIceCandidate(o);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(7),this.reportError(e.t0);case 15:e.next=41;break;case 17:if("remove-candidates"!==i){e.next=21;break}this.log("remove candidates "),e.next=41;break;case 21:if(r=new RTCSessionDescription(n),"answer"!==i){e.next=27;break}return e.next=25,this.myPeerConnection.setRemoteDescription(r);case 25:e.next=41;break;case 27:if("offer"!==i){e.next=41;break}return e.next=30,this.myPeerConnection.setRemoteDescription(r);case 30:return e.t1=this.myPeerConnection,e.next=33,this.myPeerConnection.createAnswer();case 33:return e.t2=e.sent,e.next=36,e.t1.setLocalDescription.call(e.t1,e.t2);case 36:l=new b.a,l.callId=this.currentSession.callId,u={type:"answer",sdp:this.myPeerConnection.localDescription.sdp},l.payload=c()(u),this.offerMessage(this.currentSession.clientId,l);case 41:case"end":return e.stop()}},e,this,[[7,12]])}));return e}()},{key:"handleOfferMessage",value:function(){function e(){return t.apply(this,arguments)}var t=o()(s.a.mark(function e(){var t;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("*** Negotiation needed "+this.isInitiator),this.isInitiator){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,console.log("---\x3e Creating offer"),e.next=7,this.myPeerConnection.createOffer();case 7:if(t=e.sent,"stable"==this.myPeerConnection.signalingState){e.next=11;break}return console.log("     -- The connection isn't stable yet; postponing..."),e.abrupt("return");case 11:return console.log("---\x3e Setting local description to the offer"),e.next=14,this.myPeerConnection.setLocalDescription(t);case 14:console.log("---\x3e Sending the offer to the remote peer"),this.offerMessageByType("offer"),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(3),console.log("*** The following error occurred while handling the negotiationneeded event:"),this.reportError(e.t0);case 22:case 23:case"end":return e.stop()}},e,this,[[3,18]])}));return e}()},{key:"startPreview",value:function(){function e(){return t.apply(this,arguments)}var t=o()(s.a.mark(function e(){var t=this;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.log("Starting to prepare an invitation"),!this.myPeerConnection){e.next=5;break}alert("You can't start a call because you already have one open!"),e.next=19;break;case 5:return e.prev=5,this.mediaConstraints={audio:!0,video:!this.currentSession.isAudioOnly},e.next=9,navigator.mediaDevices.getUserMedia(this.mediaConstraints);case 9:this.webcamStream=e.sent,this.currentSession.isAudioOnly||this.currentSessionCallback.didCreateLocalVideoTrack(this.webcamStream),e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(5),this.handleGetUserMediaError(e.t0),e.abrupt("return");case 17:this.createPeerConnection();try{this.webcamStream.getTracks().forEach(function(e){return t.sender=t.myPeerConnection.addTrack(e,t.webcamStream)})}catch(e){this.handleGetUserMediaError(e)}case 19:case"end":return e.stop()}},e,this,[[5,13]])}));return e}()},{key:"createPeerConnection",value:function(){function e(){return t.apply(this,arguments)}var t=o()(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.log("Setting up a connection..."),this.myPeerConnection=new RTCPeerConnection({iceServers:[{urls:"turn:turn.liyufan.win:3478",username:"wfchat",credential:"wfchat"}]}),this.myPeerConnection.onicecandidate=this.handleICECandidateEvent,this.myPeerConnection.oniceconnectionstatechange=this.handleICEConnectionStateChangeEvent,this.myPeerConnection.onicegatheringstatechange=this.handleICEGatheringStateChangeEvent,this.myPeerConnection.onsignalingstatechange=this.handleSignalingStateChangeEvent,this.myPeerConnection.onnegotiationneeded=this.handleNegotiationNeededEvent,this.myPeerConnection.ontrack=this.handleTrackEvent;case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"closeCall",value:function(){if(this.log("Closing the call"),this.myPeerConnection){if(this.log("--\x3e Closing the peer connection"),this.myPeerConnection.ontrack=null,this.myPeerConnection.onnicecandidate=null,this.myPeerConnection.oniceconnectionstatechange=null,this.myPeerConnection.onsignalingstatechange=null,this.myPeerConnection.onicegatheringstatechange=null,this.myPeerConnection.onnotificationneeded=null,this.myPeerConnection.removeTrack(this.sender),this.currentSession.isAudioOnly)this.webcamStream.getTracks.forEach(function(e){e.stop()});else{var e=document.getElementById("wxCallLocalVideo");e.srcObject&&(e.pause(),e.srcObject.getTracks().forEach(function(e){e.stop()}))}this.myPeerConnection.close(),this.myPeerConnection=null,this.webcamStream=null}}},{key:"handleGetUserMediaError",value:function(e){switch(this.log_error(e),e.name){case"NotFoundError":alert("Unable to open your call because no camera and/or microphonewere found.");break;case"SecurityError":case"PermissionDeniedError":break;default:alert("Error opening your camera and/or microphone: "+e.message)}this.cancelCall()}},{key:"reportError",value:function(e){this.log_error("Error "+e.name+": "+e.message)}},{key:"log_error",value:function(e){var t=new Date;console.trace("["+t.toLocaleTimeString()+"] "+e)}},{key:"log",value:function(e){var t=new Date;console.log("["+t.toLocaleTimeString()+"] "+e)}}]),t}(k.a);t.a=E},function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=function e(t,n){s()(this,e),this.resolve=t,this.timeoutId=n};t.a=a},function(e,t,n){"use strict";var i=n(2),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(4),u=n.n(l),d=n(3),f=n.n(d),h=n(7),g=n(5),p=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||s()(t)).apply(this,arguments))}return f()(t,e),c()(t,[{key:"match",value:function(e){return e.signal==g.G&&e.subSignal==g.v}}]),t}(h.a);t.a=p},function(e,t,n){"use strict";var i=n(2),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(4),u=n.n(l),d=n(3),f=n.n(d),h=n(5),g=n(7),p=n(10),v=function(e){function t(e){return o()(this,t),u()(this,(t.__proto__||s()(t)).call(this,e))}return f()(t,e),c()(t,[{key:"match",value:function(e){return e.signal==h.M}},{key:"processMessage",value:function(e){console.log("ConnectAckHandler process message");var t=JSON.parse(e.content);console.log("connectAcceptedMessage friendHead "+t.friendHead+" messageHead "+t.messageHead),this.vueWebsocket.getFriend();var n=p.a.getLastMessageSeq();n?this.vueWebsocket.sendAction("changetFirstLogin",!1):(n="0",this.vueWebsocket.sendAction("changetFirstLogin",!0)),this.vueWebsocket.getFriendRequest(p.a.getFriendRequestVersion()),this.vueWebsocket.pullMessage(n,0,0,p.a.getSendMessageCount()),p.a.setLastMessageSeq(t.messageHead)}}]),t}(g.a);t.a=v},function(e,t,n){"use strict";var i=n(2),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(4),u=n.n(l),d=n(3),f=n.n(d),h=n(7),g=n(5),p=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||s()(t)).apply(this,arguments))}return f()(t,e),c()(t,[{key:"match",value:function(e){return e.signal==g.G&&e.subSignal==g.x}}]),t}(h.a);t.a=p},function(e,t,n){"use strict";var i=n(2),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(4),u=n.n(l),d=n(3),f=n.n(d),h=n(7),g=n(5),p=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||s()(t)).apply(this,arguments))}return f()(t,e),c()(t,[{key:"match",value:function(e){return e.signal==g.G&&e.subSignal==g.A}}]),t}(h.a);t.a=p},function(e,t,n){"use strict";var i=n(2),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(4),u=n.n(l),d=n(3),f=n.n(d),h=n(7),g=n(5),p=n(13),v=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||s()(t)).apply(this,arguments))}return f()(t,e),c()(t,[{key:"match",value:function(e){return e.signal==g.G&&e.subSignal==g.o}},{key:"processMessage",value:function(e){var t=JSON.parse(e.content);p.a.log("friend add request result "+t)}}]),t}(h.a);t.a=v},function(e,t,n){"use strict";var i=n(28),s=n.n(i),a=n(2),o=n.n(a),r=n(0),c=n.n(r),l=n(1),u=n.n(l),d=n(4),f=n.n(d),h=n(3),g=n.n(h),p=n(7),v=n(5),m=n(10),y=function(e){function t(){return c()(this,t),f()(this,(t.__proto__||o()(t)).apply(this,arguments))}return g()(t,e),u()(t,[{key:"match",value:function(e){return e.signal==v.G&&e.subSignal==v.p}},{key:"processMessage",value:function(e){if(null!=e.content&&""!=e.content){var t=JSON.parse(e.content),n=[],i=[],a=!0,o=!1,r=void 0;try{for(var c,l=s()(t);!(a=(c=l.next()).done);a=!0){var u=c.value;u.from!=m.a.getUserId()&&(n.push(u),i.push(u.from))}}catch(e){o=!0,r=e}finally{try{!a&&l.return&&l.return()}finally{if(o)throw r}}this.vueWebsocket.getUserInfos(i),this.vueWebsocket.sendAction("updateFriendRequest",n)}}}]),t}(p.a);t.a=y},function(e,t,n){"use strict";var i=n(28),s=n.n(i),a=n(2),o=n.n(a),r=n(0),c=n.n(r),l=n(1),u=n.n(l),d=n(4),f=n.n(d),h=n(3),g=n.n(h),p=n(7),v=n(5),m=n(146),y=function(e){function t(){return c()(this,t),f()(this,(t.__proto__||o()(t)).apply(this,arguments))}return g()(t,e),u()(t,[{key:"match",value:function(e){return e.signal==v.G&&e.subSignal==v.t}},{key:"processMessage",value:function(e){if(null!=e.content){var t=JSON.parse(e.content),n=[],i=!0,a=!1,o=void 0;try{for(var r,c=s()(t);!(i=(r=c.next()).done);i=!0){var l=r.value;n.push(m.a.convert2GroupInfo(l))}}catch(e){a=!0,o=e}finally{try{!i&&c.return&&c.return()}finally{if(a)throw o}}this.vueWebsocket.sendAction("updateGroupInfos",n)}}}]),t}(p.a);t.a=y},function(e,t,n){"use strict";var i=n(28),s=n.n(i),a=n(2),o=n.n(a),r=n(0),c=n.n(r),l=n(1),u=n.n(l),d=n(4),f=n.n(d),h=n(3),g=n.n(h),p=n(7),v=n(5),m=n(86),y=function(e){function t(){return c()(this,t),f()(this,(t.__proto__||o()(t)).apply(this,arguments))}return g()(t,e),u()(t,[{key:"match",value:function(e){return e.signal==v.G&&e.subSignal==v.u}},{key:"notifyContent",value:function(e){var t=JSON.parse(e),n=[],i=!0,a=!1,o=void 0;try{for(var r,c=s()(t);!(i=(r=c.next()).done);i=!0){var l=r.value;n.push(m.a.convert2GroupMember(l))}}catch(e){a=!0,o=e}finally{try{!i&&c.return&&c.return()}finally{if(a)throw o}}return n}}]),t}(p.a);t.a=y},function(e,t,n){"use strict";var i=n(2),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(4),u=n.n(l),d=n(3),f=n.n(d),h=n(7),g=n(5),p=n(10),v=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||s()(t)).apply(this,arguments))}return f()(t,e),c()(t,[{key:"match",value:function(e){return e.signal==g.G&&e.subSignal==g.D}},{key:"processMessage",value:function(e){if(e.content){var t=JSON.parse(e.content),n=t.domain,i=t.token;console.log("domain "+n+" token "+i),p.a.setUploadToken(n,i)}}}]),t}(h.a);t.a=v},function(e,t,n){"use strict";var i=n(2),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(4),u=n.n(l),d=n(3),f=n.n(d),h=n(7),g=n(5),p=n(10),v=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||s()(t)).apply(this,arguments))}return f()(t,e),c()(t,[{key:"match",value:function(e){return e.signal==g.G&&e.subSignal==g.m}},{key:"processMessage",value:function(e){var t=JSON.parse(e.content),n=[];for(var i in t)n[i]=t[i].friendUid;this.vueWebsocket.sendAction("updateFriendIds",n),n.push(p.a.getUserId()),this.vueWebsocket.getUserInfos(n)}}]),t}(h.a);t.a=v},function(e,t,n){"use strict";var i=n(2),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(4),u=n.n(l),d=n(3),f=n.n(d),h=n(7),g=n(5),p=n(150),v=n(453),m=n.n(v),y=n(185),_=(n.n(y),n(83)),C=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||s()(t)).apply(this,arguments))}return f()(t,e),c()(t,[{key:"match",value:function(e){return e.signal==g.G&&e.subSignal==g.r}},{key:"processMessage",value:function(e){if(null!=e.content&&""!=e.content){var t=JSON.parse(e.content),n=[],i=[];for(var s in t){var a=""===t[s].displayName?t[s].mobile:t[s].displayName,o=m()(a,{style:m.a.STYLE_FIRST_LETTER}),r=o[0][0];if(r.length>1){var r=r.substr(0,1);r=/^[A-Za-z]/.test(r)?r.toUpperCase():"#"}else r=r.toUpperCase();n.push({id:parseInt(s)+1,wxid:t[s].uid,initial:r,img:t[s].portrait,signature:"",nickname:a,sex:0,remark:a,area:t[s].address}),i.push(p.a.convert2UserInfo(t[s]))}if(this.vueWebsocket.resolvePromiseMap.has(e.messageId)){console.log("messageId "+e.messageId);var c=this.vueWebsocket.resolvePromiseMap.get(e.messageId);clearTimeout(c.timeoutId);var a=""===t[0].displayName?t[0].mobile:t[0].displayName;c.resolve(new _.a(g.a,a)),this.vueWebsocket.resolvePromiseMap.delete(e.messageId)}this.vueWebsocket.sendAction("updateUserInfos",i),this.vueWebsocket.sendAction("updateFriendList",n)}}}]),t}(h.a);t.a=C},function(e,t,n){"use strict";var i=n(2),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(4),u=n.n(l),d=n(3),f=n.n(d),h=n(7),g=n(5),p=n(13),v=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||s()(t)).apply(this,arguments))}return f()(t,e),c()(t,[{key:"match",value:function(e){return e.signal==g.G&&e.subSignal==g.q}},{key:"processMessage",value:function(e){if(e.content&&""!=e.content){var t=JSON.parse(e.content);p.a.log("handle friend request "+t)}}}]),t}(h.a);t.a=v},function(e,t,n){"use strict";var i=n(2),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(4),u=n.n(l),d=n(3),f=n.n(d),h=n(7),g=n(5),p=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||s()(t)).apply(this,arguments))}return f()(t,e),c()(t,[{key:"match",value:function(e){return e.signal==g.G&&e.subSignal==g.w}}]),t}(h.a);t.a=p},function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=n(1),o=n.n(a),r=function(){function e(){s()(this,e)}return o()(e,[{key:"match",value:function(e){return!1}},{key:"processMessage",value:function(e){}}]),e}();t.a=r},function(e,t,n){"use strict";var i=n(2),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(4),u=n.n(l),d=n(3),f=n.n(d),h=n(7),g=n(5),p=n(13),v=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||s()(t)).apply(this,arguments))}return f()(t,e),c()(t,[{key:"match",value:function(e){return e.signal==g.G&&e.subSignal==g.s}},{key:"processMessage",value:function(e){e&&""!=e.content&&p.a.log("modify myInfo "+e.content)}}]),t}(h.a);t.a=v},function(e,t,n){"use strict";var i=n(2),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(4),u=n.n(l),d=n(3),f=n.n(d),h=n(7),g=n(5),p=n(13),v=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||s()(t)).apply(this,arguments))}return f()(t,e),c()(t,[{key:"match",value:function(e){return e.signal==g.E&&e.subSignal==g.J}},{key:"processMessage",value:function(e){if(e.content&&""!=e.content){var t=JSON.parse(e.content);p.a.log("friend head "+t.head),this.vueWebsocket.getFriend()}}}]),t}(h.a);t.a=v},function(e,t,n){"use strict";var i=n(2),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(4),u=n.n(l),d=n(3),f=n.n(d),h=n(7),g=n(5),p=n(13),v=n(10),m=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||s()(t)).apply(this,arguments))}return f()(t,e),c()(t,[{key:"match",value:function(e){return e.signal==g.E&&e.subSignal==g.K}},{key:"processMessage",value:function(e){if(null!=e.content){var t=JSON.parse(e.content);p.a.log("friend request version "+t.version),v.a.setFriendRequestVersion(t.version),this.vueWebsocket.getFriendRequest(t.version)}}}]),t}(h.a);t.a=m},function(e,t,n){"use strict";var i=n(2),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(4),u=n.n(l),d=n(3),f=n.n(d),h=n(7),g=n(5),p=n(10),v=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||s()(t)).apply(this,arguments))}return f()(t,e),c()(t,[{key:"match",value:function(e){return e.signal==g.E&&e.subSignal==g.L}},{key:"processMessage",value:function(e){console.log("notifymessage "+e.content);var t=JSON.parse(e.content);console.log("notify messageHead "+t.messageHead+" notify type "+t.type),p.a.resetSendMessageCount(),p.a.setLastMessageSeq(t.messageHead),this.vueWebsocket.pullMessage(t.messageHead,t.type,1)}}]),t}(h.a);t.a=v},function(e,t,n){"use strict";var i=n(2),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(4),u=n.n(l),d=n(3),f=n.n(d),h=n(7),g=n(5),p=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||s()(t)).apply(this,arguments))}return f()(t,e),c()(t,[{key:"match",value:function(e){return e.signal==g.E&&e.subSignal==g.I}},{key:"processMessage",value:function(e){if(e.content){var t=JSON.parse(e.content);console.log("from user "+t.fromUser+" messageUid "+t.messageUid),this.vueWebsocket.sendAction("updateMessageContent",t)}}}]),t}(h.a);t.a=p},function(e,t,n){"use strict";var i=n(2),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(4),u=n.n(l),d=n(3),f=n.n(d),h=n(7),g=n(5),p=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||s()(t)).apply(this,arguments))}return f()(t,e),c()(t,[{key:"match",value:function(e){return e.signal==g.G&&e.subSignal==g.z}}]),t}(h.a);t.a=p},function(e,t,n){"use strict";var i=n(2),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(4),u=n.n(l),d=n(3),f=n.n(d),h=n(7),g=n(5),p=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||s()(t)).apply(this,arguments))}return f()(t,e),c()(t,[{key:"match",value:function(e){return e.signal==g.G&&e.subSignal==g.B}}]),t}(h.a);t.a=p},function(e,t,n){"use strict";var i=n(28),s=n.n(i),a=n(2),o=n.n(a),r=n(0),c=n.n(r),l=n(1),u=n.n(l),d=n(4),f=n.n(d),h=n(3),g=n.n(h),p=n(7),v=n(5),m=(n(139),n(142)),y=(n(148),n(10)),_=(n(87),n(52)),C=(n(141),n(82)),k=function(e){function t(){var e,n,i,s;c()(this,t);for(var a=arguments.length,r=Array(a),l=0;l<a;l++)r[l]=arguments[l];return n=i=f()(this,(e=t.__proto__||o()(t)).call.apply(e,[this].concat(r))),i.conversations=[],s=n,f()(i,s)}return g()(t,e),u()(t,[{key:"match",value:function(e){return e.signal==v.G&&e.subSignal==v.C}},{key:"processMessage",value:function(e){y.a.resetSendMessageCount();var t=JSON.parse(e.content);console.log("current "+t.current+" head "+t.head+" messageCount "+t.messageCount),0==t.messageCount?this.vueWebsocket.sendAction("changeEmptyMessageState",!0):this.vueWebsocket.sendAction("changeEmptyMessageState",!1);var n=!0,i=!1,a=void 0;try{for(var o,r=s()(t.messageResponseList);!(n=(o=r.next()).done);n=!0){var c=o.value,c=m.a.toProtoMessage(c);_.a.isDisplayableMessage(c)&&this.addProtoMessage(c),C.a.onReceiveMessage(c)}}catch(e){i=!0,a=e}finally{try{!n&&r.return&&r.return()}finally{if(i)throw a}}this.vueWebsocket.sendAction("changetFirstLogin",!1)}},{key:"addProtoMessage",value:function(e){this.vueWebsocket.sendAction("addProtoMessage",e)}}]),t}(p.a);t.a=k},function(e,t,n){"use strict";var i=n(2),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(4),u=n.n(l),d=n(3),f=n.n(d),h=n(7),g=n(5),p=(n(13),n(150),function(e){function t(){return o()(this,t),u()(this,(t.__proto__||s()(t)).apply(this,arguments))}return f()(t,e),c()(t,[{key:"match",value:function(e){return e.signal==g.G&&e.subSignal==g.n}},{key:"processMessage",value:function(e){var t=JSON.parse(e.content);this.vueWebsocket.sendAction("updateSearchUser",t)}}]),t}(h.a));t.a=p},function(e,t,n){"use strict";var i=n(2),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(4),u=n.n(l),d=n(3),f=n.n(d),h=n(7),g=n(5),p=n(10),v=n(13),m=n(66),y=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||s()(t)).apply(this,arguments))}return f()(t,e),c()(t,[{key:"match",value:function(e){return e.signal==g.G&&e.subSignal==g.F}},{key:"processMessage",value:function(e){if(v.a.log("sendMessage Handler messageId "+e.messageId),this.vueWebsocket.resolvePromiseMap.has(e.messageId)){var t=this.vueWebsocket.resolvePromiseMap.get(e.messageId);if(""!=e.content){var n=JSON.parse(e.content);console.log("SendMessageHandler messageId "+n.messageId+" timestamp protoMessageId "+t.protoMessageId),this.vueWebsocket.sendAction("updateProtoMessageUid",{messageId:t.protoMessageId,messageUid:n.messageId}),this.vueWebsocket.sendAction("updateMessageStatus",{messageId:t.protoMessageId,status:m.a.Sent}),p.a.updateSendMessageCount(),t.resolve("success")}else this.vueWebsocket.sendAction("updateMessageStatus",{messageId:t.protoMessageId,status:m.a.SendFailure}),t.resolve("fail");clearTimeout(t.timeoutId),this.vueWebsocket.resolvePromiseMap.delete(e.messageId)}}}]),t}(h.a);t.a=y},function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=n(1),o=n.n(a),r=function(){function e(){s()(this,e)}return o()(e,[{key:"onReceiveMessage",value:function(e){}}]),e}();t.a=r},function(e,t,n){"use strict";var i=n(2),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(4),u=n.n(l),d=n(17),f=n.n(d),h=n(3),g=n.n(h),p=n(29),v=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments[2],a=arguments[3];o()(this,t);var r=u()(this,(t.__proto__||s()(t)).call(this,e));return r.remotePath="",r.localPath="",r.mediaType=0,r.mediaType=n,"string"==typeof i?(r.localPath=i,r.remotePath=a):(r.file=i,i&&void 0!==i.path&&(r.localPath=i.path,r.localPath.indexOf(i.name)<0&&(r.localPath+=i.name))),r}return g()(t,e),c()(t,[{key:"encode",value:function(){var e=f()(t.prototype.__proto__||s()(t.prototype),"encode",this).call(this);return e.localMediaPath=this.localPath,e.remoteMediaUrl=this.remotePath,e.mediaType=this.mediaType,e.searchableContent=this.digest(),e}},{key:"decode",value:function(e){f()(t.prototype.__proto__||s()(t.prototype),"decode",this).call(this,e),this.localPath=e.localMediaPath,this.remotePath=e.remoteMediaUrl,this.mediaType=e.mediaType}}]),t}(p.a);t.a=v},function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=function e(){s()(this,e)};a.Modify_Group_Name=0,a.Modify_Group_Portrait=1,a.Modify_Group_Extra=2,t.a=a},function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=function e(){s()(this,e)};a.Modify_DisplayName=0,a.Modify_Portrait=1,a.Modify_Gender=2,a.Modify_Mobile=3,a.Modify_Email=4,a.Modify_Address=5,a.Modify_Company=6,a.Modify_Social=7,a.Modify_Extra=8,t.a=a},function(e,t,n){"use strict";var i=n(14),s=n.n(i),a=n(2),o=n.n(a),r=n(0),c=n.n(r),l=n(1),u=n.n(l),d=n(4),f=n.n(d),h=n(17),g=n.n(h),p=n(3),v=n.n(p),m=n(12),y=n(40),_=n(26),C=n(27),k=function(e){function t(e,n){c()(this,t);var i=f()(this,(t.__proto__||o()(t)).call(this,m.a.AddGroupMember_Notification));return i.invitor="",i.invitees=[],i.invitor=e,i.invitees=n,i}return v()(t,e),u()(t,[{key:"formatNotification",value:function(){var e=void 0;if(1===this.invitees.length&&this.invitees[0]===this.invitor)return this.fromSelf?"您加入了群组":C.a.getDisplayName(this.invitor)+" 加入了群组";e=this.fromSelf?"您邀请:":C.a.getDisplayName(this.invitor)+"邀请:";var t="";return this.invitees.forEach(function(e){t+=" "+C.a.getDisplayName(e)}),e+t+"加入了群组"}},{key:"encode",value:function(){var e=g()(t.prototype.__proto__||o()(t.prototype),"encode",this).call(this),n={g:this.groupId,o:this.invitor,ms:this.invitees};return e.binaryContent=_.a.utf8_to_b64(s()(n)),e}},{key:"decode",value:function(e){g()(t.prototype.__proto__||o()(t.prototype),"decode",this).call(this,e);var n=_.a.b64_to_utf8(e.binaryContent),i=JSON.parse(n);this.groupId=i.g,this.invitor=i.o,this.invitees=i.ms}}]),t}(y.a);t.a=k},function(e,t,n){"use strict";var i=n(14),s=n.n(i),a=n(2),o=n.n(a),r=n(0),c=n.n(r),l=n(1),u=n.n(l),d=n(4),f=n.n(d),h=n(17),g=n.n(h),p=n(3),v=n.n(p),m=n(12),y=n(40),_=n(26),C=n(27),k=function(e){function t(e,n){c()(this,t);var i=f()(this,(t.__proto__||o()(t)).call(this,m.a.ChangeGroupName_Notification));return i.operator="",i.name="",i.operator=e,i.name=n,i}return v()(t,e),u()(t,[{key:"formatNotification",value:function(){return this.fromSelf?"您修改群名称为："+this.name:C.a.getDisplayName(this.operator)+" 修改群名称为:"+this.name}},{key:"encode",value:function(){var e=g()(t.prototype.__proto__||o()(t.prototype),"encode",this).call(this),n={g:this.groupId,n:this.name,o:this.operator};return e.binaryContent=_.a.utf8_to_b64(s()(n)),e}},{key:"decode",value:function(e){g()(t.prototype.__proto__||o()(t.prototype),"decode",this).call(this,e);var n=_.a.b64_to_utf8(e.binaryContent),i=JSON.parse(n);this.groupId=i.g,this.operator=i.o,this.name=i.n}}]),t}(y.a);t.a=k},function(e,t,n){"use strict";var i=n(14),s=n.n(i),a=n(2),o=n.n(a),r=n(0),c=n.n(r),l=n(1),u=n.n(l),d=n(4),f=n.n(d),h=n(17),g=n.n(h),p=n(3),v=n.n(p),m=n(12),y=n(40),_=n(26),C=n(27),k=function(e){function t(e,n){c()(this,t);var i=f()(this,(t.__proto__||o()(t)).call(this,m.a.CreateGroup_Notification));return i.creator="",i.groupName="",i.creator=e,i.groupName=n,i}return v()(t,e),u()(t,[{key:"formatNotification",value:function(){return this.fromSelf?"您创建了群组 "+this.groupName:C.a.getDisplayName(this.creator)+" 创建了群组 "+this.groupName}},{key:"encode",value:function(){var e=g()(t.prototype.__proto__||o()(t.prototype),"encode",this).call(this),n={g:this.groupId,n:this.groupName,o:this.creator};return e.binaryContent=_.a.utf8_to_b64(s()(n)),e}},{key:"decode",value:function(e){g()(t.prototype.__proto__||o()(t.prototype),"decode",this).call(this,e);var n=_.a.b64_to_utf8(e.binaryContent),i=JSON.parse(n);this.groupId=i.g,this.creator=i.o,this.groupName=i.n}}]),t}(y.a);t.a=k},function(e,t,n){"use strict";var i=n(14),s=n.n(i),a=n(2),o=n.n(a),r=n(0),c=n.n(r),l=n(1),u=n.n(l),d=n(4),f=n.n(d),h=n(17),g=n.n(h),p=n(3),v=n.n(p),m=n(12),y=n(40),_=n(26),C=n(27),k=function(e){function t(e){c()(this,t);var n=f()(this,(t.__proto__||o()(t)).call(this,m.a.DismissGroup_Notification));return n.operator="",n.operator=e,n}return v()(t,e),u()(t,[{key:"formatNotification",value:function(){return this.fromSelf?"您解散了群组":C.a.getDisplayName(this.operator)+"解散了群组"}},{key:"encode",value:function(){var e=g()(t.prototype.__proto__||o()(t.prototype),"encode",this).call(this),n={g:this.groupId,o:this.operator};return e.binaryContent=_.a.utf8_to_b64(s()(n)),e}},{key:"decode",value:function(e){g()(t.prototype.__proto__||o()(t.prototype),"decode",this).call(this,e);var n=_.a.b64_to_utf8(e.binaryContent),i=JSON.parse(n);this.groupId=i.g,this.operator=i.o}}]),t}(y.a);t.a=k},function(e,t,n){"use strict";var i=n(14),s=n.n(i),a=n(2),o=n.n(a),r=n(0),c=n.n(r),l=n(1),u=n.n(l),d=n(4),f=n.n(d),h=n(17),g=n.n(h),p=n(3),v=n.n(p),m=n(12),y=n(40),_=n(26),C=n(27),k=function(e){function t(e,n){c()(this,t);var i=f()(this,(t.__proto__||o()(t)).call(this,m.a.KickOffGroupMember_Notification));return i.operator="",i.kickedMembers=[],i.operator=e,i.kickedMembers=n,i}return v()(t,e),u()(t,[{key:"formatNotification",value:function(){var e=void 0;e=this.fromSelf?"您把 ":C.a.getDisplayName(this.operator)+"把 ";var t="";return this.kickedMembers.forEach(function(e){t+=" "+C.a.getDisplayName(e)}),e+t+" 移除了群组"}},{key:"encode",value:function(){var e=g()(t.prototype.__proto__||o()(t.prototype),"encode",this).call(this),n={g:this.groupId,ms:this.kickedMembers,o:this.operateUser};return e.binaryContent=_.a.utf8_to_b64(s()(n)),e}},{key:"decode",value:function(e){g()(t.prototype.__proto__||o()(t.prototype),"decode",this).call(this,e);var n=_.a.b64_to_utf8(e.binaryContent),i=JSON.parse(n);this.groupId=i.g,this.operator=i.o,this.kickedMembers=i.ms}}]),t}(y.a);t.a=k},function(e,t,n){"use strict";var i=n(14),s=n.n(i),a=n(2),o=n.n(a),r=n(0),c=n.n(r),l=n(1),u=n.n(l),d=n(4),f=n.n(d),h=n(17),g=n.n(h),p=n(3),v=n.n(p),m=n(12),y=n(40),_=n(26),C=n(27),k=function(e){function t(e){c()(this,t);var n=f()(this,(t.__proto__||o()(t)).call(this,m.a.QuitGroup_Notification));return n.operator="",n.operator=e,n}return v()(t,e),u()(t,[{key:"formatNotification",value:function(){return this.fromSelf?"您退出了群组":C.a.getDisplayName(this.operator)+"退出了群组"}},{key:"encode",value:function(){var e=g()(t.prototype.__proto__||o()(t.prototype),"encode",this).call(this),n={g:this.groupId,o:this.operator};return e.binaryContent=_.a.utf8_to_b64(s()(n)),e}},{key:"decode",value:function(e){g()(t.prototype.__proto__||o()(t.prototype),"decode",this).call(this,e);var n=_.a.b64_to_utf8(e.binaryContent),i=JSON.parse(n);this.groupId=i.g,this.operator=i.o}}]),t}(y.a);t.a=k},function(e,t,n){"use strict";var i=n(2),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(4),u=n.n(l),d=n(3),f=n.n(d),h=n(29),g=n(12),p=function(e){function t(e){o()(this,t);var n=u()(this,(t.__proto__||s()(t)).call(this,g.a.Unknown));return n.originalPayload=e,n}return f()(t,e),c()(t,[{key:"encode",value:function(){return this.originalPayload}},{key:"decode",value:function(e){this.originalPayload=e}},{key:"digest",value:function(){return"未知类型消息"}}]),t}(h.a);t.a=p},function(e,t,n){"use strict";var i=n(2),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=n(4),u=n.n(l),d=n(3),f=n.n(d),h=n(29),g=function(e){function t(){return o()(this,t),u()(this,(t.__proto__||s()(t)).apply(this,arguments))}return f()(t,e),c()(t,[{key:"digest",value:function(){return"尚不支持该类型消息, 请手机查看 : "+this.type}}]),t}(h.a);t.a=g},function(e,t,n){"use strict";n.d(t,"a",function(){return l});var i=n(14),s=n.n(i),a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=function(){function e(){o()(this,e),console.log("constuctor WebSocketProtoMessage")}return c()(e,[{key:"setMessageId",value:function(e){this.messageId=e}},{key:"setSignal",value:function(e){this.signal=e}},{key:"setSubSignal",value:function(e){this.subSignal=e}},{key:"setContent",value:function(e){this.content=e}},{key:"toJson",value:function(){var e={signal:this.signal,subSignal:null==this.subSignal?"NONE":this.subSignal,messageId:null==this.messageId?0:this.messageId,content:this.content};return s()(e)}}]),e}()},function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=n(1),o=n.n(a),r=n(68),c=function(){function e(t,n,i){s()(this,e),this.type=r.a.Single,this.conversationType=this.type,this.target="",this.line=0,this.type=t,this.conversationType=t,this.target=n,this.line=i}return o()(e,[{key:"equal",value:function(e){return this.type===e.type&&this.target===e.target&&this.line===e.line}}]),e}();t.a=c},function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=function e(){s()(this,e)};a.Normal=0,a.Manager=1,a.Owner=2,t.a=a},function(e,t,n){"use strict";var i=n(0),s=n.n(i),a=function e(){s()(this,e),this.conversationInfo={}};t.a=a},function(e,t,n){"use strict";function i(e){var t=u.a.AES.decrypt(e,d,{iv:d,mode:u.a.mode.CBC,padding:u.a.pad.Pkcs7});return u.a.enc.Hex.parse(t.toString().slice(8)).toString(u.a.enc.Utf8)}function s(e,t){console.log("code "+e+" key "+t);for(var n=new Array(16),i=0;i<16;i++)n[i]=255&t.charCodeAt(i);var s=String.fromCharCode.apply(String,n),o=u.a.enc.Utf8.parse(s);console.log("keycode "+s);var r=a(e);return console.log("timeEncryptCode "+r),u.a.AES.encrypt(u.a.enc.Base64.parse(r),o,{iv:o,mode:u.a.mode.CBC,padding:u.a.pad.Pkcs7}).ciphertext.toString(u.a.enc.Base64)}function a(e){var t=u.a.enc.Base64.parse(e);t=o(t.words);for(var n=[],i=((new Date).getMilliseconds()/1e3-1514736e3)/3600,s=0;s<t.length+4;s++)s<4?0==s?n.push(255&i):1==s?n.push((65280&i)>>8):2==s?n.push((16711680&i)>>16):3==s&&n.push((255&i)>>24):n.push(t[s-4]);console.log("convertTimeEncryptCode result "+n);var a=btoa(String.fromCharCode.apply(String,c()(new Uint8Array(n))));return console.log("hash word "+a),a}function o(e){var t,n,i,s=[];for(n=0;n<e.length;++n)for(t=e[n],i=3;i>=0;--i)s.push(t>>8*i&255);return s}t.a=i,t.b=s;var r=n(321),c=n.n(r),l=n(171),u=n.n(l),d=u.a.enc.Base64.parse("ABEiM0RVZnd4eXp7fH1+fw==")},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},,,,,,,,,,,,,,,,,function(e,t,n){e.exports=n.p+"static/img/logo.45cb3d2.png"},,,,,,function(e,t,n){var i=n(11)(n(232),n(485),null,null);e.exports=i.exports},function(e,t,n){n(443);var i=n(11)(n(234),n(501),"data-v-e54b88ac",null);e.exports=i.exports},function(e,t,n){n(430);var i=n(11)(n(235),n(488),"data-v-3a5f5fac",null);e.exports=i.exports},function(e,t,n){n(437);var i=n(11)(n(236),n(495),"data-v-736fe62a",null);e.exports=i.exports},function(e,t,n){n(441);var i=n(11)(n(237),n(499),"data-v-c01dfcf6",null);e.exports=i.exports},function(e,t,n){n(431);var i=n(11)(n(238),n(489),"data-v-446cdb72",null);e.exports=i.exports},function(e,t,n){n(427);var i=n(11)(n(239),n(484),"data-v-14f0c95b",null);e.exports=i.exports},function(e,t,n){n(434);var i=n(11)(n(240),n(492),"data-v-5268aa40",null);e.exports=i.exports},function(e,t,n){n(440);var i=n(11)(n(241),n(498),"data-v-838d5f0c",null);e.exports=i.exports},function(e,t,n){n(442);var i=n(11)(n(242),n(500),"data-v-c91836ac",null);e.exports=i.exports},function(e,t,n){n(436);var i=n(11)(n(244),n(494),"data-v-64e8ad8a",null);e.exports=i.exports},function(e,t,n){n(435);var i=n(11)(n(245),n(493),"data-v-5c9be5ba",null);e.exports=i.exports},function(e,t,n){n(432);var i=n(11)(n(246),n(490),"data-v-47fa6aa3",null);e.exports=i.exports},function(e,t,n){n(433);var i=n(11)(n(247),n(491),"data-v-4b73ceea",null);e.exports=i.exports},function(e,t,n){n(428);var i=n(11)(n(248),n(486),"data-v-321be6e7",null);e.exports=i.exports},function(e,t,n){n(439);var i=n(11)(n(249),n(497),"data-v-7ec605b7",null);e.exports=i.exports},function(e,t,n){n(429);var i=n(11)(n(250),n(487),"data-v-38c107f5",null);e.exports=i.exports},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"wrapper"},[n("div",{staticClass:"padding-wrapper"},[n("div",{staticClass:"search-wrapper"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.search,expression:"search"}],staticClass:"searchInput",attrs:{type:"text",placeholder:"搜索"},domProps:{value:e.search},on:{keyup:e.change,input:function(t){t.target.composing||(e.search=t.target.value)}}}),e._v(" "),n("i",{directives:[{name:"show",rawName:"v-show",value:e.noText,expression:"noText"}],staticClass:"icon iconfont icon-sousuo"}),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.haveText,expression:"haveText"}],staticClass:"searchInput-delete",on:{click:e.del}})])])])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"personal-card",attrs:{id:"personal-card"}},[n("div",{staticClass:"profile_mini"},[n("div",{staticClass:"profile_mini_hd"},[n("div",{staticClass:"avatar"},[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"点击更换头像",placement:"top"}},[n("div",[n("a",{attrs:{href:"javascript:void(0)",id:"add"},on:{click:e.openfile}},[n("img",{staticClass:"img",attrs:{src:e.user.img,alt:"点击更换头像"}})]),e._v(" "),n("input",{ref:"changeAvatar",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:e.changeAvatar}})])])],1)]),e._v(" "),n("div",{staticClass:"profile_mini_bd"},[n("div",{staticClass:"nickname_area"},[e._m(0),e._v(" "),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"点击修改昵称，最长10个字符",placement:"top-start"}},[n("div",{staticClass:"nickname_item"},[n("p",{staticClass:"nickname",attrs:{contenteditable:"true"},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.modifyNickName(t)},blur:e.modifyNickNameBlur}},[e._v(e._s(e.displayName))]),e._v(" "),n("i",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"web_wechat_men"})])])],1),e._v(" "),n("div",{staticClass:"meta_area"},[n("div",{staticClass:"meta_item"},[n("label",{staticClass:"label",attrs:{for:""}},[e._v("备注：")]),e._v(" "),n("p",{staticClass:"value",attrs:{contenteditable:"true"},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.modifyExtra(t)}}},[e._v(e._s(e.extra))])]),e._v(" "),n("div",{staticClass:"meta_item"},[n("label",{staticClass:"label"},[e._v("手机号：")]),e._v(" "),n("p",{staticClass:"value"},[e._v(e._s(e.mobile))])])])])])])},staticRenderFns:[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a",{staticClass:"opt"},[n("i",{staticClass:"web_wechat_tab_launch-chat"})])}]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{style:e.rootStyle,attrs:{id:e.config.id}})},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.showCreateGroupDialog?n("div",{staticClass:"create-group"},[n("el-dialog",{attrs:{visible:e.showCreateGroupDialog,width:"45%","show-close":!1,"distroy-on-close":!0,center:""},on:{"update:visible":function(t){e.showCreateGroupDialog=t},close:e.handleClose}},[n("div",{staticClass:"content"},[n("div",{staticClass:"friendlist-area"},[n("div",{staticClass:"search-input"},[n("el-input",{attrs:{clearable:"","prefix-icon":"el-icon-search",placeholder:"搜索"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchUser(t)}},model:{value:e.friendInput,callback:function(t){e.friendInput=t},expression:"friendInput"}})],1),e._v(" "),n("div",{staticClass:"friendlist",style:{height:e.appHeight-170+"px"}},[n("ul",e._l(e.waitCheckedFriendList,function(t,i){return n("li",{key:i,staticClass:"frienditem",class:{noborder:!t.initial}},[t.initial?n("div",{staticClass:"list_title"},[e._v(e._s(t.initial))]):e._e(),e._v(" "),n("div",{staticClass:"friend-info",class:{active:t.id===e.selectFriendId&&!t.disabled,disable:t.disabled},on:{click:function(n){return n.stopPropagation(),e.selectFriend(t.id)}}},[n("img",{staticClass:"avatar",attrs:{src:t.img,onerror:"this.src='static/images/vue.jpg'"}}),e._v(" "),n("div",{staticClass:"remark"},[e._v(e._s(t.remark))]),e._v(" "),n("div",{staticClass:"friend-check"},[n("el-checkbox",{attrs:{"true-label":t.id+":1","false-label":t.id+":0",disabled:t.disabled},on:{change:e.friendChangeChange},nativeOn:{click:function(e){e.stopPropagation()}},model:{value:t.checked,callback:function(n){e.$set(t,"checked",n)},expression:"item.checked"}})],1)])])}),0)])]),e._v(" "),n("div",{staticClass:"checkedlist"},[n("div",{staticClass:"checked-title"},[n("div",{staticClass:"create-group-title"},[e._v(e._s(e.groupDialogTitle))]),e._v(" "),n("div",{staticClass:"check-statu-title"},[e._v(e._s(e.checkFriendTips))])]),e._v(" "),n("div",{staticClass:"friendlist",style:{height:e.appHeight-200+"px"}},[n("ul",e._l(e.selectedFriends,function(t,i){return n("li",{key:i,staticClass:"frienditem"},[n("div",{staticClass:"friend-info"},[n("img",{staticClass:"avatar",attrs:{src:t.img,onerror:"this.src='static/images/vue.jpg'"}}),e._v(" "),n("div",{staticClass:"remark"},[e._v(e._s(t.remark))]),e._v(" "),n("div",{staticClass:"delete",on:{click:function(n){return e.delfriend(t.id)}}})])])}),0)]),e._v(" "),n("div",{staticClass:"check-operate"},[n("div",{staticClass:"check-btns"},[n("el-button",{staticClass:"cancel-btn",attrs:{size:"medium",type:"info",plain:"",round:""},on:{click:e.cancel}},[e._v("取 消")]),e._v(" "),n("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"confirm-btn",attrs:{size:"medium",type:"success",plain:"",round:"",disabled:e.confirmEnable},on:{click:e.confirm}},[e._v("确 定")])],1)])])])])],1):e._e()},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"appRef",class:{fullscreen:e.changeFullScreenMode},attrs:{id:"app"}},[n("div",{staticClass:"sidebar"},[n("mycard")],1),e._v(" "),n("div",{staticClass:"main"},[n("router-view")],1)])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"friendlist",style:{height:e.appHeight-60+"px"}},[n("ul",e._l(e.searchedFriendlist,function(t,i){return n("li",{key:i,staticClass:"frienditem",class:{noborder:!t.initial}},[t.initial?n("div",{staticClass:"list_title"},[e._v(e._s(t.initial))]):e._e(),e._v(" "),n("div",{staticClass:"friend-info",class:{active:t.id===e.selectFriendId},on:{click:function(n){return e.selectFriend(t.id)}}},[n("div",{staticClass:"friend-item"},[e.newFriendRequestCount>0&&0===t.id?n("span",{staticClass:"unread-friend-request-num"},[n("span",{staticClass:"unread-num-show"},[e._v(e._s(e.newFriendRequestCount))])]):e._e(),e._v(" "),n("img",{staticClass:"avatar",attrs:{width:"36",height:"36",src:t.img,onerror:"this.src='static/images/vue.jpg'"}})]),e._v(" "),n("div",{staticClass:"remark"},[e._v(e._s(t.remark))])])])}),0)])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"group-content",style:{height:e.appHeight-61+"px"},attrs:{id:"group-info-id"}},[n("div",{staticClass:"flex-layout"},[e.isSingleConversation?e._e():n("div",{staticClass:"group-info-title"},[n("div",{staticClass:"group-name-info"},[n("div",{staticClass:"group-name-title"},[e._v("群名")]),e._v(" "),n("p",{staticClass:"group-name",attrs:{contenteditable:"true"},on:{blur:e.modifyGroupNameBlur,keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.modifyGroupName(t)}}},[e._v(e._s(e.groupName))])]),e._v(" "),e._m(0)]),e._v(" "),n("div",{staticClass:"friend-info-list",style:{height:e.appHeight-221+"px"}},[n("ul",e._l(e.memberList,function(t,i){return n("li",{key:i,staticClass:"frienditem"},[n("div",{staticClass:"friend-info"},[1002==t.type?n("i",{staticClass:"icon iconfont icon-zengjia add",attrs:{title:"个人用户添加成员"},on:{click:e.addGroupMemberFromSingle}}):e._e(),e._v(" "),1e3==t.type?n("i",{staticClass:"icon iconfont icon-zengjia add",attrs:{title:"添加成员"},on:{click:e.addGroupMember}}):e._e(),e._v(" "),1001==t.type?n("i",{staticClass:"icon iconfont icon-shanchu-fangkuang add",attrs:{title:"移除成员"},on:{click:e.kickGroupMember}}):e._e(),e._v(" "),0==t.type||2==t.type?n("img",{staticClass:"avatar",attrs:{src:t.avatarUrl,onerror:"this.src='static/images/vue.jpg'"}}):e._e(),e._v(" "),n("p",{staticClass:"nickName"},[e._v(e._s(t.displayName))])])])}),0)]),e._v(" "),e.isSingleConversation?e._e():n("div",{staticClass:"flex-bottom"},[e.isGroupOwner?e._e():n("p",{staticClass:"quit-group",on:{click:e.quitGroup}},[e._v("退出群聊")]),e._v(" "),e.isGroupOwner?n("p",{staticClass:"dismiss-group",on:{click:e.dismissGroup}},[e._v("解散群聊")]):e._e()])])])},staticRenderFns:[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"group-board-info"},[n("div",{staticClass:"group-board-title"},[e._v("群公告")]),e._v(" "),n("div",{staticClass:"group-board-content"},[e._v("暂无公告")])])}]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"content"},[n("div",{staticClass:"friend-wrapper"},[n("search"),e._v(" "),n("friendlist")],1),e._v(" "),n("div",{staticClass:"friendinfo"},[n("info")],1)])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"addfrind"},[n("el-dialog",{attrs:{title:"添加好友",visible:e.showSearchFriendDialog,width:"30%","show-close":!0,center:""},on:{"update:visible":function(t){e.showSearchFriendDialog=t},close:e.handleClose}},[n("el-dialog",{attrs:{width:"30%",title:"添加好友",visible:e.innerVisible,"append-to-body":""},on:{"update:visible":function(t){e.innerVisible=t}}},[n("el-input",{attrs:{type:"textarea",rows:3},model:{value:e.friendRequest,callback:function(t){e.friendRequest=t},expression:"friendRequest"}}),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"medium",type:"info",plain:"",round:""},on:{click:function(t){e.innerVisible=!1}}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{size:"medium",type:"success",plain:"",round:""},on:{click:e.sendFriendRequest}},[e._v("确 定")])],1)],1),e._v(" "),n("el-input",{attrs:{"prefix-icon":"el-icon-search",placeholder:"请输入手机号码或昵称"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchUser(t)}},model:{value:e.friendInput,callback:function(t){e.friendInput=t},expression:"friendInput"}}),e._v(" "),n("el-table",{staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:e.searchUsers,"show-header":!1,fit:!0,"highlight-current-row":!1,"max-height":"300"}},[n("el-table-column",{attrs:{prop:"image",label:"头像",width:"50"},scopedSlots:e._u([{key:"default",fn:function(e){return[n("el-avatar",{attrs:{src:e.row.portrait}})]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"name",label:"姓名",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",[n("p",[e._v(e._s(t.row.displayName))]),e._v(" "),n("p",[e._v(e._s(t.row.mobile))])])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"加好友",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("i",{staticClass:"icon iconfont icon-jiahaoyou",on:{click:function(n){return e.showFriendRequestDialog(t.row)}}})]}}])})],1)],1)],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"add-content"},[n("div",{on:{click:e.recallMessage}},[n("a",[e._v(" 撤回消息 ")])]),e._v(" "),n("div",{on:{click:e.deleteMessage}},[n("a",[e._v(" 删除消息 ")])])])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"content"},[n("div",{staticClass:"msglist"},[n("search"),e._v(" "),n("chatlist")],1),e._v(" "),n("div",{staticClass:"chatbox"},[n("message"),e._v(" "),n("v-text")],1)])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"text"},[n("div",{staticClass:"emoji"},[n("i",{staticClass:"icon iconfont icon-biaoqing",on:{click:function(t){e.showEmoji=!e.showEmoji}}}),e._v(" "),n("i",{directives:[{name:"show",rawName:"v-show",value:e.isSingleConversation,expression:"isSingleConversation"}],staticClass:"icon iconfont icon-dianhua",attrs:{title:"语音聊天"},on:{click:e.sendAudio}}),e._v(" "),n("i",{directives:[{name:"show",rawName:"v-show",value:e.isSingleConversation,expression:"isSingleConversation"}],staticClass:"icon iconfont icon-ai-video",attrs:{title:"视频聊天"},on:{click:e.sendVideo}}),e._v(" "),n("i",{staticClass:"icon iconfont icon-tupian",attrs:{title:"发送图片"}},[n("input",{ref:"uploadPic",attrs:{type:"file",accept:"image/*",id:"chat-send-img"},on:{change:e.sendPic}})]),e._v(" "),e._m(0),e._v(" "),n("transition",{attrs:{name:"showbox"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.showEmoji,expression:"showEmoji"}],staticClass:"emojiBox"},e._l(e.emojis,function(t,i){return n("li",{key:i},[n("img",{attrs:{src:"static/emoji/"+t.file,data:t.code},on:{click:function(n){e.content+=t.code}}})])}),0)]),e._v(" "),n("transition",{attrs:{name:"voice-video-chat-box"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"chat-modal"},[n("div",{staticClass:"chat-box"},[n("video",{attrs:{id:"video-remote",playsinline:"",autoplay:"",muted:""},domProps:{muted:!0}}),e._v(" "),n("video",{attrs:{id:"video-local",playsinline:"",autoplay:"",muted:""},domProps:{muted:!0}})])])]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showChatBox,expression:"showChatBox"}],staticClass:"callContent"},[n("div",{},[n("div",{staticClass:"callercontent callshow"},[n("div",{staticClass:"exchange-content"},[n("div",{staticClass:"playcontent left-big-content"},[n("img",{directives:[{name:"show",rawName:"v-show",value:e.showCallRemoteImg,expression:"showCallRemoteImg"}],staticClass:"bigavatar",attrs:{id:"wxCallRemoteImg",src:e.callRemoteImg}}),e._v(" "),n("p",{directives:[{name:"show",rawName:"v-show",value:e.showCallTips,expression:"showCallTips"}],staticClass:"calltips",attrs:{id:"wxCallTips"},domProps:{textContent:e._s(e.videoTextCallTips)}},[e._v(" 接通中... ")]),e._v(" "),n("video",{directives:[{name:"show",rawName:"v-show",value:e.showCallRemoteVideo,expression:"showCallRemoteVideo"}],staticStyle:{display:"none"},attrs:{id:"wxCallRemoteVideo",autoplay:"autoplay",playsinline:""}})]),e._v(" "),n("div",{staticClass:"playcontent right-sml-content"},[n("img",{directives:[{name:"show",rawName:"v-show",value:e.showCallLocalImg,expression:"showCallLocalImg"}],staticClass:"bigavatar",attrs:{id:"wxCallLocalImg",src:e.callLocalImg}}),e._v(" "),n("video",{directives:[{name:"show",rawName:"v-show",value:e.showCallLocalVideo,expression:"showCallLocalVideo"}],staticStyle:{display:"none"},attrs:{id:"wxCallLocalVideo",autoplay:"autoplay",muted:"muted",playsinline:""},domProps:{muted:!0}})])]),e._v(" "),n("div",{staticClass:"opera-content flexbox"},[n("img",{staticClass:"calleravatar",attrs:{src:e.callRemoteImg}}),e._v(" "),n("span",{staticClass:"flexauto overell callnick",domProps:{textContent:e._s(e.callDisplayName)}}),e._v(" "),n("span",{staticClass:"flexbox"},[n("span",{directives:[{name:"show",rawName:"v-show",value:e.cancelCall,expression:"cancelCall"}],staticClass:"operabtn canclecall btnopacity",on:{click:e.cancel}},[e._v("取消")]),e._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:e.rejectCall,expression:"rejectCall"}],staticClass:"operabtn canclecall btnopacity",staticStyle:{display:"none"},on:{click:e.reject}},[e._v("拒绝")]),e._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:e.acceptCall,expression:"acceptCall"}],staticClass:"operabtn upcall btnopacity",staticStyle:{display:"none"},on:{click:e.accept}},[e._v("接听")])]),e._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:e.showTalkTime,expression:"showTalkTime"}],staticClass:"talktime flexbox",staticStyle:{display:"none"}},[n("i",{staticClass:"iconfont icon-ai-video"}),e._v(" "),n("span",{domProps:{textContent:e._s(e.talkTime)}},[e._v("00:00")])]),e._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:e.hangUpCall,expression:"hangUpCall"}],staticClass:"operabtn canclecall btnopacity",staticStyle:{display:"none"},on:{click:e.hangUp}},[n("i",{staticClass:"iconfont icon-guaduan"}),e._v("挂断 ")]),e._v(" "),e._m(1),e._v(" "),e._m(2)])])])]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showAudioBox,expression:"showAudioBox"}],staticClass:"audioContent"},[n("div",{staticClass:"audioBody callshow"},[n("div",{staticClass:"audioBg"},[n("img",{staticClass:"callavatar",attrs:{src:e.callRemoteImg}}),e._v(" "),n("div",{staticClass:"blackbg"})]),e._v(" "),n("div",{staticClass:"audiomain"},[n("img",{staticClass:"audio-avatar",attrs:{src:e.callRemoteImg}}),e._v(" "),n("p",{staticClass:"callnick",domProps:{textContent:e._s(e.callDisplayName)}}),e._v(" "),n("p",{directives:[{name:"show",rawName:"v-show",value:e.showTalkTime,expression:"showTalkTime"}],staticClass:"call-time",staticStyle:{display:"none"},domProps:{textContent:e._s(e.talkTime)}},[e._v("00:00")]),e._v(" "),n("p",{directives:[{name:"show",rawName:"v-show",value:e.waitingMsg,expression:"waitingMsg"}],staticClass:"waiting-msg",domProps:{textContent:e._s(e.waitingMsgTips)}},[e._v(" 接通中... ")]),e._v(" "),n("div",{staticClass:"call-opera flexbox"},[n("span",{directives:[{name:"show",rawName:"v-show",value:e.hangUpCall,expression:"hangUpCall"}],staticClass:"cancleaudio btnopacity",staticStyle:{display:"none"},on:{click:e.hangUp}},[n("i",{staticClass:"iconfont icon-guaduan"}),e._v("挂断 ")]),e._v(" "),n("div",{staticClass:"loadingcall flexbox"},[n("span",{directives:[{name:"show",rawName:"v-show",value:e.cancelCall,expression:"cancelCall"}],staticClass:"cancleaudio callercanle btnopacity",staticStyle:{display:"none"},on:{click:e.cancel}},[n("i",{staticClass:"iconfont icon-guaduan"}),e._v("取消 ")]),e._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:e.rejectCall,expression:"rejectCall"}],staticClass:"cancleaudio btnopacity",staticStyle:{display:"none"},on:{click:e.reject}},[e._v("拒绝")]),e._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:e.acceptCall,expression:"acceptCall"}],staticClass:"upcall btnopacity",staticStyle:{display:"none"},on:{click:e.accept}},[e._v("接听")])])])]),e._v(" "),e._m(3),e._v(" "),e._m(4)])])],1),e._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.content,expression:"content"}],ref:"text",attrs:{id:"sendText"},domProps:{value:e.content},on:{keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.sendMessage(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey?e.newline(t):null}],focus:e.onFocus,click:function(t){e.showEmoji=!1},input:function(t){t.target.composing||(e.content=t.target.value)}}}),e._v(" "),n("div",{ref:"sendBtn",staticClass:"send",class:{disable:e.sendBtnDisabled},on:{click:e.send}},[n("span",[e._v("发送")])]),e._v(" "),n("transition",{attrs:{name:"appear"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.warn,expression:"warn"}],staticClass:"warn"},[n("div",{staticClass:"description"},[e._v("不能发送空白信息")])])])],1)},staticRenderFns:[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("i",{staticClass:"icon iconfont icon-wenjian",attrs:{title:"发送文件"}},[n("input",{attrs:{type:"file",accept:"*",id:"chat-send-file"}})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("button",{staticClass:"screenbtn"},[n("i",{staticClass:"iconfont icon-quanping iconfull",staticStyle:{display:"none"}})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("button",{staticClass:"screenbtn",staticStyle:{display:"none"}},[n("i",{staticClass:"iconfont icon-tuichuquanping iconfull"})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{display:"none"}},[n("audio",{attrs:{id:"wxCallRemoteAudio",autoplay:"autoplay"}})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{display:"none"}},[n("audio",{attrs:{id:"wxCallLocalAudio",autoplay:"autoplay",muted:"muted"}})])}]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"Info-wrapper"},[n("div",{staticClass:"newfriend"},[n("div",{staticClass:"nickname"},[e._v(e._s(e.selectedFriend.nickname))])]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:0===e.selectedFriend.id,expression:"selectedFriend.id === 0"}],staticClass:"friendrequest",style:{height:e.appHeight-60+"px"}},[n("el-table",{staticStyle:{width:"100%",height:"100%"},attrs:{data:e.friendRequests,"show-header":!1,"max-height":e.appHeight-61}},[n("el-table-column",{attrs:{prop:"image",label:"头像",width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-avatar",{attrs:{src:e.friendPortrait(t.row.from)}})]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"name",label:"姓名",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",[n("p",[e._v(e._s(e.friendName(t.row.from)))]),e._v(" "),n("p",[e._v(e._s(t.row.reason))])])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"加好友",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini",type:"success",disabled:1===t.row.status},on:{click:function(n){return e.handleFriendRequest(t.row)}}},[e._v(e._s(e.requestBtnMessage(t.row)))])]}}])})],1)],1),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.selectedFriend.id>0,expression:"selectedFriend.id > 0"}],staticClass:"friendInfo"},[n("div",{staticClass:"esInfo"},[n("div",{staticClass:"left"},[n("div",{staticClass:"people"},[n("div",{staticClass:"nickname"},[e._v(e._s(e.selectedFriend.nickname))]),e._v(" "),n("div",{class:[1===e.selectedFriend.sex?"gender-male":"gender-female"]})]),e._v(" "),n("div",{staticClass:"signature"},[e._v(e._s(e.selectedFriend.signature))])]),e._v(" "),n("div",{staticClass:"right"},[n("img",{staticClass:"avatar",attrs:{width:"60",height:"60",src:e.selectedFriend.img}})])]),e._v(" "),n("div",{staticClass:"detInfo"},[n("div",{staticClass:"remark"},[n("span",[e._v("备   注")]),e._v(e._s(e.selectedFriend.remark))]),e._v(" "),n("div",{staticClass:"area"},[n("span",[e._v("地   区")]),e._v(e._s(e.selectedFriend.area))]),e._v(" "),n("div",{staticClass:"wxid"},[n("span",[e._v("微信号")]),e._v(e._s(e.selectedFriend.wxid))])]),e._v(" "),n("div",{staticClass:"send",on:{click:e.send}},[n("span",[e._v("发消息")])])])])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"layout-container",attrs:{id:"app-chat"}},[n("router-view"),e._v(" "),n("searchfriend"),e._v(" "),n("creategroup")],1)},staticRenderFns:[]}},function(e,t,n){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"login_box",staticStyle:{display:"none"}},[n("router-link",{attrs:{to:"#"}},[n("div",{staticClass:"login_close"})]),e._v(" "),n("div",{staticClass:"login_panel"},[e._m(0),e._v(" "),n("label",{staticStyle:{"margin-top":"50px"}},[e._v("数据：")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.mobile,expression:"mobile"}],attrs:{type:"tel",pattern:"^\\d{11}$",title:"请输入账号"},domProps:{value:e.mobile},on:{input:function(t){t.target.composing||(e.mobile=t.target.value)}}}),e._v(" "),n("label",[e._v("验码：")]),e._v(" "),n("div",{staticClass:"pass-form"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.code,expression:"code"}],staticClass:"pass-input",attrs:{type:"num",title:"请输入密码"},domProps:{value:e.code},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.loginEnter(t)},input:function(t){t.target.composing||(e.code=t.target.value)}}}),e._v(" "),n("el-button",{staticClass:"send-verify-code",attrs:{type:"primary",disabled:e.sendVerifyBtnDisabled},on:{click:e.sendVerifyCode}},[e._v(e._s(e.sendVerifyBtnText))])],1),e._v(" "),n("input",{staticClass:"bt",attrs:{type:"submit",value:"登录"},on:{click:e.login}})])],1)},staticRenderFns:[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"login_title"},[i("img",{attrs:{src:n(460),alt:""}}),e._v(" "),i("p",[e._v("安全登录")])])}]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"message"},[n("header",{staticClass:"header"},[n("div",{staticClass:"friendname"},[e._v(e._s(e.selectedChat.name))]),e._v(" "),n("div",{staticClass:"friend-group-info"},[e.isSingleConversation?n("i",{staticClass:"icon iconfont icon-pengyou1 show-group-info",attrs:{title:"用户信息"},on:{click:e.changeShowCreateGroup}}):e._e(),e._v(" "),e.isSingleConversation?e._e():n("i",{staticClass:"icon iconfont icon-pengyou show-group-info",attrs:{title:"群组信息"},on:{click:e.changeShowGroupInfo}}),e._v(" "),e.showGroupInfo?n("groupInfo",{attrs:{targetId:e.selectedChat.target}}):e._e()],1)]),e._v(" "),n("div",{ref:"list",staticClass:"message-wrapper",style:{height:.75*e.appHeight-60+"px"},on:{scroll:e.scrollEvent,click:e.messageBoxClick}},[e.selectedChat?n("ul",e._l(e.selectedChat.protoMessages,function(t,i){return n("li",{key:i,staticClass:"message-item"},[e.isShowTime(i,e.selectedChat.protoMessages)?n("div",{staticClass:"time"},[n("span",[e._v(e._s(e._f("getTimeStringAutoShort2")(t.timestamp)))])]):e._e(),e._v(" "),e.isGroupNotification(t)?n("div",{staticClass:"time"},[n("span",[e._v(e._s(e.notificationContent(t)))])]):e._e(),e._v(" "),e.isRecallNotification(t)?n("div",{staticClass:"time"},[n("span",[e._v(e._s(e.notificationContent(t)))])]):e._e(),e._v(" "),90===t.content.type?n("div",{staticClass:"time"},[n("span",[e._v(e._s(t.content.content))])]):e._e(),e._v(" "),e.isNotification(t.content.type)?e._e():n("div",{staticClass:"main",class:{self:0==t.direction}},[n("img",{staticClass:"avatar",attrs:{width:"36",height:"36",src:e.avatarSrc(t),onerror:"this.src='static/images/vue.jpg'"}}),e._v(" "),n("div",{staticClass:"content"},[e.isSingleConversation||0==t.direction?e._e():n("div",{staticClass:"display-name"},[e._v(e._s(e.showUserName(t.from)))]),e._v(" "),n("div",{staticClass:"content-message-right-menu"},[0==t.direction?n("div",{staticClass:"send-status"},[e.isSending(t)?n("i",{staticClass:"icon iconfont icon-loading-solid",attrs:{title:"发送中"}}):e._e(),e._v(" "),e.isSendFail(t)?n("i",{staticClass:"icon iconfont icon-fasongshibai",attrs:{title:"发送失败"}}):e._e()]):e._e(),e._v(" "),n("div",{staticClass:"content-message",on:{contextmenu:function(n){return n.preventDefault(),e.messageRigthClick(t.messageId)}}},[1===t.content.type&&e.isfaceMessage(t.content.searchableContent)?n("div",{staticClass:"text",domProps:{innerHTML:e._s(e.replaceFace(t.content.searchableContent))}}):e._e(),e._v(" "),1!==t.content.type||e.isfaceMessage(t.content.searchableContent)?e._e():n("div",{staticClass:"text",domProps:{textContent:e._s(t.content.searchableContent)}}),e._v(" "),2===t.content.type?n("div",[e._v("\n                                        [语音消息]\n                                    ")]):e._e(),e._v(" "),3===t.content.type?n("div",{directives:[{name:"viewer",rawName:"v-viewer"}]},[n("img",{staticClass:"receive-image",attrs:{src:t.content.remoteMediaUrl}})]):e._e(),e._v(" "),4===t.content.type?n("div",[e._v("\n                                        [位置消息]\n                                    ")]):e._e(),e._v(" "),5===t.content.type?n("div",[e._v("\n                                        [文件消息]\n                                    ")]):e._e(),e._v(" "),6===t.content.type?n("div",[n("Xgplayer",{attrs:{config:e.videoConfig(t.content.remoteMediaUrl,i===e.selectedChat.protoMessages.length-1)},on:{player:function(t){e.Player=t}}})],1):e._e(),e._v(" "),7===t.content.type?n("div",[e._v("\n                                        [表情消息]\n                                    ")]):e._e(),e._v(" "),8===t.content.type?n("div",[e._v("\n                                        [图片表情]\n                                    ")]):e._e(),e._v(" "),400===t.content.type?n("div",[e._v("\n                                        [网络电话]\n                                    ")]):e._e()]),e._v(" "),e.isShowMessageMenu(t)?n("rightMenu",{attrs:{message:t}}):e._e()],1)])])])}),0):e._e()])])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"add-content"},[n("div",[n("a",{staticClass:"iconsize wx-chat-icon",on:{click:e.showSearchFriendDialog}},[n("i",{staticClass:"iconfont icon-jiahaoyou iconhover"}),e._v(" 添加好友 ")])]),e._v(" "),n("div",[n("a",{staticClass:"iconsize wx-chat-icon",on:{click:e.showCreateGroupDialog}},[n("i",{staticClass:"iconfont icon-pengyou iconhover"}),e._v(" 创建群聊 ")])])])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"mycardRef",staticClass:"mycard"},[n("header",[n("img",{staticClass:"avatar",attrs:{src:e.user.img},on:{click:e.showPersonCard,dblclick:e.changeFullScreenMode}}),e._v(" "),e.showPersonalCard?n("personcard",{attrs:{userId:e.userId}}):e._e()],1),e._v(" "),n("div",{staticClass:"navbar",on:{click:e.clearSearch}},[n("div",{staticClass:"conversation-item"},[e.unreadTotalCount>0?n("span",{staticClass:"unread-num"},[n("span",{staticClass:"unread-num-show"},[e._v(e._s(e.unreadTotalCount))])]):e._e(),e._v(" "),n("router-link",{staticClass:"icon iconfont icon-dkw_xiaoxi",attrs:{to:"/conversation"}})],1),e._v(" "),n("div",{staticClass:"friend-item"},[e.newFriendRequestCount>0?n("span",{staticClass:"unread-friend-request-num"}):e._e(),e._v(" "),n("router-link",{staticClass:"icon iconfont icon-pengyou",attrs:{to:"/friend"}})],1),e._v(" "),n("div",{staticClass:"icon iconfont icon-jiahaoyou",on:{click:function(t){e.showAddRequestTip=!e.showAddRequestTip}}},[n("addtip",{directives:[{name:"show",rawName:"v-show",value:e.showAddRequestTip,expression:"showAddRequestTip"}]})],1)]),e._v(" "),n("footer")])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"conversationlist",style:{height:e.appHeight-60+"px"}},[n("ul",{directives:[{name:"loading",rawName:"v-loading",value:e.isEmptyConversation,expression:"isEmptyConversation"}],staticStyle:{"min-height":"60px"}},e._l(e.searchedConversationList,function(t,i){return n("li",{key:i,staticClass:"sessionlist",class:{active:t.conversationInfo.target===e.selectTarget},on:{click:function(n){return e.selectConversation(t.conversationInfo.target)}}},[n("div",{staticClass:"list-left"},[n("img",{staticClass:"avatar",attrs:{width:"42",height:"42",alt:"static/images/vue.jpg",src:t.img,onerror:"this.src='static/images/vue.jpg'"}})]),e._v(" "),n("div",{staticClass:"list-right"},[n("div",{staticClass:"title-info"},[n("p",{staticClass:"name"},[e._v(e._s(t.name?t.name:""))]),e._v(" "),n("span",{staticClass:"time"},[e._v(e._s(e._f("getTimeStringAutoShort2")(t.conversationInfo.timestamp)))])]),e._v(" "),n("div",{staticClass:"lastmsg-info"},[n("p",{staticClass:"lastmsg"},[e._v(e._s(e.processageGroupMessage(t)))]),e._v(" "),t.conversationInfo.unreadCount&&t.conversationInfo.unreadCount.unread>0?n("span",{staticClass:"unread-num"},[n("span",{staticClass:"unread-num-show"},[e._v(e._s(t.conversationInfo.unreadCount?t.conversationInfo.unreadCount.unread:0))])]):e._e()])])])}),0)])},staticRenderFns:[]}}],[265]);
//# sourceMappingURL=app.e1528fb0837747f9541a.js.map